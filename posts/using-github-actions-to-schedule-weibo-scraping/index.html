<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>利用Github Actions定时抓取微博 | 流动</title><meta name=keywords content="github,weibo"><meta name=description content="背景
在微博上关注了一些用户，比如tk教主，月风。
但是有些内容过段时间不可见了，所以希望可以定时抓取微博归档备份下来。
实现方案
整体思路：利用Github Actions的Scheduled任务，定时执行抓取shell脚本，将内容保存到文件，提交到Github仓库。"><meta name=author content="Liudon"><link rel=canonical href=https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/><link crossorigin=anonymous href=../../assets/css/stylesheet.c2b4102602461aaea01497bf2f89d3d4096e9005f6ac8a7e60b27e335724b916.css integrity="sha256-wrQQJgJGGq6gFJe/L4nT1AlukAX2rIp+YLJ+M1ckuRY=" rel="preload stylesheet" as=style><link rel=icon href=https://liudon.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://liudon.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://liudon.com/favicon-32x32.png><link rel=apple-touch-icon href=https://liudon.com/apple-touch-icon.png><link rel=mask-icon href=https://liudon.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta name=google-site-verification content="rJrwFlRtYvRvSMxmD-zlGY6ozg6aDFMkfavno3ms5Ew"><meta name=google-adsense-account content="ca-pub-4739645989170648"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4739645989170648" crossorigin=anonymous></script><meta property="og:url" content="https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/"><meta property="og:site_name" content="流动"><meta property="og:title" content="利用Github Actions定时抓取微博"><meta property="og:description" content="背景 在微博上关注了一些用户，比如tk教主，月风。
但是有些内容过段时间不可见了，所以希望可以定时抓取微博归档备份下来。
实现方案 整体思路：利用Github Actions的Scheduled任务，定时执行抓取shell脚本，将内容保存到文件，提交到Github仓库。"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-07T13:17:57+08:00"><meta property="article:modified_time" content="2023-10-07T13:17:57+08:00"><meta property="article:tag" content="Github"><meta property="article:tag" content="Weibo"><meta name=twitter:card content="summary"><meta name=twitter:title content="利用Github Actions定时抓取微博"><meta name=twitter:description content="背景
在微博上关注了一些用户，比如tk教主，月风。
但是有些内容过段时间不可见了，所以希望可以定时抓取微博归档备份下来。
实现方案
整体思路：利用Github Actions的Scheduled任务，定时执行抓取shell脚本，将内容保存到文件，提交到Github仓库。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"文章","item":"https://liudon.com/posts/"},{"@type":"ListItem","position":2,"name":"利用Github Actions定时抓取微博","item":"https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"利用Github Actions定时抓取微博","name":"利用Github Actions定时抓取微博","description":"背景 在微博上关注了一些用户，比如tk教主，月风。\n但是有些内容过段时间不可见了，所以希望可以定时抓取微博归档备份下来。\n实现方案 整体思路：利用Github Actions的Scheduled任务，定时执行抓取shell脚本，将内容保存到文件，提交到Github仓库。\n","keywords":["github","weibo"],"articleBody":"背景 在微博上关注了一些用户，比如tk教主，月风。\n但是有些内容过段时间不可见了，所以希望可以定时抓取微博归档备份下来。\n实现方案 整体思路：利用Github Actions的Scheduled任务，定时执行抓取shell脚本，将内容保存到文件，提交到Github仓库。\n新建仓库，比如weibo_archive。\n添加抓取脚本，完整代码。\n这里用到微博两个接口：\n// 抓取某个用户最新的10条微博数据，返回里有每条微博的id，这里如果内容过长的话会被截断 https://m.weibo.cn/api/container/getIndex?jumpfrom=weibocom\u0026type=uid\u0026value=$uid\u0026containerid=107603$uid // 根据微博id，抓取微博完整的内容 https://m.weibo.cn/statuses/extend?id=$id 添加环境变量。\n进入个人设置-\u003eDeveloper Settings-\u003ePersonal access tokens-\u003eTokens (classic)，创建新的Token，记下对应的值。\n进入第一步创建仓库的配置页，点击Secrets and variables下的Actions：\n切到Secret目录，创建新的Secret变量，名称为TOKEN，值为前一步记录的值；切到Variables目录，创建新的Variables变量，名称为WEIBO_UIDS，值为你需要抓取的微博用户id，多个用户的话以|分割。\n添加定时任务，完整yaml文件如下。\n# This is a basic workflow to help you get started with Actions name: CI # Controls when the workflow will run on: # Triggers the workflow on push or pull request events but only for the \"main\" branch push: branches: [ \"main\" ] pull_request: branches: [ \"main\" ] # Allows you to run this workflow manually from the Actions tab workflow_dispatch: schedule: - cron: '*/5 * * * *' # A workflow run is made up of one or more jobs that can run sequentially or in parallel jobs: # This workflow contains a single job called \"build\" build: # The type of runner that the job will run on runs-on: ubuntu-latest permissions: contents: write # Steps represent a sequence of tasks that will be executed as part of the job steps: # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it - uses: actions/checkout@v3 # Runs a single command using the runners shell - name: archive weibo run: | chmod +x ./weibo_archive.sh ./weibo_archive.sh shell: bash env: weibo_uids: ${{ vars.weibo_uids }} # Runs a set of commands using the runners shell - name: Commit changes uses: EndBug/add-and-commit@v9 env: github_token: ${{ secrets.TOKEN }} add: . 效果 抓取后的内容，会按用户id分别保存到不同文件。\n不过这个方案有一个唯一的缺点，Github Actions定时任务时间粒度最小是5分钟，而且不能保证执行时间完全符合这个粒度，所以可能还是会有漏掉的内容。\nNote: The schedule event can be delayed during periods of high loads of GitHub Actions workflow runs. High load times include the start of every hour. If the load is sufficiently high enough, some queued jobs may be dropped. To decrease the chance of delay, schedule your workflow to run at a different time of the hour.\n","wordCount":"823","inLanguage":"en","datePublished":"2023-10-07T13:17:57+08:00","dateModified":"2023-10-07T13:17:57+08:00","author":{"@type":"Person","name":"Liudon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/"},"publisher":{"@type":"Organization","name":"流动","logo":{"@type":"ImageObject","url":"https://liudon.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://liudon.com/ accesskey=h title="流动 (Alt + H)">流动</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://liudon.com/ title=Home><span>Home</span></a></li><li><a href=https://liudon.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://workout.liudon.com title=Workouts><span>Workouts</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://liudon.com/about/ title=About><span>About</span></a></li><li><a href=https://liudon.com/search/ title="🔍 (Alt + /)" accesskey=/><span>🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">利用Github Actions定时抓取微博</h1><div class=post-meta><span title='2023-10-07 13:17:57 +0800 +0800'>2023-10-07</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;823 words&nbsp;·&nbsp;Liudon</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e8%83%8c%e6%99%af aria-label=背景>背景</a></li><li><a href=#%e5%ae%9e%e7%8e%b0%e6%96%b9%e6%a1%88 aria-label=实现方案>实现方案</a></li><li><a href=#%e6%95%88%e6%9e%9c aria-label=效果>效果</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h4 id=背景>背景<a hidden class=anchor aria-hidden=true href=#背景>#</a></h4><p>在微博上关注了一些用户，比如<a href=https://weibo.com/u/1401527553>tk教主</a>，<a href=https://weibo.com/u/1670659923>月风</a>。</p><p>但是有些内容过段时间不可见了，所以希望可以定时抓取微博归档备份下来。</p><h4 id=实现方案>实现方案<a hidden class=anchor aria-hidden=true href=#实现方案>#</a></h4><p><strong>整体思路：利用<code>Github Actions</code>的<code>Scheduled</code>任务，定时执行抓取shell脚本，将内容保存到文件，提交到Github仓库。</strong></p><ol><li><p>新建仓库，比如<code>weibo_archive</code>。</p></li><li><p>添加抓取脚本，<a href=https://github.com/Liudon/weibo_archive/blob/main/weibo_archive.sh>完整代码</a>。</p><p>这里用到微博两个接口：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>// 抓取某个用户最新的10条微博数据，返回里有每条微博的id，这里如果内容过长的话会被截断
</span></span><span style=display:flex><span>https://m.weibo.cn/api/container/getIndex?jumpfrom=weibocom&amp;type=uid&amp;value=$uid&amp;containerid=107603$uid
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// 根据微博id，抓取微博完整的内容
</span></span><span style=display:flex><span>https://m.weibo.cn/statuses/extend?id=$id
</span></span></code></pre></div></li><li><p>添加环境变量。</p><ul><li><p>进入<code>个人设置</code>-><code>Developer Settings</code>-><code>Personal access tokens</code>-><code>Tokens (classic)</code>，创建新的Token，记下对应的值。</p></li><li><p>进入第一步创建仓库的配置页，点击<code>Secrets and variables</code>下的<code>Actions</code>：</p><p>切到<code>Secret</code>目录，创建新的<code>Secret</code>变量，名称为<code>TOKEN</code>，值为前一步记录的值；切到<code>Variables</code>目录，创建新的<code>Variables</code>变量，名称为<code>WEIBO_UIDS</code>，值为你需要抓取的微博用户id，多个用户的话以<code>|</code>分割。</p></li></ul></li><li><p>添加定时任务，完整yaml文件如下。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#75715e># This is a basic workflow to help you get started with Actions</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>name: CI
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Controls when the workflow will run</span>
</span></span><span style=display:flex><span>on:
</span></span><span style=display:flex><span><span style=color:#75715e># Triggers the workflow on push or pull request events but only for the &#34;main&#34; branch</span>
</span></span><span style=display:flex><span>push:
</span></span><span style=display:flex><span>    branches: [ <span style=color:#e6db74>&#34;main&#34;</span> ]
</span></span><span style=display:flex><span>pull_request:
</span></span><span style=display:flex><span>    branches: [ <span style=color:#e6db74>&#34;main&#34;</span> ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Allows you to run this workflow manually from the Actions tab</span>
</span></span><span style=display:flex><span>workflow_dispatch:
</span></span><span style=display:flex><span>schedule:
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span> cron: <span style=color:#e6db74>&#39;*/5 * * * *&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span>
</span></span><span style=display:flex><span>jobs:
</span></span><span style=display:flex><span><span style=color:#75715e># This workflow contains a single job called &#34;build&#34;</span>
</span></span><span style=display:flex><span>build:
</span></span><span style=display:flex><span>    <span style=color:#75715e># The type of runner that the job will run on</span>
</span></span><span style=display:flex><span>    runs<span style=color:#f92672>-</span>on: ubuntu<span style=color:#f92672>-</span>latest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    permissions:      
</span></span><span style=display:flex><span>    contents: write
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Steps represent a sequence of tasks that will be executed as part of the job</span>
</span></span><span style=display:flex><span>    steps:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span> uses: actions<span style=color:#f92672>/</span>checkout<span style=color:#960050;background-color:#1e0010>@</span>v3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Runs a single command using the runners shell</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span> name: archive weibo
</span></span><span style=display:flex><span>        run: <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>        chmod <span style=color:#f92672>+</span>x <span style=color:#f92672>./</span>weibo_archive<span style=color:#f92672>.</span>sh
</span></span><span style=display:flex><span>        <span style=color:#f92672>./</span>weibo_archive<span style=color:#f92672>.</span>sh
</span></span><span style=display:flex><span>        shell: bash
</span></span><span style=display:flex><span>        env:
</span></span><span style=display:flex><span>        weibo_uids: <span style=color:#f92672>$</span>{{ vars<span style=color:#f92672>.</span>weibo_uids }}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Runs a set of commands using the runners shell</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span> name: Commit changes
</span></span><span style=display:flex><span>        uses: EndBug<span style=color:#f92672>/</span>add<span style=color:#f92672>-</span><span style=color:#f92672>and</span><span style=color:#f92672>-</span>commit<span style=color:#960050;background-color:#1e0010>@</span>v9
</span></span><span style=display:flex><span>        env:
</span></span><span style=display:flex><span>        github_token: <span style=color:#f92672>$</span>{{ secrets<span style=color:#f92672>.</span>TOKEN }}
</span></span><span style=display:flex><span>        add: <span style=color:#f92672>.</span>
</span></span></code></pre></div></li></ol><h4 id=效果>效果<a hidden class=anchor aria-hidden=true href=#效果>#</a></h4><p>抓取后的内容，会按用户id分别保存到不同文件。</p><p><picture><source type=image/avif srcset="https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/20231007132025.png_1080x.avif 1080w" sizes="(min-width: 768px) 1080px, 100vw"><source type=image/webp srcset="https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/20231007132025.png_1080x.webp 1080w" sizes="(min-width: 768px) 1080px, 100vw"><img src=20231007132025.png width=824 height=207 alt=效果 title loading=lazy></picture></p><p>不过这个方案有一个唯一的缺点，<code>Github Actions</code>定时任务时间粒度最小是5分钟，而且不能保证执行时间完全符合这个粒度，所以可能还是会有漏掉的内容。</p><blockquote><p>Note: The schedule event can be delayed during periods of high loads of GitHub Actions workflow runs. High load times include the start of every hour. If the load is sufficiently high enough, some queued jobs may be dropped. To decrease the chance of delay, schedule your workflow to run at a different time of the hour.</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://liudon.com/tags/github/>Github</a></li><li><a href=https://liudon.com/tags/weibo/>Weibo</a></li></ul><nav class=paginav><a class=prev href=https://liudon.com/posts/deploy-twikoo-on-netlify/><span class=title>« Prev</span><br><span>在Netlify上部署Twikoo评论系统</span>
</a><a class=next href=https://liudon.com/posts/%E5%8C%97%E5%A4%A7%E5%8F%A3%E8%85%94%E7%89%99%E5%91%A8%E5%88%AE%E6%B2%BB%E8%AE%B0%E5%BD%95/><span class=title>Next »</span><br><span>北大口腔牙周刮治记录</span></a></nav></footer><div><div class=post_ads><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4739645989170648 data-ad-slot=5019102040 data-ad-format=auto data-full-width-responsive=true></ins><script>window.addEventListener("load",function(){(adsbygoogle=window.adsbygoogle||[]).push({})})</script></div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>💬评论</span><hr></div><div id=tcomment></div><script src=https://cdnjs.cloudflare.com/ajax/libs/twikoo/1.6.41/twikoo.all.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script>twikoo.init({envId:"https://comment.liudon.com",el:"#tcomment",lang:"zh-CN",region:"ap-shanghai",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://liudon.com/>流动</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg></a><footer class=footer style=margin-top:-20px;padding-top:0><span><a href=https://beian.miit.gov.cn target=_blank>京ICP备13029522号-2</a></span></footer><script src=//tokinx.github.io/ViewImage/view-image.min.js async></script><script>function initViewImage(){window.ViewImage&&ViewImage.init(".post-content img")}document.readyState==="complete"?initViewImage():window.addEventListener("load",initViewImage)</script><script>const host=window.location.host;host!=="blog.liudon.xyz"&&!host.startsWith("liudon.")&&!host.startsWith("localhost")&&!host.startsWith("127.0.0.1")&&(document.body.innerHTML=['<div style="margin: auto;">',"<h1>当前页面并非本人博客，即将在2秒后跳转到本人博客: https://liudon.com。</h1>","<br />","</div>"].join(""),document.body.style=["background-color: white;","color: black;","text-align: center;","font-size: 50px;","width: 100vw;","height: 100vh;","display: flex;"].join(""),setTimeout(()=>{window.location.href="https://liudon.com"},2e3))</script><script>enScroll=!1,enFdl=!1,extCurrent=0[0],filename=0[0],targetText=0[0],splitOrigin=0[0];const lStor=localStorage,sStor=sessionStorage,doc=document,docEl=document.documentElement,docBody=document.body,docLoc=document.location,w=window,s=screen,nav=navigator||{},extensions=["pdf","xls","xlsx","doc","docx","txt","rtf","csv","exe","key","pps","ppt","pptx","7z","pkg","rar","gz","zip","avi","mov","mp4","mpe","mpeg","wmv","mid","midi","mp3","wav","wma"];function a(e,t,n,o){const j="G-G9ZDJQN9E2",r=()=>Math.floor(Math.random()*1e9)+1,c=()=>Math.floor(Date.now()/1e3),F=()=>(sStor._p||(sStor._p=r()),sStor._p),E=()=>r()+"."+c(),_=()=>(lStor.cid_v4||(lStor.cid_v4=E()),lStor.cid_v4),m=lStor.getItem("cid_v4"),v=()=>m?0[0]:enScroll==!0?0[0]:"1",p=()=>(sStor.sid||(sStor.sid=c()),sStor.sid),O=()=>{if(!sStor._ss)return sStor._ss="1",sStor._ss;if(sStor.getItem("_ss")=="1")return 0[0]},a="1",g=()=>{if(sStor.sct)if(enScroll==!0)return sStor.sct;else x=+sStor.getItem("sct")+ +a,sStor.sct=x;else sStor.sct=a;return sStor.sct},i=docLoc.search,b=new URLSearchParams(i),h=["q","s","search","query","keyword"],y=h.some(e=>i.includes("&"+e+"=")||i.includes("?"+e+"=")),u=()=>y==!0?"view_search_results":enScroll==!0?"scroll":enFdl==!0?"file_download":"page_view",f=()=>enScroll==!0?"90":0[0],C=()=>{if(u()=="view_search_results"){for(let e of b)if(h.includes(e[0]))return e[1]}else return 0[0]},d=encodeURIComponent,k=e=>{let t=[];for(let n in e)e.hasOwnProperty(n)&&e[n]!==0[0]&&t.push(d(n)+"="+d(e[n]));return t.join("&")},A=!1,S="https://liudon.com/analytics/post",M=k({tid:j,_p:F(),v:"2",sr:(s.width*w.devicePixelRatio+"x"+s.height*w.devicePixelRatio).toString(),ul:(nav.language||0[0]).toLowerCase(),cid:_(),_fv:v(),_s:"1",dl:docLoc.origin+docLoc.pathname+i,dt:doc.title||0[0],dr:doc.referrer||0[0],sid:p(),sct:g(),seg:"1",en:u(),"epn.percent_scrolled":f(),"ep.search_term":C(),"ep.file_extension":e||0[0],"ep.file_name":t||0[0],"ep.link_text":n||0[0],"ep.link_url":o||0[0],_ss:O(),_dbg:A?1:0[0]}),l=S+"?"+M;if(nav.sendBeacon)nav.sendBeacon(l);else{let e=new XMLHttpRequest;e.open("POST",l,!0)}}a();function sPr(){return(docEl.scrollTop||docBody.scrollTop)/((docEl.scrollHeight||docBody.scrollHeight)-docEl.clientHeight)*100}doc.addEventListener("scroll",sEv,{passive:!0});function sEv(){const e=sPr();if(e<90)return;enScroll=!0,a(),doc.removeEventListener("scroll",sEv,{passive:!0}),enScroll=!1}document.addEventListener("DOMContentLoaded",function(){let e=document.getElementsByTagName("a");for(let t=0;t<e.length;t++)if(e[t].getAttribute("href")!=null){const n=e[t].getAttribute("href"),s=n.substring(n.lastIndexOf("/")+1),o=s.split(".").pop();(e[t].hasAttribute("download")||extensions.includes(o))&&e[t].addEventListener("click",fDl,{passive:!0})}});function fDl(e){enFdl=!0;const t=e.currentTarget.getAttribute("href"),n=t.substring(t.lastIndexOf("/")+1),s=n.split(".").pop(),o=n.replace("."+s,""),i=e.currentTarget.text,r=t.replace(docLoc.origin,"");a(s,o,i,r),enFdl=!1}</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>