{"version":"https://jsonfeed.org/version/1.1","title":"流动","home_page_url":"https://liudon.com/","feed_url":"https://liudon.com/index.json","authors":[{"name":"Liudon"}],"items":[{"title":"大连之行","id":"https://liudon.com/posts/dalian-trip/","url":"https://liudon.com/posts/dalian-trip/","summary":"\u003cp\u003e6月底，趁着娃刚考完试，学校也没课了，请假带娃去大连玩了一趟。\u003c/p\u003e\n\u003cp\u003e这次是跟娃好朋友一起出行，人两口子以前做旅行社的，直接搞了一个行程表，我们就跟报了个旅行团一样。\u003c/p\u003e","content_html":"\u003cp\u003e6月底，趁着娃刚考完试，学校也没课了，请假带娃去大连玩了一趟。\u003c/p\u003e\n\u003cp\u003e这次是跟娃好朋友一起出行，人两口子以前做旅行社的，直接搞了一个行程表，我们就跟报了个旅行团一样。\u003c/p\u003e\n\u003ch3 id=\"第一天\"\u003e第一天\u003c/h3\u003e\n\u003cp\u003e下午14:13到达大连北站，当地租车然后直奔酒店。\u003c/p\u003e\n\u003cp\u003e办理入住，放下行李简单休息后，开车去赶海。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG207.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG207.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG207.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG208.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG208.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG208.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e一片砾石滩，找了本地人，提供装备带着进去赶海。\u003c/p\u003e\n\u003cp\u003e雨鞋就是薄薄一层，需要先走过一片海滩，特别地硌脚，路上还有特别多绿苔，非常地滑。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13226.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13226.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13226.jpg\" width=\"1080\" height=\"1921\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13227.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13227.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13227.jpg\" width=\"1080\" height=\"1921\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13228.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13228.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13228.jpg\" width=\"1024\" height=\"1820\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e翻石头抓螃蟹，玩的不亦乐乎。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13229.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13229.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13229.jpg\" width=\"1080\" height=\"1921\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e晚上小酌一下。\u003c/p\u003e\n\u003ch3 id=\"第二天\"\u003e第二天\u003c/h3\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG209.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG209.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG209.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG210.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG210.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG210.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e酒店就在海边，早起出来海边溜达一圈，大早起就有大爷在海里游泳了。\u003c/p\u003e\n\u003cp\u003e早上酒店吃完早餐，出发动物园。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG211.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG211.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG211.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG213.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG213.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG213.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG214.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG214.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG214.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e今天大雾，白茫茫一片，缆车什么都看不到。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG215.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG215.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG215.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13231.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13231.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13231.jpg\" width=\"1080\" height=\"1921\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e银沙滩喂海鸥，一根香肠直接给我叼走了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13234.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13234.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13234.jpg\" width=\"1080\" height=\"1921\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e中午火锅，环境很棒，吃的很开心。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG216.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG216.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG216.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG217.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG217.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG217.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e大连自然博物馆，溜达一圈。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG218.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG218.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG218.jpg\" width=\"1080\" height=\"1350\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e星海广场打卡，难得碰到了一会晴天。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG220.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG220.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG220.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG221.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG221.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG221.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG219.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG219.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG219.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e晚上小吃街，吃到饱。\u003c/p\u003e\n\u003ch3 id=\"第三天\"\u003e第三天\u003c/h3\u003e\n\u003cp\u003e今天有雨不出门，安排在酒店水上乐园活动。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG222.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG222.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG222.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG224.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG224.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG224.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG223.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG223.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG223.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e水上漂流，呛了几口水，总算学会漂了，真挺好玩。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG225.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG225.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG225.jpg\" width=\"1080\" height=\"608\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e造浪池，全都玩嗨了，就往浪大的地方去。\u003c/p\u003e\n\u003ch3 id=\"第四天\"\u003e第四天\u003c/h3\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG226.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG226.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG226.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG227.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG227.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG227.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e早上起来去喂梅花鹿。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG228.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG228.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG228.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e大连美术馆，偶遇大雨，躲在馆里避雨。\u003c/p\u003e\n\u003cp\u003e今天是妈妈们逛街日，各种商业街打卡。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG229.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG229.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG229.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13236.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13236.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13236.jpg\" width=\"1024\" height=\"1820\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13237.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13237.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13237.jpg\" width=\"1024\" height=\"1820\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13235.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG13235.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13235.jpg\" width=\"1080\" height=\"608\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e晚上吃的回勺面，超级好吃，强烈推荐。\u003c/p\u003e\n\u003cp\u003e运气好，因为今天下雨没有卖完，被我们赶上了。\u003c/p\u003e\n\u003ch3 id=\"第五天\"\u003e第五天\u003c/h3\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG230.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG230.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG230.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG231.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG231.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG231.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG232.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG232.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG232.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e夏家河赶海，挖蛏子。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG234.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG234.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG234.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG240.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG240.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG240.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG233.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG233.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG233.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG235.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG235.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG235.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG238.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG238.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG238.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG239.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG239.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG239.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e金石滩喂海鸥、挖沙子，天居然还放晴了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG242.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/dalian-trip/WechatIMG242.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG242.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e雾终于散了，原来海对面这么多机器呢。\u003c/p\u003e\n\u003ch3 id=\"第六天\"\u003e第六天\u003c/h3\u003e\n\u003cp\u003e收拾行李，退房，坐火车回京。\u003c/p\u003e\n\u003cp\u003e愉快的假期一晃就过去了，期待下次的出行。\u003c/p\u003e\n","date_published":"2025-08-03T20:55:36+08:00","tags":["旅行"]},{"title":"回家收麦","id":"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/","url":"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/","summary":"\u003cp\u003e家里有两块地，一块离的远租出去了，另一块近的老爸老妈还在自己种。\u003c/p\u003e\n\u003cp\u003e自从上高中后，就很少下地了，现在让我下地，我都找不到自家地。\u003c/p\u003e\n\u003cp\u003e老爸生日回家，刚好赶上收麦，记录一下。\u003c/p\u003e","content_html":"\u003cp\u003e家里有两块地，一块离的远租出去了，另一块近的老爸老妈还在自己种。\u003c/p\u003e\n\u003cp\u003e自从上高中后，就很少下地了，现在让我下地，我都找不到自家地。\u003c/p\u003e\n\u003cp\u003e老爸生日回家，刚好赶上收麦，记录一下。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG198.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG198.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG198.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG199.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG199.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG199.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG200.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG200.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG200.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e到地里没半个小时，收割机就弄完了，直接拉到粮食点卖掉。\u003c/p\u003e\n\u003cp\u003e遥想以前小时候，还得用镰割，割完拉回来，中午还要打场，现在真的是省事了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG201.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG201.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG201.jpg\" width=\"1080\" height=\"1920\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG202.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG202.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG202.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e爸妈自己种的西红柿和黄瓜。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG203.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG203.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG203.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG204.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG204.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG204.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG205.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG205.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG205.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG206.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%9B%9E%E5%AE%B6%E6%94%B6%E9%BA%A6/WechatIMG206.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG206.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e门前种的山楂、葡萄、核桃、石榴。\u003c/p\u003e\n","date_published":"2025-08-03T20:39:18+08:00","tags":[]},{"title":"六一儿童节爬长城","id":"https://liudon.com/posts/hiking-great-wall-childrens-day/","url":"https://liudon.com/posts/hiking-great-wall-childrens-day/","summary":"\u003cp\u003e六一儿童节，娃和好朋友约好一起爬长城。\u003c/p\u003e\n\u003cp\u003e去年我们\u003ca href=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/\"\u003e去过慕田峪长城\u003c/a\u003e，人不多、好爬不累，两家商量后决定还是去慕田峪。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG189.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG189.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG189.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG190.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG190.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG190.jpg\" width=\"1080\" height=\"1920\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e早上打车到清河站，还是粉色的小火车。\u003c/p\u003e\n\u003cp\u003e这次人多没占到位置，俩小朋友只能席地而坐了。\u003c/p\u003e","content_html":"\u003cp\u003e六一儿童节，娃和好朋友约好一起爬长城。\u003c/p\u003e\n\u003cp\u003e去年我们\u003ca href=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/\"\u003e去过慕田峪长城\u003c/a\u003e，人不多、好爬不累，两家商量后决定还是去慕田峪。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG189.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG189.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG189.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG190.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG190.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG190.jpg\" width=\"1080\" height=\"1920\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e早上打车到清河站，还是粉色的小火车。\u003c/p\u003e\n\u003cp\u003e这次人多没占到位置，俩小朋友只能席地而坐了。\u003c/p\u003e\n\u003cp\u003e到了之后，直奔摆渡车，缆车上山。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG191.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG191.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG191.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG192.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG192.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG192.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG193.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG193.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG193.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG194.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG194.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG194.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG196.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG196.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG196.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG197.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG197.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG197.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e今天有雾，雾中的长城也是另一番景色。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG13223.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG13223.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13223.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG13224.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG13224.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13224.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e媳妇第一次爬慕田峪，一起登顶。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG13225.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hiking-great-wall-childrens-day/WechatIMG13225.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG13225.jpg\" width=\"1080\" height=\"1921\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e排队1个多小时，终于坐上了小朋友心心念的滑道，确实很好玩。\u003c/p\u003e\n\u003cp\u003e下山打车往车站赶，结果碰到堵车，没赶上火车。\u003c/p\u003e\n\u003cp\u003e折腾半天总算改签上7点的车，在车站点了个KFC，边吃边等车，晚上9点总算到家了。\u003c/p\u003e\n\u003cp\u003e儿童节快乐～\u003c/p\u003e\n","date_published":"2025-08-03T20:00:23+08:00","tags":["遛娃"]},{"title":"Golang database/sql 数据库断线自动重连机制解析","id":"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/","url":"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/","summary":"\u003cp\u003e最近有个交接服务的数据库要升级版本，升级最后切换瞬间会有一个闪断。\u003c/p\u003e\n\u003cp\u003e这里业务侧需要确保有自动重连机制，否则会影响服务。\u003c/p\u003e\n\u003cp\u003e因为是交接的服务，得通过代码再确认一下。\u003c/p\u003e","content_html":"\u003cp\u003e最近有个交接服务的数据库要升级版本，升级最后切换瞬间会有一个闪断。\u003c/p\u003e\n\u003cp\u003e这里业务侧需要确保有自动重连机制，否则会影响服务。\u003c/p\u003e\n\u003cp\u003e因为是交接的服务，得通过代码再确认一下。\u003c/p\u003e\n\u003cp\u003e业务代码里使用了xorm包操作的数据库，连接池管理是底层database/sql负责的。\u003c/p\u003e\n\u003cp\u003e读了一遍代码，总算搞清楚这里断连自动重连的机制了：\u003c/p\u003e\n\u003cp\u003exorm对外的增删改查方法最终都会调用到了exec方法，\u003ca href=\"https://github.com/go-xorm/xorm/blob/f39e5d9bfdb70c435f8649555f224c0fa4f51e54/session_raw.go#L152\"\u003e代码出处\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/17459087308178.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/17459087308178.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"17459087308178.png\" width=\"1080\" height=\"567\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e可以看到这里调到了database/sql里的ExecContext方法，\u003ca href=\"https://cs.opensource.google/go/go/+/refs/tags/go1.18:src/database/sql/sql.go\"\u003e代码出处\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/17459153468139.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/17459153468139.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"17459153468139.png\" width=\"1080\" height=\"671\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这里调用到了exec方法:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003edb.conn 从连接池获取连接；\u003c/li\u003e\n\u003cli\u003edb.execDC 执行sql，最后会通过release方法将连接再放回连接池；\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e这里release传入的是db.releaseConn方法，实现如图:\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/17459153819395.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/17459153819395.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"17459153819395.png\" width=\"1080\" height=\"758\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这里调用了putConn方法，实现如图：\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/17459154175309.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/golang-database-sql-auto-reconnect-mechanism/17459154175309.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"17459154175309.png\" width=\"1080\" height=\"857\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e注意红框部分，这里检查执行结果如果为连接错误，会通过maybeOpenNewConnections创建一个新连接，同时将此连接关闭。\u003c/p\u003e\n","date_published":"2025-04-30T17:37:23+08:00","tags":["golang","database/sql"]},{"title":"Golang默认Http Client导致的cannot assign requested address错误","id":"https://liudon.com/posts/cannot-assign-requested-address-in-golang-http-client/","url":"https://liudon.com/posts/cannot-assign-requested-address-in-golang-http-client/","summary":"\u003ch3 id=\"问题表现\"\u003e问题表现\u003c/h3\u003e\n\u003cp\u003e重现代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;io\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;time\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eclient\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eClient\u003c/span\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eTimeout\u003c/span\u003e: \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDuration\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u0026lt; \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewRequest\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eMethodGet\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://baidu.com\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ersp\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclient\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDo\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;request failed\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ersp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBody\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eClose\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ebody\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadAll\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ersp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBody\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;read body failed\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003ebody\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eselect\u003c/span\u003e {}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e启动后，随着请求越来越多，很快就出现了\u0026quot;cannot assign requested address\u0026quot;错误，服务器出现大量TIME_WAIT连接。\u003c/p\u003e","content_html":"\u003ch3 id=\"问题表现\"\u003e问题表现\u003c/h3\u003e\n\u003cp\u003e重现代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;io\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;time\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eclient\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eClient\u003c/span\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eTimeout\u003c/span\u003e: \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDuration\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u0026lt; \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewRequest\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eMethodGet\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://baidu.com\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ersp\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclient\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDo\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;request failed\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ersp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBody\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eClose\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ebody\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadAll\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ersp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBody\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;read body failed\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003ebody\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eselect\u003c/span\u003e {}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e启动后，随着请求越来越多，很快就出现了\u0026quot;cannot assign requested address\u0026quot;错误，服务器出现大量TIME_WAIT连接。\u003c/p\u003e\n\u003ch3 id=\"问题原因\"\u003e问题原因\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://cs.opensource.google/go/go/+/refs/tags/go1.24.2:src/net/http/client.go;l=61\"\u003enet/http代码\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Client struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t// Transport specifies the mechanism by which individual\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t// HTTP requests are made.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t// If nil, DefaultTransport is used.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tTransport RoundTripper\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e未配置Transport时，使用默认的DefaultTransport。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e DefaultTransport RoundTripper \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eTransport{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tProxy: ProxyFromEnvironment,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tDialContext: defaultTransportDialContext(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003enet\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDialer{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tTimeout:   \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e time\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSecond,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tKeepAlive: \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e time\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSecond,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tForceAttemptHTTP2:     true,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tMaxIdleConns:          \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tIdleConnTimeout:       \u003cspan style=\"color:#ae81ff\"\u003e90\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e time\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSecond,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tTLSHandshakeTimeout:   \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e time\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSecond,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tExpectContinueTimeout: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e time\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSecond,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里指定了最大空闲连接为100，未指定单个host的最大空闲连接。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (t \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eTransport) maxIdleConnsPerHost() \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e v :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e t\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMaxIdleConnsPerHost; v \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e v\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e DefaultMaxIdleConnsPerHost\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果未配置MaxIdleConnsPerHost，则使用默认的DefaultMaxIdleConnsPerHost配置。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e DefaultMaxIdleConnsPerHost is the default value of [Transport]\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e MaxIdleConnsPerHost\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e DefaultMaxIdleConnsPerHost \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这下清楚了：\u003c/p\u003e\n\u003cp\u003e100个协程，请求同一个地址，只能保留2个空闲连接，超出的请求完就会退出，产生一个TIME_WAIT；\u003c/p\u003e\n\u003cp\u003e然后再创建一个连接，请求完关闭，又产生一个TIME_WAIT，直至耗尽端口。\u003c/p\u003e\n\u003ch3 id=\"解决方案\"\u003e解决方案\u003c/h3\u003e\n\u003cp\u003e创建Http.Client时，配置MaxIdleConnsPerHost即可。\u003c/p\u003e\n","date_published":"2025-04-29T20:20:29+08:00","tags":["golang"]},{"title":"清明踏春，爬山看海","id":"https://liudon.com/posts/qingming-festival-holiday-2025/","url":"https://liudon.com/posts/qingming-festival-holiday-2025/","summary":"\u003cp\u003e自从买了登山杖，娃一直说想去爬山。\u003c/p\u003e\n\u003cp\u003e前段时间天气一直不好，山上也还是光秃秃的，就一直没去。\u003c/p\u003e\n\u003cp\u003e趁着清明假期，带娃爬山去。\u003c/p\u003e\n\u003cp\u003e去年假期去过一次香山，路上超堵，这次还是选择了离家不远的百望山：好爬不累。\u003c/p\u003e","content_html":"\u003cp\u003e自从买了登山杖，娃一直说想去爬山。\u003c/p\u003e\n\u003cp\u003e前段时间天气一直不好，山上也还是光秃秃的，就一直没去。\u003c/p\u003e\n\u003cp\u003e趁着清明假期，带娃爬山去。\u003c/p\u003e\n\u003cp\u003e去年假期去过一次香山，路上超堵，这次还是选择了离家不远的百望山：好爬不累。\u003c/p\u003e\n\u003cp\u003e有了登山杖，这次我们没有走以往的大路，直奔山中的小路。\u003c/p\u003e\n\u003cp\u003e一路台阶，走走停停，不到半个小时就登顶了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG166.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG166.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG166.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG167.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG167.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG167.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG162.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG162.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG162.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG163.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG163.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG163.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG164.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG164.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG164.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG165.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG165.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG165.jpg\" width=\"960\" height=\"1280\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e快到山顶的时候起风了，在山上稍作休息便下山了。\u003c/p\u003e\n\u003cp\u003e下山直奔新街口，到老西安饭庄，来个羊肉泡馍。\u003c/p\u003e\n\u003cp\u003e可能是自己掰的馍不够小，感觉没有那么入味，并没有很惊艳。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG168.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG168.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG168.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG169.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG169.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG169.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG170.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG170.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG170.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e吃完饭时间还早，好不容易进一趟城，上后海转转。\u003c/p\u003e\n\u003cp\u003e沿着湖边，慢悠悠地闲逛。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG171.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG171.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG171.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG172.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG172.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG172.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG174.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG174.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG174.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG175.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG175.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG175.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG177.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG177.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG177.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG178.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG178.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG178.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG176.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG176.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG176.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG179.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG179.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG179.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e到了银锭桥，人头攒动。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG180.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG180.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG180.jpg\" width=\"960\" height=\"1280\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG181.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG181.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG181.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e顺着人流，进入烟袋斜街，两边各种文创小店，买了些小吃稍微休息。\u003c/p\u003e\n\u003cp\u003e出烟袋斜街，来鼓楼打个卡。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG182.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG182.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG182.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e继续向前溜达，进入南锣鼓巷。\u003c/p\u003e\n\u003cp\u003e上一次来南锣鼓巷，应该还是刚来北京不久和同事一起来的。\u003c/p\u003e\n\u003cp\u003e依旧是人挤人，扎进胡同里碰到个大爷，提醒不要买东西，这里东西特别贵，匆匆逛完就回家了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG183.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG183.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG183.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG184.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/qingming-festival-holiday-2025/WechatIMG184.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG184.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e一天下来10公里，倒也没有想象的那么累。\u003c/p\u003e\n","date_published":"2025-04-06T22:47:37+08:00","tags":["爬山","遛娃"]},{"title":"购入小牛G400T电动车","id":"https://liudon.com/posts/xiaoniu-g400t-electric-bike-experience/","url":"https://liudon.com/posts/xiaoniu-g400t-electric-bike-experience/","summary":"\u003cp\u003e去年10月底，考虑到老的绿源电动车已经骑了5年，电池越来越不行，马上要冬天了，考虑换个新电动车。\u003c/p\u003e\n\u003cp\u003e到各个品牌店里转了一圈，发现都没有车子，说是新规的缘故，要到11月份才能有新车。\u003c/p\u003e","content_html":"\u003cp\u003e去年10月底，考虑到老的绿源电动车已经骑了5年，电池越来越不行，马上要冬天了，考虑换个新电动车。\u003c/p\u003e\n\u003cp\u003e到各个品牌店里转了一圈，发现都没有车子，说是新规的缘故，要到11月份才能有新车。\u003c/p\u003e\n\u003cp\u003e同事给推荐的小牛F400T，11月之后到店里看了，新规不让卖了，考虑一番选择了G400T。\u003c/p\u003e\n\u003cp\u003e双11活动，京东下单3699元，店里直接提货。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/xiaoniu-g400t-electric-bike-experience/WechatIMG159.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/xiaoniu-g400t-electric-bike-experience/WechatIMG159.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG159.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e第二天直奔车管所，注销旧车，新车上牌。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/xiaoniu-g400t-electric-bike-experience/WechatIMG160.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/xiaoniu-g400t-electric-bike-experience/WechatIMG160.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG160.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e再到京通上申请以旧补贴，500元到手，整个下来3000出头。\u003c/p\u003e\n\u003cp\u003e跟5年前的旧车比，真是天翻地覆的变化，手机解锁、蓝牙/NFC解锁，实时定位。\u003c/p\u003e\n\u003cp\u003e续航也比之前多了很多，冬天最冷的时候三天一充，平时基本一周一充。\u003c/p\u003e\n\u003cp\u003e到现在马上5个月，已经骑行了1000公里。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/xiaoniu-g400t-electric-bike-experience/WechatIMG161.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/xiaoniu-g400t-electric-bike-experience/WechatIMG161.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG161.jpg\" width=\"1080\" height=\"754\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2025-03-26T22:07:21+08:00","tags":[]},{"title":"北京的三月飞雪","id":"https://liudon.com/posts/heavy-snow-in-beijing/","url":"https://liudon.com/posts/heavy-snow-in-beijing/","summary":"\u003cp\u003e盼了一冬天的雪没下，开春了，来了场大雪。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG152.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG152.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG152.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG153.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG153.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG153.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG154.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG154.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG154.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG155.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG155.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG155.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cfigure\u003e\n    \u003cvideo src=2025-03-15.mp4 controls\u003e\n    你的浏览器不支持 \u003ccode\u003evideo\u003c/code\u003e 标签。\n    \u003c/video\u003e\n\u003c/figure\u003e","content_html":"\u003cp\u003e盼了一冬天的雪没下，开春了，来了场大雪。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG152.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG152.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG152.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG153.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG153.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG153.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG154.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG154.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG154.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG155.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/heavy-snow-in-beijing/WechatIMG155.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG155.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cfigure\u003e\n    \u003cvideo src=2025-03-15.mp4 controls\u003e\n    你的浏览器不支持 \u003ccode\u003evideo\u003c/code\u003e 标签。\n    \u003c/video\u003e\n\u003c/figure\u003e\n","date_published":"2025-03-16T18:33:57+08:00","tags":["北京"]},{"title":"wrenAI本地LLM模型部署","id":"https://liudon.com/posts/wrenai-local-llm-usage-guide/","url":"https://liudon.com/posts/wrenai-local-llm-usage-guide/","summary":"\u003cblockquote\u003e\n\u003cp\u003eOpen-source GenBI AI Agent that empowers data-driven teams to chat with their data to generate Text-to-SQL, charts, spreadsheets, reports, and BI.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eWrenAI 是一个开源的Text-SQL 的工具，通过导入数据库结构，通过提问的方式生成SQL。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/wrenai-local-llm-usage-guide/wren_workflow.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/wrenai-local-llm-usage-guide/wren_workflow.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"wren_workflow.png\" width=\"1080\" height=\"437\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003eOpen-source GenBI AI Agent that empowers data-driven teams to chat with their data to generate Text-to-SQL, charts, spreadsheets, reports, and BI.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eWrenAI 是一个开源的Text-SQL 的工具，通过导入数据库结构，通过提问的方式生成SQL。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/wrenai-local-llm-usage-guide/wren_workflow.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/wrenai-local-llm-usage-guide/wren_workflow.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"wren_workflow.png\" width=\"1080\" height=\"437\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e出于安全考虑，我们使用本地llm模型进行部署。\u003c/p\u003e\n\u003ch3 id=\"部署ollama\"\u003e部署ollama\u003c/h3\u003e\n\u003cp\u003e参考安装文档：https://hub.docker.com/r/ollama/ollama\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003efsSL https:\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003envidia\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egithub\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eio\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003elibnvidia\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtainer\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003egpgkey \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e sudo gpg \u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003edearmor \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eo \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eusr\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eshare\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ekeyrings\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003envidia\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtainer\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etoolkit\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ekeyring\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egpg\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003es \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eL https:\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003envidia\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egithub\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eio\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003elibnvidia\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtainer\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003estable\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003edeb\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003envidia\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtainer\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etoolkit\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elist \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g\u0026#39;\u003c/span\u003e \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e sudo tee \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eetc\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eapt\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003esources\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elist\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ed\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003envidia\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtainer\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etoolkit\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elist\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eget update\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eget install \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ey nvidia\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtainer\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etoolkit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo nvidia\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ectk runtime configure \u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003eruntime\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edocker\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl restart docker\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker run \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ed \u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003egpus\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eall \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ev ollama:\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eroot\u003cspan style=\"color:#f92672\"\u003e/.\u003c/span\u003eollama \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ep \u003cspan style=\"color:#ae81ff\"\u003e11434\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e11434\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003ename ollama ollama\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eollama\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e部署对应模型\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker exec -it ollama ollama run nomic-embed-text:latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker exec -it ollama ollama run phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e部署完成后，需要在安全组里放开11434端口访问。\u003c/p\u003e\n\u003ch3 id=\"部署wrenai\"\u003e部署WrenAI\u003c/h3\u003e\n\u003cp\u003e参考官方文档：https://docs.getwren.ai/oss/installation/custom_llm\u003c/p\u003e\n\u003cp\u003e创建本地配置目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p ~/.wrenai\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e配置目录下新增.env文件，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCOMPOSE_PROJECT_NAME=wrenai\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePLATFORM=linux/amd64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePROJECT_DIR=/root/.wrenai\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# service port\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_ENGINE_PORT=8080\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_ENGINE_SQL_PORT=7432\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_AI_SERVICE_PORT=5555\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_UI_PORT=3000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eIBIS_SERVER_PORT=8000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_UI_ENDPOINT=http://wren-ui:${WREN_UI_PORT}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLLM_PROVIDER=litellm_llm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGENERATION_MODEL=phi4:14b // 自定义LLM模型\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLLM_OLLAMA_URL=http://部署机器IP:11434\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEMBEDDER_OLLAMA_URL=http://部署机器IP:11434\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOPENAI_API_KEY=sk-*****\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEMBEDDER_PROVIDER=litellm_embedder\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEMBEDDING_MODEL=nomic-embed-text // embedding模型\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEMBEDDING_MODEL_DIMENSION=768\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# ai service settings\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eQDRANT_HOST=qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSHOULD_FORCE_DEPLOY=1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# vendor keys\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLLM_OPENAI_API_KEY=\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEMBEDDER_OPENAI_API_KEY=\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLLM_AZURE_OPENAI_API_KEY=\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEMBEDDER_AZURE_OPENAI_API_KEY=\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eQDRANT_API_KEY=\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# version\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# CHANGE THIS TO THE LATEST VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_PRODUCT_VERSION=0.15.3\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_ENGINE_VERSION=0.13.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_AI_SERVICE_VERSION=0.15.9\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eIBIS_SERVER_VERSION=0.13.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_UI_VERSION=0.20.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWREN_BOOTSTRAP_VERSION=0.1.5\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# user id (uuid v4)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUSER_UUID=\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# for other services\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePOSTHOG_API_KEY=phc_nhF32aj4xHXOZb0oqr2cn4Oy9uiWzz6CCP4KZmRq9aE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePOSTHOG_HOST=https://app.posthog.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTELEMETRY_ENABLED=true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# this is for telemetry to know the model, i think ai-service might be able to provide a endpoint to get the information\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#GENERATION_MODEL=gpt-4o-mini\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLANGFUSE_SECRET_KEY=\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLANGFUSE_PUBLIC_KEY=\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# the port exposes to the host\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# OPTIONAL: change the port if you have a conflict\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHOST_PORT=3000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAI_SERVICE_FORWARD_PORT=5555\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# Wren UI\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEXPERIMENTAL_ENGINE_RUST_VERSION=false\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e配置目录下新增config.yaml文件，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# you should rename this file to config.yaml and put it in ~/.wrenai\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# please pay attention to the comments starting with # and adjust the config accordingly\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype: llm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprovider: litellm_llm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etimeout: 600\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emodels:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- api_base: http://部署机器IP:11434/v1  # change this to your ollama host, api_base should be \u0026lt;ollama_url\u0026gt;/v1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  model: openai/phi4:14b  # openai/\u0026lt;ollama_model_name\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  kwargs:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    n: 1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    temperature: 0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype: embedder\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprovider: litellm_embedder\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emodels:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- model: openai/nomic-embed-text  # put your ollama embedder model name here\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  api_base: http://部署机器IP:11434/v1  # change this to your ollama host, url should be \u0026lt;ollama_url\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  timeout: 120 # 如果是CPU模式，需要调大这个超时时间\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype: engine\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprovider: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eendpoint: http://wren-ui:3000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype: document_store\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprovider: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elocation: http://qdrant:6333\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eembedding_model_dim: 768  # put your embedding model dimension here\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etimeout: 120\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erecreate_index: false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# the format of llm and embedder should be \u0026lt;provider\u0026gt;.\u0026lt;model_name\u0026gt; such as litellm_llm.gpt-4o-2024-08-06\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# the pipes may be not the latest version, please refer to the latest version: https://raw.githubusercontent.com/canner/WrenAI/\u0026lt;WRENAI_VERSION_NUMBER\u0026gt;/docker/config.example.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype: pipeline\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epipes:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: db_schema_indexing\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: historical_question_indexing\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: table_description_indexing\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: db_schema_retrieval\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: historical_question_retrieval\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_generation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_correction\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: followup_sql_generation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_summary\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_answer\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_breakdown\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_expansion\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_explanation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_regeneration\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: semantics_description\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: relationship_recommendation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: question_recommendation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: question_recommendation_db_schema_retrieval\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: question_recommendation_sql_generation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: chart_generation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: chart_adjustment\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: intent_classification\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: data_assistance\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_pairs_indexing\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_pairs_deletion\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_pairs_retrieval\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document_store: qdrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    embedder: litellm_embedder.openai/nomic-embed-text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: preprocess_sql_data\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_executor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    engine: wren_ui\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_question_generation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: sql_generation_reasoning\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    llm: litellm_llm.openai/phi4:14b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esettings:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  column_indexing_batch_size: 50\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  table_retrieval_size: 10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  table_column_retrieval_size: 100\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  allow_using_db_schemas_without_pruning: false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  query_cache_maxsize: 1000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  query_cache_ttl: 3600\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  langfuse_host: https://cloud.langfuse.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  langfuse_enable: true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  logging_level: DEBUG\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  development: true\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e下载部署shell，执行安装：\n\u003ca href=\"https://docs.getwren.ai/oss/installation#using-wren-ai-launcher\"\u003ehttps://docs.getwren.ai/oss/installation#using-wren-ai-launcher\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eL https:\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003egithub\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecom\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eCanner\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eWrenAI\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ereleases\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003elatest\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003edownload\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ewren\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003elauncher\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003elinux\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etar\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egz \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e tar \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003exz \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003ewren\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003elauncher\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003elinux\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e选择Custom模式，点击确定，部署成功。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/wrenai-local-llm-usage-guide/deploy_wrenai.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/wrenai-local-llm-usage-guide/deploy_wrenai.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"deploy_wrenai.png\" width=\"1080\" height=\"544\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e记得防火墙放通3000端口访问。\u003c/p\u003e\n\u003cp\u003e部署完成后，通过浏览器访问http://部署机器IP:3000访问WrenAI服务。\u003c/p\u003e\n\u003ch3 id=\"限制\"\u003e限制\u003c/h3\u003e\n\u003cp\u003eMySQL当前仅支持8.0以上版本；\u003c/p\u003e\n\u003cp\u003e纯CPU硬件下一次提问耗时在15分钟以上，腾讯云GPU计算型GN7 - 8核 32G下一次提问耗时在5分钟左右。\u003c/p\u003e\n","date_published":"2025-03-16T17:28:10+08:00","tags":["wrenAI","llm"]},{"title":"天津一日游","id":"https://liudon.com/posts/the-trip-of-tianjin/","url":"https://liudon.com/posts/the-trip-of-tianjin/","summary":"\u003cp\u003e娃看完中华寻宝记，一直想去天津转转。\u003c/p\u003e\n\u003cp\u003e大年初九，返京第二天，带娃错峰去一趟天津。\u003c/p\u003e\n\u003cp\u003e7点出门，直奔北京南站，一路不敢耽搁，在发车前10分钟赶上了车。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/IMG_0328.PNG_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/IMG_0328.PNG_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG_0328.PNG\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e","content_html":"\u003cp\u003e娃看完中华寻宝记，一直想去天津转转。\u003c/p\u003e\n\u003cp\u003e大年初九，返京第二天，带娃错峰去一趟天津。\u003c/p\u003e\n\u003cp\u003e7点出门，直奔北京南站，一路不敢耽搁，在发车前10分钟赶上了车。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/IMG_0328.PNG_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/IMG_0328.PNG_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG_0328.PNG\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e以前一直听我爸说老家的河最终流到了海河，在路上看地图，发现确实最终汇入了海河。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG128.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG128.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG128.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG129.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG129.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG129.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG130.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG130.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG130.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG131.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG131.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG131.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG151.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG151.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG151.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG150.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG150.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG150.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e世纪钟，本以为整点会报时来着，等了半天结果不是。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG132.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG132.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG132.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e上午在意式风情区转了转，结果就是一些卖吃的、纪念品的地方，网红书店打卡。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG133.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG133.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG133.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e路上遇到的小蓝车，居然是带后座的，可惜娃太大坐不下了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG134.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG134.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG134.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e桂发祥总店里的大麻花。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG135.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG135.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG135.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e耳朵眼炸糕，来一个就行，多了吃不下。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG136.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG136.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG136.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e中午简单吃个饭，转站五大道，先去听个相声。\u003c/p\u003e\n\u003cp\u003e路过瓷房子，外面简单看一眼就好。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG140.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG140.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG140.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e名流茶馆，特别小的一个门脸。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG137.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG137.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG137.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e上一次现场听相声，还是在北京，那会岳云鹏还没火。\u003c/p\u003e\n\u003cp\u003e2个小时，物超所值，这次天津行最值的一个地方了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG138.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG138.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG138.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG139.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG139.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG139.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e听完出来，外面已经变天，风巨大，特别的冷。\u003c/p\u003e\n\u003cp\u003e简单转了转，直奔古文化街，看摩天轮。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG141.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG141.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG141.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG142.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG142.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG142.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG143.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG143.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG143.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e晚上吃过饭，外面实在是太冷了，风超级大。\u003c/p\u003e\n\u003cp\u003e摩天轮没有开，远远的打个卡。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG146.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG146.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG146.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG148.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG148.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG148.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG147.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG147.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG147.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e返程，又是开车前10分钟上车。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG149.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-tianjin/WechatIMG149.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG149.jpg\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2025-03-16T16:35:23+08:00","tags":["旅行"]},{"title":"2024年终总结","id":"https://liudon.com/posts/review-2024/","url":"https://liudon.com/posts/review-2024/","summary":"\u003cblockquote\u003e\n\u003cp\u003e2024年已经过去3个月了，这篇年终总结从元旦拖到了现在。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e2024年是我的本命年，这一年发生了很多事，这一年过的并不太如意。\u003c/p\u003e\n\u003cp\u003e早就想要总结这一年，但不知道从哪下笔。\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003e2024年已经过去3个月了，这篇年终总结从元旦拖到了现在。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e2024年是我的本命年，这一年发生了很多事，这一年过的并不太如意。\u003c/p\u003e\n\u003cp\u003e早就想要总结这一年，但不知道从哪下笔。\u003c/p\u003e\n\u003ch3 id=\"工作\"\u003e工作\u003c/h3\u003e\n\u003cp\u003e今年的工作愈发忙碌，统计了一下这一年9点半下班打车85次。\u003c/p\u003e\n\u003cp\u003e工作的时间越来越长，持续的加班让整个人变得疲惫、易怒。\u003c/p\u003e\n\u003cp\u003e到公司基本一坐就是一天，没时间活动，尝试了两个月骑行上下班。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2024/IMG_0608.PNG_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2024/IMG_0608.PNG_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG_0608.PNG\" width=\"1080\" height=\"2341\" alt=\"2024年运动\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch3 id=\"生活\"\u003e生活\u003c/h3\u003e\n\u003cp\u003e因为一些事情，跟媳妇闹得一度想要离婚。\u003c/p\u003e\n\u003cp\u003e好在聊开了，也让我懂得有事一定要沟通，不要憋在心里。\u003c/p\u003e\n\u003cp\u003e上一次带娃出行是18年了，趁着暑假带娃出去走走。\u003c/p\u003e\n\u003cp\u003e我们全家去了一趟\u003ca href=\"https://liudon.com/posts/the-trip-of-qingdao/\"\u003e青岛\u003c/a\u003e，虽然时间很短，但是娃玩的很开心。\u003c/p\u003e\n\u003cp\u003e十一的时候，带娃爬了一次\u003ca href=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/\"\u003e长城\u003c/a\u003e，我俩也算“好汉”了。\u003c/p\u003e\n\u003cp\u003e尝试了一次\u003ca href=\"https://liudon.com/posts/changping-42km-greenway-cycling/\"\u003e绿道骑行\u003c/a\u003e，路况不好，不建议走。\u003c/p\u003e\n\u003cp\u003e车技一般，还是容易起步熄火，不过媳妇说开的越来越好了，也敢一个人上路了。\u003c/p\u003e\n\u003ch3 id=\"博客\"\u003e博客\u003c/h3\u003e\n\u003cp\u003e今年可以用笔耕不辍来形容，全年一共更新了23篇内容，共计18w字。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2024/20250310-202737.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2024/20250310-202737.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20250310-202737.png\" width=\"1080\" height=\"632\" alt=\"全年访问趋势\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e访问Top3的文章：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/\"\u003e加速Cloudflare访问\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/hi-follow/\"\u003e你好 Follow\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/replacing-cloudflare-ipfs-gateway-with-self-hosted-gateway/\"\u003e搭建自托管IPFS Gateway服务，替代Cloudflare的IPFS Gateway\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e今年搞定了新站的Google Adsense申请，蚂蚁肉也是肉。\u003c/p\u003e\n\u003ch3 id=\"财务\"\u003e财务\u003c/h3\u003e\n\u003cp\u003e今年把商贷还清了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2024/IMG_7591.PNG_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2024/IMG_7591.PNG_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG_7591.PNG\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e股市收益+24%，重仓NVDA，悲剧的是开年获利已经全部回吐了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2024/IMG_0611.PNG_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2024/IMG_0611.PNG_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG_0611.PNG\" width=\"1080\" height=\"1299\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e新的一年，继续加油！\u003c/p\u003e\n","date_published":"2025-03-07T22:23:14+08:00","tags":["年终总结"]},{"title":"停止使用staticfile.org服务","id":"https://liudon.com/posts/remove-staticfile.org-from-your-website/","url":"https://liudon.com/posts/remove-staticfile.org-from-your-website/","summary":"\u003cp\u003e昨天像往常一样打开博客，发现评论没有加载出来。\u003c/p\u003e\n\u003cp\u003e一开始以为是手机网络问题，用电脑复现了一下，发现twikoo的js访问报错了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/remove-staticfile.org-from-your-website/20241016-175127.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/remove-staticfile.org-from-your-website/20241016-175127.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20241016-175127.png\" width=\"1080\" height=\"207\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e","content_html":"\u003cp\u003e昨天像往常一样打开博客，发现评论没有加载出来。\u003c/p\u003e\n\u003cp\u003e一开始以为是手机网络问题，用电脑复现了一下，发现twikoo的js访问报错了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/remove-staticfile.org-from-your-website/20241016-175127.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/remove-staticfile.org-from-your-website/20241016-175127.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20241016-175127.png\" width=\"1080\" height=\"207\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003estaticfile.org是一个公共的前端cdn，怎么证书有问题了呢？\u003c/p\u003e\n\u003cp\u003e搜索了一下，结果找到这么一篇内容：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e和 WDCP 、LNMP 、OneinStack 一样，这次的 Staticfile 、BootCDN 、Polyfill 事件也是背后指向同一个组织[[1]]。更进一步的研究表明这些组织似乎会恶意攻击其他提供类似服务的供应商，同时采取接触洽谈来并入攻击目标。 在这种做法下，曾经由七牛云提供服务的Staticfile.org被易手，而原先由个人提供服务、由又拍云提供接入服务的BootCSS也同样被易手。 但是这些背后的交易在事件发生前却没有人进行公开，也许是原来的提供者厌倦了日复一日付出却看不到回报的生活，也许是这些组织瞒天过海许下了虚假的承诺，让原本积累了大量用户的基础服务成为了这些组织用来攻击用户们的利刃。\u003c/p\u003e\n\u003cp\u003e详细内容见\u003ca href=\"https://www.v2ex.com/t/1056428\"\u003e供应链投毒后，我们的选择还剩下哪些？\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003estaticfile.org目前已不再由七牛负责维护，而是一个叫河南泉磐网络科技有限公司负责，该服务已不可靠，存在黑产利用的情况。\u003c/p\u003e\n\u003cp\u003e更换为cdnjs.cloudflare.com服务后，评论功能恢复正常。\u003c/p\u003e\n","date_published":"2024-10-17T22:34:29+08:00","tags":[]},{"title":"使用 ImageMagick 自动添加水印，保护图片版权","id":"https://liudon.com/posts/auto-add-watermark-imagemagick-protect-copyright/","url":"https://liudon.com/posts/auto-add-watermark-imagemagick-protect-copyright/","summary":"\u003ch2 id=\"背景\"\u003e背景\u003c/h2\u003e\n\u003cp\u003e细心的朋友可能会发现，我的博客图片都带上了水印。\u003c/p\u003e\n\u003cp\u003e经过\u003ca href=\"https://liudon.com/posts/blog-malicious-mirroring/\"\u003e博客被恶意镜像\u003c/a\u003e这个事情后，我一直在思考如何防止内容被恶意盗用，尤其是博客里的一些图片。\u003c/p\u003e\n\u003cp\u003e在\u003ca href=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/\"\u003e当Hugo遇上AVIF，优化图片加载\u003c/a\u003e这篇文章里，使用了ImageMagick工具做了图片压缩。\u003c/p\u003e\n\u003cp\u003e当时文章最后说留了个坑，其实就是今天的这篇内容，利用ImageMagick自动给图片添加水印。\u003c/p\u003e","content_html":"\u003ch2 id=\"背景\"\u003e背景\u003c/h2\u003e\n\u003cp\u003e细心的朋友可能会发现，我的博客图片都带上了水印。\u003c/p\u003e\n\u003cp\u003e经过\u003ca href=\"https://liudon.com/posts/blog-malicious-mirroring/\"\u003e博客被恶意镜像\u003c/a\u003e这个事情后，我一直在思考如何防止内容被恶意盗用，尤其是博客里的一些图片。\u003c/p\u003e\n\u003cp\u003e在\u003ca href=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/\"\u003e当Hugo遇上AVIF，优化图片加载\u003c/a\u003e这篇文章里，使用了ImageMagick工具做了图片压缩。\u003c/p\u003e\n\u003cp\u003e当时文章最后说留了个坑，其实就是今天的这篇内容，利用ImageMagick自动给图片添加水印。\u003c/p\u003e\n\u003ch2 id=\"实现\"\u003e实现\u003c/h2\u003e\n\u003cp\u003e思路其实和之前图片压缩一样，还是在Github Action里使用ImageMagick工具进行添加水印操作，不依赖第三方云服务。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/Liudon/liudon.github.io/blob/code/.github/workflows/main.yml\"\u003eworkflow代码\u003c/a\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Compress \u003cspan style=\"color:#a6e22e\"\u003eImage\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erun: \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 安装依赖\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo apt\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eget update\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo apt\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eget install \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ey build\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eessential libx11\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libxext\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev zlib1g\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        libpng\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libjpeg\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libfreetype6\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libxml2\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev liblcms2\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        libopenexr\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libtiff\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libraw\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libheif\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libde265\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        libfftw3\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libglib2\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev libwebp\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edev\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 编译ImageMagick\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    wget https:\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003edownload\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eimagemagick\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eorg\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eImageMagick\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003edownload\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eImageMagick\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etar\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    tar xvzf ImageMagick\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etar\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    cd ImageMagick\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e7.\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003econfigure\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    make\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo make install\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo ldconfig \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eusr\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003elocal\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003elib\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    magick \u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003eversion\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    cd \u003cspan style=\"color:#f92672\"\u003e../\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 将原图转换大小，同时添加文本水印\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    find \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003econtent\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eposts\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etype f \\( \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.jpg\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eo \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.png\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eo \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.jpeg\u0026#34;\u003c/span\u003e \\) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eexec magick {} \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003epointsize \u003cspan style=\"color:#ae81ff\"\u003e48\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003efill \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;#909090\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003efont \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003estatic\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eArchitectsDaughter\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eRegular\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ettf \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003egravity south \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eannotate \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;@liudon\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ehttps://liudon.com\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eresize \u003cspan style=\"color:#ae81ff\"\u003e1080\u003c/span\u003ex\\\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e {} \\;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 将处理后的原图生成webp格式文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    find \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003econtent\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eposts\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etype f \\( \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.jpg\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eo \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.png\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eo \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.jpeg\u0026#34;\u003c/span\u003e \\) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eexec magick {} \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003equality \u003cspan style=\"color:#ae81ff\"\u003e75\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edefine webp:image\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ehint\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ephoto {}_1080x\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ewebp \\;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 将处理后的原图生成avif格式文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    find \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003econtent\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eposts\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etype f \\( \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.jpg\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eo \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.png\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eo \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.jpeg\u0026#34;\u003c/span\u003e \\) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eexec magick {} {}_1080x\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eavif \\;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e先将原图进行大小转换，同时添加文本水印：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-fill #909090 代表水印颜色\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-pointsize 48 代表水印文字大小\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-font ./static/ArchitectsDaughter-Regular.ttf 代表水印字体，我使用了ArchitectsDaughter字体，提前下载到了git仓库\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@liudon\\nhttps://liudon.com 代表文本水印内容，\\n表示换行\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-gravity south 水印位置，九宫格位置\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-annotate +0+20 水印偏移\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://fonts.google.com/specimen/Architects+Daughter\"\u003e水印字体文件下载\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e将处理后的原图生成webp和avif格式文件\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cem\u003e注意，通过\u003ccode\u003esudo apt-get install -y imagemagick libheif-dev\u003c/code\u003e安装的ImageMagick版本是6.x，转换过程会有些问题，所以这里改为了通过源码编译最新7.x版本，编译的时间略久一些。\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVersion: ImageMagick 7.1.1-39 Q16-HDRI x86_64 22428 https://imagemagick.org\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCopyright: (C) 1999 ImageMagick Studio LLC\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLicense: https://imagemagick.org/script/license.php\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFeatures: Cipher DPC HDRI OpenMP(4.5) \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDelegates (built-in): bzlib djvu fontconfig freetype heic jbig jng jp2 jpeg lcms lqr lzma openexr png raw tiff webp x xml zlib zstd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCompiler: gcc (11.4)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e好了，这样后续提交Github后，Workflow就会自动利用ImageMagick帮我们处理图片了。\u003c/p\u003e\n","date_published":"2024-10-12T23:32:31+08:00","tags":["imagemagick","github","版权"]},{"title":"如何注册一个.sol域名","id":"https://liudon.com/posts/how-to-register-a-.sol-domain-name/","url":"https://liudon.com/posts/how-to-register-a-.sol-domain-name/","summary":"\u003cp\u003eLivid大佬新搞了个\u003ca href=\"https://www.v2ex.com/t/1078126\"\u003e支持Solana的IPFS/IPNS网关\u003c/a\u003e，了解到还有一个\u003ccode\u003e.sol\u003c/code\u003e的web3域名。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSolana域名服务（SNS）的目标是提供一种去中心化且可负担的方式，将域名（.sol）和链上数据连接起来。这些链上数据可以是SOL地址、 IPFS CID、图片、文本、或者任何其它的东西。\u003c/p\u003e","content_html":"\u003cp\u003eLivid大佬新搞了个\u003ca href=\"https://www.v2ex.com/t/1078126\"\u003e支持Solana的IPFS/IPNS网关\u003c/a\u003e，了解到还有一个\u003ccode\u003e.sol\u003c/code\u003e的web3域名。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSolana域名服务（SNS）的目标是提供一种去中心化且可负担的方式，将域名（.sol）和链上数据连接起来。这些链上数据可以是SOL地址、 IPFS CID、图片、文本、或者任何其它的东西。\u003c/p\u003e\n\u003cp\u003eThe mechanics of purchasing a .sol domain are a bit different than ENS — they don’t expire and most domain sales are run via auction.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://brandsec.com.au/sol-domains/\"\u003ehttps://brandsec.com.au/sol-domains/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e哇塞，这域名没有过期一说，不需要续费。\u003c/p\u003e\n\u003cp\u003e正好\u003ccode\u003eliudon.sol\u003c/code\u003e还未注册，决定入手。\u003c/p\u003e\n\u003cp\u003e用MetaMask试了下，连接钱包的时候没有反应，问了下Livid，说是得用Phantom。\u003c/p\u003e\n\u003cp\u003e下载好Phantom，在\u003ca href=\"https://sns.id\"\u003esns.id\u003c/a\u003e注册域名，提交订单的时候发现不支持ETH支付。\u003c/p\u003e\n\u003cp\u003e又回到MetaMask，用ETH兑换USDC。\u003c/p\u003e\n\u003cp\u003e但是提交订单支付的时候，提示还是没有USDC。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-register-a-.sol-domain-name/WechatIMG118.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-register-a-.sol-domain-name/WechatIMG118.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG118.jpg\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-register-a-.sol-domain-name/WechatIMG119.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-register-a-.sol-domain-name/WechatIMG119.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG119.jpg\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e奇了怪了，请教了一下Livid，原来这俩是不同的网络：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMetaMask使用的是Ethereum；\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePhantom使用的是Solana；\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e按Livid的提示，用交易所把USDC转到了Phantom钱包。\u003c/p\u003e\n\u003cp\u003e重新付款，又提示没有SOL，查了一下，原来Solana网络手续费都是用的SOL。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-register-a-.sol-domain-name/WechatIMG121.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-register-a-.sol-domain-name/WechatIMG121.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG121.jpg\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e又回到MetaMask兑换了些SOL，然后通过交易所转换时，发现必须得有SOL支付手续费才能进行转换。\u003c/p\u003e\n\u003cp\u003e呃，这下彻底死胡同了。\u003c/p\u003e\n\u003cp\u003e再次请教Livid，通过交易所兑换了些SOL，转到了Phantom钱包，这下总算搞定了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-register-a-.sol-domain-name/WechatIMG122.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-register-a-.sol-domain-name/WechatIMG122.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG122.jpg\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e现在，你可以通过\u003ca href=\"https://liudon.sol.build\"\u003ehttps://liudon.sol.build\u003c/a\u003e访问了。\u003c/p\u003e\n","date_published":"2024-10-10T21:37:48+08:00","tags":["web3","metamask","phantom"]},{"title":"奥森公园半日游","id":"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/","url":"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/","summary":"\u003cp\u003e假期第三天，腰间盘犯了，在家躺了三天。\u003c/p\u003e\n\u003cp\u003e假期最后一天，感觉轻了许多，今天北京天气非常好，带娃出来走走。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG101.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG101.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG101.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG111.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG111.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG111.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e","content_html":"\u003cp\u003e假期第三天，腰间盘犯了，在家躺了三天。\u003c/p\u003e\n\u003cp\u003e假期最后一天，感觉轻了许多，今天北京天气非常好，带娃出来走走。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG101.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG101.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG101.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG111.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG111.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG111.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG115.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG115.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG115.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG116.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG116.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG116.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e不同角度的奥林匹克塔，第一次登上仰山俯视整个奥林匹克广场。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG103.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG103.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG103.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG105.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG105.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG105.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e鸟巢。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG102.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG102.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG102.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG108.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG108.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG108.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e娃发现的红蜻蜓和蝴蝶。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG107.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG107.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG107.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG110.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG110.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG110.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG112.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG112.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG112.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e拍娃。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG109.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG109.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG109.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG113.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG113.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG113.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG117.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/half-day-tour-of-olympic-forest-park/WechatIMG117.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG117.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e水上运动。\u003c/p\u003e\n","date_published":"2024-10-07T22:24:55+08:00","tags":["遛娃"]},{"title":"昌平42公里骑行绿道打卡","id":"https://liudon.com/posts/changping-42km-greenway-cycling/","url":"https://liudon.com/posts/changping-42km-greenway-cycling/","summary":"\u003cp\u003e五一的时候带娃骑过南边这段，网上查了说北边这段不好骑，难得2号下午有空，决定先自己走一遍看看。\u003c/p\u003e\n\u003cp\u003e从家附近的奥北森林公园开始，骑行到沙河水库，整个行程近30公里，耗时3个小时左右。\u003c/p\u003e","content_html":"\u003cp\u003e五一的时候带娃骑过南边这段，网上查了说北边这段不好骑，难得2号下午有空，决定先自己走一遍看看。\u003c/p\u003e\n\u003cp\u003e从家附近的奥北森林公园开始，骑行到沙河水库，整个行程近30公里，耗时3个小时左右。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG55.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG55.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG55.jpg\" width=\"1080\" height=\"2341\" alt=\"骑行概要\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG56.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG56.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG56.jpg\" width=\"1080\" height=\"2341\" alt=\"路线\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG57.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG57.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG57.jpg\" width=\"1080\" height=\"2342\" alt=\"共享单车\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e奥北森林公园不大，出来后要走一段太平庄中街和建材城东路的社会路段，目前还在施工，道路坑洼不好骑，不过还好并不长。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG99.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG99.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG99.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG98.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG98.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG98.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e路过霍家营小区，查了一下原来是个霍家营村。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG58.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG58.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG58.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e进入霍营公园，里面很大，有专门的骑行道。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG59.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG59.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG59.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG60.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG60.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG60.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG61.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG61.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG61.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e出公园后，穿过马路，过桥右拐，注意别走错，是直接过桥。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG66.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG66.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG66.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG63.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG63.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG63.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG64.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG64.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG64.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG65.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG65.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG65.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e路过第一个路标，还是继续树林间骑行，道路一般，没有公园的专用道好骑。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG67.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG67.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG67.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG68.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG68.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG68.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e树叶已经开始变黄了，没想到，在北京还能看见一片玉米地。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG69.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG69.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG69.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG70.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG70.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG70.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e平西府的介绍，出来后上北清路转上承路，这段是社会道路，也正在施工，不好骑。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG71.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG71.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG71.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG72.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG72.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG72.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG73.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG73.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG73.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e路边有个小口子，从这进入一片绿地，地图上看在白庙村附近。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG74.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG74.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG74.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG75.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG75.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG75.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG76.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG76.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG76.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG100.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG100.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG100.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e穿过社会道路，注意安全。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG79.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG79.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG79.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG80.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG80.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG80.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e看定位在温都水城附近了，还要再穿一次社会道路。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG81.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG81.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG81.jpg\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG83.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG83.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG83.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e林间绿道结束了，出来就是定泗路，非常难走的一段，路窄，而且各种大车。\u003c/p\u003e\n\u003cp\u003e记住这个小口子，回来的时候一不小心错过，白骑了好一段路。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG85.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG85.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG85.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG84.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG84.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG84.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG86.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG86.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG86.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e定泗路转苍龙街，然后就开始沿着温榆河一直走，路也很窄，还是有点危险的。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG87.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG87.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG87.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG88.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG88.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG88.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG90.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG90.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG90.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e沙河水库正在改造施工，我按地图路线走的，结果到跟前没法继续了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG91.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG91.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG91.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG92.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG92.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG92.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e正确的路线应该是在来的路上有一个过河的导行路，从那里过去。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG93.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG93.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG93.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG94.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG94.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG94.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e休息了20分钟，打道回府。\u003c/p\u003e\n\u003cp\u003e总结来说，北边这段路线要穿越占用社会道路，定泗路开始尤其危险，并不适合带娃骑行。\u003c/p\u003e\n\u003cp\u003e路上的一些杂拍，穿林而过，感觉挺好。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG95.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG95.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG95.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG77.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG77.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG77.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG96.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG96.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG96.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG97.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/changping-42km-greenway-cycling/WechatIMG97.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG97.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2024-10-05T17:21:21+08:00","tags":["骑行"]},{"title":"十月一日爬慕田峪长城","id":"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/","url":"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/","summary":"\u003cp\u003e早上5点半起床洗漱，6点出门打车直奔清河站，6点50的火车S515清河-雁栖湖。\u003c/p\u003e\n\u003cp\u003e虽然坐地铁经常路过清河站，但还是第一次来清河站坐车。\u003c/p\u003e\n\u003cp\u003e我们提前20分钟到的车站，已经开始排队了。\u003c/p\u003e","content_html":"\u003cp\u003e早上5点半起床洗漱，6点出门打车直奔清河站，6点50的火车S515清河-雁栖湖。\u003c/p\u003e\n\u003cp\u003e虽然坐地铁经常路过清河站，但还是第一次来清河站坐车。\u003c/p\u003e\n\u003cp\u003e我们提前20分钟到的车站，已经开始排队了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG37.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG37.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG37.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e等了一小会就开始进站了，提前进站台等车。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG39.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG39.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG39.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e终于见到了传说中粉色的怀密线列车了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG40.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG40.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG40.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这趟车跟普通火车不一样，不是固定座位。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG38.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG38.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG38.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e清河是第二站，上车还是有座的。\u003c/p\u003e\n\u003cp\u003e1个小时到雁栖湖站，出站打了个滴滴，半个小时左右到慕田峪长城。\u003c/p\u003e\n\u003cp\u003e进门往前走，直奔摆渡车，景区里人还不多。\u003c/p\u003e\n\u003cp\u003e摆渡车下来，继续往前，会先路过索道滑道的入口，我们是缆车继续往前走。\u003c/p\u003e\n\u003cp\u003e上缆车，几分钟就到山顶了，直奔西线开爬。\u003c/p\u003e\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG44.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG44.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"WechatIMG44.jpg#center\"width=\"1080\"height=\"1441\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            一望无际的长城\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG46.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG46.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"WechatIMG46.jpg#center\"width=\"1080\"height=\"810\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            远眺中国尊\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG48.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG48.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"WechatIMG48.jpg#center\"width=\"1080\"height=\"1441\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            特别陡的好汉坡\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG50.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG50.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"WechatIMG50.jpg#center\"width=\"1080\"height=\"810\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            登顶后的风光\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG52.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG52.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG52.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG45.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG45.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG45.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG51.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG51.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG51.jpg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e因为在电视上看过八达岭长城十一的阵势，特意选了人少一些的慕田峪长城。\u003c/p\u003e\n\u003cp\u003e整个行程下来，人都不算太多。\u003c/p\u003e\n\u003cp\u003e当天风特别大，还好穿了抗风的外套。\u003c/p\u003e\n\u003cp\u003e另外爬好汉坡的时候，短短几分钟，经历了大晴天-\u0026gt;下雨-\u0026gt;下雪-\u0026gt;大晴天的变化。\u003c/p\u003e\n\u003cp\u003e西线除了最后的好汉坡，大部分地方都是平路，台阶都很少。\u003c/p\u003e\n\u003cp\u003e我们走走停停，3个小时左右就下山了，感觉并没有太累。\u003c/p\u003e\n\u003cp\u003e回程没买到雁栖湖站的票，只好买的怀柔北站。\u003c/p\u003e\n\u003cp\u003e幸好买的怀柔北站，赶上十一学生回家，怀柔北站上车就没座了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG54.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/climbing-mutianyu-great-wall-on-october-1st/WechatIMG54.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG54.jpg\" width=\"1080\" height=\"1441\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2024-10-04T22:43:24+08:00","tags":["遛娃"]},{"title":"当Hugo遇上AVIF，优化图片加载","id":"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/","url":"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/","summary":"\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/avif-on-hugo.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/avif-on-hugo.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"avif-on-hugo.png\" width=\"1080\" height=\"328\" alt=\"avif-on-hugo\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这篇文章会介绍基于Github Workflow使用ImageMagick生成AVIF图片，来优化Hugo站点的加载速度。\u003c/p\u003e","content_html":"\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/avif-on-hugo.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/avif-on-hugo.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"avif-on-hugo.png\" width=\"1080\" height=\"328\" alt=\"avif-on-hugo\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这篇文章会介绍基于Github Workflow使用ImageMagick生成AVIF图片，来优化Hugo站点的加载速度。\u003c/p\u003e\n\u003ch2 id=\"背景\"\u003e背景\u003c/h2\u003e\n\u003cp\u003eAVIF是什么？\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAVIF（AV1 Image File Format）是一种基于AV1视频编码标准的图像文件格式。\u003c/p\u003e\n\u003cp\u003eA modern image format based on the AV1 video format.\u003c/p\u003e\n\u003cp\u003eAVIF generally has better compression than WebP, JPEG, PNG and GIF and is designed to supersede them.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/support.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/support.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"support.png\" width=\"1080\" height=\"518\" alt=\"browser support avif\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e在2024年，绝大部分浏览器都已经支持了AVIF格式。\u003c/p\u003e\n\u003cp\u003eImageMagick是什么？\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eImageMagick® is a free, open-source software suite, used for editing and manipulating digital images.\u003c/p\u003e\n\u003cp\u003eIt can be used to create, edit, compose, or convert bitmap images, and supports a wide range of file formats, including JPEG, PNG, GIF, TIFF, and Ultra HDR.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eImageMagick是一款用于图像处理的一个工具。\u003c/p\u003e\n\u003ch2 id=\"对比\"\u003e对比\u003c/h2\u003e\n\u003cp\u003eAVIF说的这么好，我们来验证对比一下。\u003c/p\u003e\n\u003cp\u003e对于一张PNG的图片，使用ImageMagick分别生成WEBP和AVIF格式的图片，文件大小如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r--@  1 liudon  staff   1.1M  9 29 23:02 20240922-170856.png\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r--@  1 liudon  staff    15K  9 29 23:08 20240922-170856.png.avif\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r--@  1 liudon  staff    25K  9 29 23:07 20240922-170856.png.webp\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWEBP比PNG要节省90%左右，AVIF要比WEBP再小40%左右。\u003c/p\u003e\n\u003cp\u003e效果出奇的好，开搞吧。\u003c/p\u003e\n\u003ch2 id=\"使用\"\u003e使用\u003c/h2\u003e\n\u003ch3 id=\"1-生成avif文件\"\u003e1. 生成AVIF文件\u003c/h3\u003e\n\u003cp\u003e博客使用了Github Workflow来进行部署，所以生成ImageMagick的工作也就放在了Github Workflow上。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- name: Compress Image\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erun: |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo apt-get update\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo apt-get install -y imagemagick libheif-dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    find ./content/posts/ -type f \\( -name \u0026#34;*.jpg\u0026#34; -o -name \u0026#34;*.png\u0026#34; -o -name \u0026#34;*.jpeg\u0026#34; \\) -exec convert {} -resize 1080x\\\u0026gt; -quality 75 -define webp:image-hint=photo {}_1080x.webp \\;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    find ./content/posts/ -type f \\( -name \u0026#34;*.jpg\u0026#34; -o -name \u0026#34;*.png\u0026#34; -o -name \u0026#34;*.jpeg\u0026#34; \\) -exec convert {} -resize 1080x\\\u0026gt; {}_1080x.avif \\;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e新增压缩图片步骤，同时生成WEBP和AVIF格式文件。\u003c/p\u003e\n\u003cp\u003e含义说明，可以自行调整：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-resize 1080x\u0026gt; 表示缩放到1080宽，\u0026gt;表示只有在原图宽大于1080时才进行缩放，小于不做处理。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-quality 75 表示处理后图片质量，值越小图越小，图片也越不清晰。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-define webp:image-hint=photo 这里是为了对齐Hugo自身的图片处理参数。\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-使用avif文件\"\u003e2. 使用AVIF文件\u003c/h3\u003e\n\u003cp\u003e修改\u003ccode\u003elayouts/_default/_markup/render-image.html\u003c/code\u003e文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e slice \u003cspan style=\"color:#ae81ff\"\u003e1080\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSizes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(min-width: 768px) 1080px, 100vw\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eholder :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;GIP\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehint :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;photo\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;box\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eDestination :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDestination \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ePage :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePage \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eText :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eText \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eTitle :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTitle \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePage\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default site\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages) \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default true }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePage\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResources\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGetMatch \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDestination }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageTypes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e slice \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e hugo\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsExtended (ne \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMediaType\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eType \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageTypes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageTypes \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e append \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;avif\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}} \u003cspan style=\"color:#f92672\"\u003e\u0026lt;!--\u003c/span\u003e avif need the first \u003cspan style=\"color:#f92672\"\u003e--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageTypes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageTypes \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e append \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;webp\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e gt (index \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e slice \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e range \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageType :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageTypes \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/{{ $imageType }}\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecompressedImage :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e_1080x.\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eDestination \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageType \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecmSrc :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ePage\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResources\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGetMatch \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecompressedImage \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecmSrc \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026lt;!--\u003c/span\u003eavif\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ewebp file exist\u003cspan style=\"color:#f92672\"\u003e--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecmSrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelPermalink \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e absURL}} \u003cspan style=\"color:#ae81ff\"\u003e1080\u003c/span\u003ew\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026lt;!--\u003c/span\u003e hugo \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e support avif format \u003cspan style=\"color:#f92672\"\u003e--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t{{ \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ne \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageType \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;avif\u0026#34;\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e range \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ge \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei }}, {{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResize (print \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eimageType \u003cspan style=\"color:#e6db74\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter) )\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelPermalink \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e absURL}} {{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}w\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t{{ end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; sizes=\u0026#34;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSizes }}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; /\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Destination | safeURL }}\u0026#34;\u003c/span\u003e width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .Width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .Height }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Text }}\u0026#34;\u003c/span\u003e title\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Title }}\u0026#34;\u003c/span\u003e loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Destination | safeURL }}\u0026#34;\u003c/span\u003e width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $src.Width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $src.Height }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Text }}\u0026#34;\u003c/span\u003e title\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Title }}\u0026#34;\u003c/span\u003e loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ end }}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里如果AVIF/WEBP文件已经存在，那么直接使用对应文件（注意：我这里都是生成的1080宽，如果你有调整记得一起调整）；\u003c/p\u003e\n\u003cp\u003e否则会使用Hugo自身的Image Processing生成对应格式文件。\u003c/p\u003e\n\u003ch2 id=\"效果\"\u003e效果\u003c/h2\u003e\n\u003cp\u003e优化前：\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/before.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/before.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"before.jpg\" width=\"1080\" height=\"250\" alt=\"optimize before\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e优化后：\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/after.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/use-avif-to-optimize-images-on-hugo/after.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"after.jpg\" width=\"1080\" height=\"266\" alt=\"optimize after\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e从WEBP切换到AVIF，文件大小减少了30%左右。\u003c/p\u003e\n\u003cp\u003e哈哈，太棒了，效果杠杠滴。\u003c/p\u003e\n\u003cp\u003e唯一的缺点就是每次都是全量生成图片，Workflow执行略久些（我的要5分钟左右），这里后面再优化。\u003c/p\u003e\n\u003cp\u003e从23年11月开始有的想法，在24年9月最后一天终于实现了。🎉🎉🎉\u003c/p\u003e\n","date_published":"2024-09-30T22:01:45+08:00","tags":["博客优化","hugo","avif","imagemagic","github"]},{"title":"博客被恶意镜像","id":"https://liudon.com/posts/blog-malicious-mirroring/","url":"https://liudon.com/posts/blog-malicious-mirroring/","summary":"\u003ch2 id=\"起因\"\u003e起因\u003c/h2\u003e\n\u003cp\u003e9月初的时候，在\u003ccode\u003eGoogle Search Console\u003c/code\u003e里发现了一个外链，域名是\u003ccode\u003e**.top\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e随手点过去看了下，发现居然跟我的博客内容一模一样，就是内容变成了繁体。\u003c/p\u003e","content_html":"\u003ch2 id=\"起因\"\u003e起因\u003c/h2\u003e\n\u003cp\u003e9月初的时候，在\u003ccode\u003eGoogle Search Console\u003c/code\u003e里发现了一个外链，域名是\u003ccode\u003e**.top\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e随手点过去看了下，发现居然跟我的博客内容一模一样，就是内容变成了繁体。\u003c/p\u003e\n\u003cp\u003e知道这肯定是被拿来镜像了，不过当时也没在意，就没管。\u003c/p\u003e\n\u003cp\u003e后来在\u003ca href=\"https://v2ex.com/t/1070859\"\u003ev2ex\u003c/a\u003e上也发现类似的问题，还有其他博主也反馈有被镜像，感觉像是个黑产批量的操作。\u003c/p\u003e\n\u003cp\u003e这周\u003ccode\u003eGoogle Search Console\u003c/code\u003e反馈我的站点有个新问题，点进去一看，嚯。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-192400.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-192400.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240927-192400.png\" width=\"1080\" height=\"744\" alt=\"搜索问题\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e在谷歌里搜了一下，发现已经有很多这个站点的收录了。\u003c/p\u003e\n\u003cp\u003e开始影响到我的博客收录了，这怎么能忍呢，必须处理掉它。\u003c/p\u003e\n\u003ch2 id=\"分析\"\u003e分析\u003c/h2\u003e\n\u003cp\u003e测试了一下这个站点，不得不说，这个人是相当的聪明。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240926-200728.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240926-200728.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240926-200728.jpg\" width=\"1080\" height=\"556\" alt=\"国内访问404\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-100208.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-100208.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240927-100208.png\" width=\"1080\" height=\"463\" alt=\"海外访问200\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e使用了\u003ccode\u003eCloudflare\u003c/code\u003e服务，隐藏了真实的服务ip。\u003c/p\u003e\n\u003cp\u003e同时判断了访问ip，如果是国内用户直接返回了404，海外才会正常返回，这样一般国内用户就发现不了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-102245.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-102245.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240927-102245.png\" width=\"1080\" height=\"273\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e还重写了\u003ccode\u003erobots.txt\u003c/code\u003e，只让谷歌收录。\u003c/p\u003e\n\u003cp\u003e查了一下域名\u003ccode\u003eWhois\u003c/code\u003e信息，注册在阿里云。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-200728.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-200728.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240927-200728.png\" width=\"1080\" height=\"780\" alt=\"whois\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e页面上挂的备案号都是我的，搞事情的话后面再扯上我，这就麻烦了。\u003c/p\u003e\n\u003cp\u003e这就像块牛皮癣，越想越恶心。\u003c/p\u003e\n\u003cp\u003e我的博客搞了两套部署，一套部署在\u003ca href=\"https://liudon.com\"\u003eCloudflare Pages\u003c/a\u003e，一套部署在\u003ca href=\"https://liudon.xyz\"\u003eIPFS\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e接下来就是搞清楚，他是镜像的哪个站点：\u003c/p\u003e\n\u003ch3 id=\"1-ipfs站点\"\u003e1. IPFS站点\u003c/h3\u003e\n\u003cp\u003e看他的\u003ccode\u003erobots.txt\u003c/code\u003e内容，我一开始怀疑是镜像的IPFS站点\u003ca href=\"https://liudon.xyz\"\u003eliudon.xyz\u003c/a\u003e，感觉像是在我的\u003ccode\u003erobots.txt\u003c/code\u003e前面加了一段内容。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u0026#39;https://liudon.xyz/robots.txt\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser-agent: *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDisallow: /\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e幸好还有一个\u003ccode\u003eRobots meta 标记\u003c/code\u003e，于是把IPFS部署的站点加上了这个属性。\u003c/p\u003e\n\u003cp\u003e部署后发现这个镜像站并没有更新，排除了这个可能。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-102447.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/blog-malicious-mirroring/20240927-102447.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240927-102447.png\" width=\"1080\" height=\"273\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch3 id=\"2-github-静态仓库\"\u003e2. Github 静态仓库\u003c/h3\u003e\n\u003cp\u003e我在\u003ccode\u003eGithub\u003c/code\u003e上单独搞了个分支存放生成的静态文件，\u003ccode\u003eCloudflare Pages\u003c/code\u003e直接读取这个分支进行部署。\u003c/p\u003e\n\u003cp\u003e怀疑他是不是监控了这个仓库的提交记录，直接拿这个来部署的镜像站。\u003c/p\u003e\n\u003cp\u003e我把\u003ccode\u003eCloudflare Pages\u003c/code\u003e的自动部署关掉，然后直接修改静态文件。\u003c/p\u003e\n\u003cp\u003e更新后发现，这个静态站并没有预期的更新。\u003c/p\u003e\n\u003ch4 id=\"3-cloudflare-worker\"\u003e3. Cloudflare Worker\u003c/h4\u003e\n\u003cp\u003e在分析过程中，发现我的博客更新后，他的站点也会很快就更新。\u003c/p\u003e\n\u003cp\u003e因为他的网站部署在\u003ccode\u003eCloudflare\u003c/code\u003e上，考虑是走的\u003ccode\u003eCloudflare Worker\u003c/code\u003e反代，直接请求目标站点，然后进行繁体翻译返回。\u003c/p\u003e\n\u003cp\u003e这样就完全不需要关心更新的问题，完全自动化处理，太完美了。\u003c/p\u003e\n\u003ch2 id=\"反制\"\u003e反制\u003c/h2\u003e\n\u003cp\u003e其实这里并没有太好的办法反制，\u003ccode\u003erobots\u003c/code\u003e文件被他重写了，无法控制，使用\u003ccode\u003eRobots meta 标记\u003c/code\u003e的话会影响到我们自己的收录。\u003c/p\u003e\n\u003cp\u003e只能是通过加一段JS代码，参考自\u003ca href=\"https://zhul.in/2024/07/18/my-blog-is-completely-proxied-and-translated-into-traditional-chinese/\"\u003e竹林里有冰\u003c/a\u003e，判断访问的域名非法的话，直接跳转到正确地址。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e host \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e window\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elocation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehost\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (host \u003cspan style=\"color:#f92672\"\u003e!==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;liudon.com\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e host\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estartsWith(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;localhost\u0026#39;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e host\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estartsWith(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;127.0.0.1\u0026#39;\u003c/span\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebody\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003einnerHTML \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;div style=\u0026#34;margin: auto;\u0026#34;\u0026gt;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;h1\u0026gt;当前页面并非本文作者的主页，将在五秒后跳转。\u0026lt;/h1\u0026gt;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;/div\u0026gt;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejoin(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    document\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebody\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estyle \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;background-color: white;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;color: black;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;text-align: center;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;font-size: 50px;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;width: 100vw;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;height: 100vh;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;display: flex;\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejoin(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    setTimeout(() \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        window\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elocation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehref \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;https://liudon.com\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }, \u003cspan style=\"color:#ae81ff\"\u003e5000\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查了一下，搜索Bot爬取的时候会执行js，希望能更新掉已收录的网页信息。\u003c/p\u003e\n","date_published":"2024-09-26T22:18:23+08:00","tags":["cloudflare","github","google"]},{"title":"Github Pages 部署流程解析","id":"https://liudon.com/posts/github-pages-deployment-tutorial/","url":"https://liudon.com/posts/github-pages-deployment-tutorial/","summary":"\u003cp\u003e上周末在\u003ca href=\"https://liudon.com/posts/building-a-workout-page/\"\u003e搭建个人锻炼页面\u003c/a\u003e时，遇到个\u003ccode\u003eGithub Pages\u003c/code\u003e部署的困惑。\u003c/p\u003e\n\u003cp\u003e看了\u003ccode\u003erunning_page\u003c/code\u003e项目文档，是支持部署到\u003ccode\u003eGithub Pages\u003c/code\u003e页面的，对应的操作流程定义在\u003ca href=\"https://github.com/yihong0618/running_page/blob/master/.github/workflows/gh-pages.yml\"\u003egithub/workflows/gh-pages.yml\u003c/a\u003e文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Install dependencies\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: pnpm install\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: PATH_PREFIX\u003cspan style=\"color:#f92672\"\u003e=/$\u003c/span\u003e{{ github\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eevent\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erepository\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ename }} pnpm build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Upload artifact\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uses: actions\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eupload\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003epages\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eartifact\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ev3\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    with:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Upload dist repository\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        path: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;./dist\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Deploy to GitHub Pages\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    id: deployment\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uses: actions\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003edeploy\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003epages\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ev4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e核心逻辑就是上面这段。\u003c/p\u003e","content_html":"\u003cp\u003e上周末在\u003ca href=\"https://liudon.com/posts/building-a-workout-page/\"\u003e搭建个人锻炼页面\u003c/a\u003e时，遇到个\u003ccode\u003eGithub Pages\u003c/code\u003e部署的困惑。\u003c/p\u003e\n\u003cp\u003e看了\u003ccode\u003erunning_page\u003c/code\u003e项目文档，是支持部署到\u003ccode\u003eGithub Pages\u003c/code\u003e页面的，对应的操作流程定义在\u003ca href=\"https://github.com/yihong0618/running_page/blob/master/.github/workflows/gh-pages.yml\"\u003egithub/workflows/gh-pages.yml\u003c/a\u003e文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Install dependencies\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: pnpm install\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: PATH_PREFIX\u003cspan style=\"color:#f92672\"\u003e=/$\u003c/span\u003e{{ github\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eevent\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erepository\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ename }} pnpm build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Upload artifact\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uses: actions\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eupload\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003epages\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eartifact\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ev3\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    with:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Upload dist repository\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        path: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;./dist\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Deploy to GitHub Pages\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    id: deployment\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uses: actions\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003edeploy\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003epages\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ev4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e核心逻辑就是上面这段。\u003c/p\u003e\n\u003cp\u003e之前搞过部署\u003ccode\u003ehugo\u003c/code\u003e静态站点到\u003ccode\u003eGithub Pages\u003c/code\u003e，使用的分支方式部署，编译后的静态文件单独用一个分支存放。\u003c/p\u003e\n\u003cp\u003e这里以我自己的博客项目举例，大致流程如下图：\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/github-pages-deployment-tutorial/20240924-214938.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/github-pages-deployment-tutorial/20240924-214938.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240924-214938.png\" width=\"1080\" height=\"285\" alt=\"github-pages-deploy-flow\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e按我的理解，这里最终访问的文件内容是存在\u003ccode\u003egh-page\u003c/code\u003e分支下的。\u003c/p\u003e\n\u003cp\u003e但是实际部署完\u003ccode\u003erunning_page\u003c/code\u003e项目后，我发现并没有出现\u003ccode\u003egh-page\u003c/code\u003e分支，但是\u003ccode\u003eGithub Pages\u003c/code\u003e却可以正常访问。\u003c/p\u003e\n\u003cp\u003e有点不可思议，这个访问的数据是在哪里的呢？\u003c/p\u003e\n\u003cp\u003e带着这个疑问，在v2ex上发了个\u003ca href=\"https://www.v2ex.com/t/1074875\"\u003e咨询贴\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e经过网友解惑，大致搞明白了这里的流程：\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/github-pages-deployment-tutorial/20240924-215958.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/github-pages-deployment-tutorial/20240924-215958.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240924-215958.png\" width=\"1080\" height=\"495\" alt=\"github-pages-deploy-flow\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eGithub Pages\u003c/code\u003e的发布源有两种方式，通过分支部署和通过\u003ccode\u003eGithub Actions\u003c/code\u003e部署，分别对应上图的两条分支。\u003c/p\u003e\n\u003cp\u003e这里最终都会将build后的静态文件部署到\u003ccode\u003eGithub Pages\u003c/code\u003e服务上，供用户访问。\u003c/p\u003e\n\u003cp\u003e分支部署的方式，其实是有一个\u003ca href=\"https://github.com/Liudon/liudon.github.io/actions/workflows/pages/pages-build-deployment\"\u003e内置工作流\u003c/a\u003e部署到\u003ccode\u003eGithub Pages\u003c/code\u003e服务上的。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/github-pages-deployment-tutorial/20240924-220607.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/github-pages-deployment-tutorial/20240924-220607.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240924-220607.png\" width=\"1080\" height=\"551\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e整个部署流程大致就是这样，最终的静态文件都是存在\u003ccode\u003eGithub Pages\u003c/code\u003e服务上的。\u003c/p\u003e\n","date_published":"2024-09-24T21:30:21+08:00","tags":["github pages"]},{"title":"搭建个人锻炼页面","id":"https://liudon.com/posts/building-a-workout-page/","url":"https://liudon.com/posts/building-a-workout-page/","summary":"\u003cp\u003e工作的缘故，平时基本一坐一天，缺少运动。\u003c/p\u003e\n\u003cp\u003e时间久了，各种毛病也就出来了。\u003c/p\u003e\n\u003cp\u003e搬到新大楼后，每天中午吃完饭楼下遛个弯，走一走，身体精神也好了很多。\u003c/p\u003e\n\u003cp\u003e坚持了一段时间，也不了了之了。\u003c/p\u003e","content_html":"\u003cp\u003e工作的缘故，平时基本一坐一天，缺少运动。\u003c/p\u003e\n\u003cp\u003e时间久了，各种毛病也就出来了。\u003c/p\u003e\n\u003cp\u003e搬到新大楼后，每天中午吃完饭楼下遛个弯，走一走，身体精神也好了很多。\u003c/p\u003e\n\u003cp\u003e坚持了一段时间，也不了了之了。\u003c/p\u003e\n\u003cp\u003e今年开始，决定骑车通勤，上下班路上运动一下。\u003c/p\u003e\n\u003cp\u003e最近在别人博客里发现了运动记录，发现是通过\u003ca href=\"https://github.com/yihong0618/running_page\"\u003erunning_page\u003c/a\u003e项目实现的。\u003c/p\u003e\n\u003cp\u003e顺藤摸瓜，又发现了\u003ca href=\"https://github.com/ben-29/workouts_page\"\u003eworkouts_page\u003c/a\u003e项目，支持多种运动。\u003c/p\u003e\n\u003cp\u003e于是看文档，部署起来，我的\u003ca href=\"https://workout.liudon.com/\"\u003e个人锻炼页面\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/building-a-workout-page/20240922-170856.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/building-a-workout-page/20240922-170856.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240922-170856.png\" width=\"1080\" height=\"504\" alt=\"workout page\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e整个流程：\u003c/p\u003e\n\u003cp\u003e使用\u003ccode\u003eApple Watch\u003c/code\u003e记录运动，导入到\u003ccode\u003eStrava\u003c/code\u003e应用里，在通过\u003ccode\u003eworkouts_page\u003c/code\u003e工作流拉取数据构建页面。\u003c/p\u003e\n\u003cp\u003e部署过程中，顺带发现个问题，提了个PR。\u003c/p\u003e\n\u003cp\u003e这里还有个小插曲，没搞明白PR的流程，在未合入前又提交了其他代码，只好重新提了一个PR。😂\u003c/p\u003e\n","date_published":"2024-09-22T16:57:38+08:00","tags":[]},{"title":"你好 Follow","id":"https://liudon.com/posts/hi-follow/","url":"https://liudon.com/posts/hi-follow/","summary":"\u003cblockquote\u003e\n\u003cp\u003eFollow:  Next generation information browser.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e最近博客圈开始流行\u003ccode\u003eFollow邀请码\u003c/code\u003e，大家各种求码，一码难求。\u003c/p\u003e\n\u003cp\u003e蹲在\u003ccode\u003eDiscord\u003c/code\u003e群里一周，虽然时有发码，但最终还是狼多肉少，抢不到码呀。\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003eFollow:  Next generation information browser.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e最近博客圈开始流行\u003ccode\u003eFollow邀请码\u003c/code\u003e，大家各种求码，一码难求。\u003c/p\u003e\n\u003cp\u003e蹲在\u003ccode\u003eDiscord\u003c/code\u003e群里一周，虽然时有发码，但最终还是狼多肉少，抢不到码呀。\u003c/p\u003e\n\u003cp\u003e上周五好不容易加上管理员，要到了一枚邀请码，终于可以激活体验了。\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003eFollow\u003c/code\u003e里，订阅变的异常简单，输入url，它会自己检查rss订阅。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hi-follow/20240917-010236.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hi-follow/20240917-010236.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240917-010236.png\" width=\"1080\" height=\"498\" alt=\"Follow\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e另外发现我的博客，在\u003ccode\u003eFollow\u003c/code\u003e显示的内容不全。\u003c/p\u003e\n\u003cp\u003e检查了一下，发现是输出的RSS内容不全。\u003c/p\u003e\n\u003cp\u003e修改\u003ccode\u003ehugo\u003c/code\u003e配置文件，开启RSS输出全文。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eShowFullTextinRSS: true\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e从木木大佬那里看到，可以认证自己的Feed，我也来搞一下我的。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThis message is used to verify that this feed (feedId:55815884011044914) belongs to me (userId:56204227179125760). \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eJoin me in enjoying the next generation information browser https://follow.is.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e咱也是带标的了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hi-follow/20240917-012132.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hi-follow/20240917-012132.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240917-012132.png\" width=\"512\" height=\"290\" alt=\"认证\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2024-09-17T00:53:38+08:00","tags":["follow"]},{"title":"中秋爬山","id":"https://liudon.com/posts/mid-autumn-festival-climb/","url":"https://liudon.com/posts/mid-autumn-festival-climb/","summary":"\u003cp\u003e中秋第一天，娃约了同学在公园玩，骑车、滑轮滑，晚上娃带我去了她说非常好吃的一家店吃饭。\u003c/p\u003e\n\u003cp\u003e晚上回来，想着第二天在家呆一天也是看电视，打算带她爬长城，查了一下，往返的票早已售罄，只好放弃这个方案。\u003c/p\u003e","content_html":"\u003cp\u003e中秋第一天，娃约了同学在公园玩，骑车、滑轮滑，晚上娃带我去了她说非常好吃的一家店吃饭。\u003c/p\u003e\n\u003cp\u003e晚上回来，想着第二天在家呆一天也是看电视，打算带她爬长城，查了一下，往返的票早已售罄，只好放弃这个方案。\u003c/p\u003e\n\u003cp\u003e园博园开了灯会，微博上看说是人巨多，还是放弃吧。\u003c/p\u003e\n\u003cp\u003e跟娃商量了一下，最后我们决定还是爬山，再刷一次百望山。\u003c/p\u003e\n\u003cp\u003e第二天一早睡到9点，起床洗漱，吃早饭，收拾东西，出门的时候都已经10点半了。\u003c/p\u003e\n\u003cp\u003e还好不远，山也不高，我们也不着急，就当遛弯。\u003c/p\u003e\n\u003cp\u003e来了好几次了，进园就直奔主题：爬。\u003c/p\u003e\n\u003cp\u003e这次我俩先走了一段山路，虽然是台阶，但是确实快。\u003c/p\u003e\n\u003cp\u003e昨天玩的太累，我们商量着还是继续走坡道吧。\u003c/p\u003e\n\u003cp\u003e花了40分钟左右登顶，最快的一次记录了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG19.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG19.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG19.jpg\" width=\"1080\" height=\"1440\" alt=\"登顶\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e爬到山顶，找了个阴凉，补充能量，娃请我吃雪糕。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG20.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG20.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG20.jpg\" width=\"1080\" height=\"810\" alt=\"小憩\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e今天天气一般，能见度不高，远处都是灰蒙蒙的。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG21.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG21.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG21.jpg\" width=\"1080\" height=\"1440\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e歇到1点多，我俩开始下山。\u003c/p\u003e\n\u003cp\u003e之前在微博看到陈晓卿分享的一家新疆馆子\u003ca href=\"https://weibo.com/1647375747/OshW9uUIS\"\u003e白钻美食\u003c/a\u003e，决定晚上带娃去尝尝。\u003c/p\u003e\n\u003cp\u003e坐了1个半小时的地铁，到了吕营大街。\u003c/p\u003e\n\u003cp\u003e高德导航说是十里河K2出口出站，这个口确实离的近，但是出站需要爬超级长的楼梯。\u003c/p\u003e\n\u003cp\u003e我俩傻乎乎的爬楼上来，累个够呛。\u003c/p\u003e\n\u003cp\u003e建议选择K1出站口，电梯出站，上来跟K2出口挨着，没有多远。\u003c/p\u003e\n\u003cp\u003e4点多到店，一开始还担心不到饭点有没有饭，进门一看已经有几桌在吃饭的了。\u003c/p\u003e\n\u003cp\u003e馆子里吃饭的维族人不少，看来确实是本地特色，吃完饭娃还问我是不是外国人。😂\u003c/p\u003e\n\u003cp\u003e不知道份量，先点了羊腿抓饭和羊肉串，娃说好吃，推荐的烤包子已经没有了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG22.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG22.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG22.jpg\" width=\"1080\" height=\"809\" alt=\"羊腿抓饭\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG23.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG23.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG23.jpg\" width=\"1080\" height=\"1440\" alt=\"羊肉串\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e然后又点了一份过油拌面，面条非常劲道，味道非常棒。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG24.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG24.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG24.jpg\" width=\"1080\" height=\"1440\" alt=\"过油拌面\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e喝了据说是本地的茶，查了一下，说是叫“砖茶”，免费的。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG25.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG25.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG25.jpg\" width=\"1080\" height=\"810\" alt=\"砖茶\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e店不大，但是味道挺好，推荐去试试，就是有点远。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG26.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG26.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG26.jpg\" width=\"1080\" height=\"1440\" alt=\"白钻美食\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e吃完地铁回家，等公交的时候错过了一趟车，还多等了半个小时。\u003c/p\u003e\n\u003cp\u003e今天是暴走的一天。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG27.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/mid-autumn-festival-climb/WechatIMG27.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG27.jpg\" width=\"1080\" height=\"2341\" alt=\"健身记录\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2024-09-16T23:56:16+08:00","tags":["爬山","遛娃"]},{"title":"Google Adsense的审核之旅","id":"https://liudon.com/posts/my-google-adsense-approval-journey/","url":"https://liudon.com/posts/my-google-adsense-approval-journey/","summary":"\u003cp\u003e中午的时候，突然收到一条消息，打开一看，提示我的\u003ccode\u003eGoogle Adsense\u003c/code\u003e审核通过了。\u003c/p\u003e\n\u003cp\u003e偶然发现\u003ccode\u003eGoogle Adsense\u003c/code\u003e里居然有40美金，想起来是之前\u003ca href=\"https://liudon.org\"\u003e老博客\u003c/a\u003e加的广告。\u003c/p\u003e","content_html":"\u003cp\u003e中午的时候，突然收到一条消息，打开一看，提示我的\u003ccode\u003eGoogle Adsense\u003c/code\u003e审核通过了。\u003c/p\u003e\n\u003cp\u003e偶然发现\u003ccode\u003eGoogle Adsense\u003c/code\u003e里居然有40美金，想起来是之前\u003ca href=\"https://liudon.org\"\u003e老博客\u003c/a\u003e加的广告。\u003c/p\u003e\n\u003cp\u003e看着\u003ca href=\"https://liudon.com\"\u003e新博客\u003c/a\u003e每天也有了一些访问，打算申请\u003ccode\u003eGoogle Adsense\u003c/code\u003e，补充些维护成本。\u003c/p\u003e\n\u003cp\u003e按之前的流程搞了一遍，提交了申请。\u003c/p\u003e\n\u003cp\u003e结果过了1周多，收到审核不通过邮件，说是不符合规范：低质内容，质量不高。\u003c/p\u003e\n\u003cp\u003e搜了一下，说是现在新网站审核门槛高了。\u003c/p\u003e\n\u003cp\u003e不放弃，继续申请呗。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/my-google-adsense-approval-journey/20240916-233753.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/my-google-adsense-approval-journey/20240916-233753.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240916-233753.png\" width=\"1080\" height=\"348\" alt=\"approval google adsense\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e从3月份开始，申请了7次，全部被拒。\u003c/p\u003e\n\u003cp\u003e尤其是8月25日被拒后，提示我审核次数过多，必须得等到8月31日以后才能再次申请。\u003c/p\u003e\n\u003cp\u003e上社区发了\u003ca href=\"https://support.google.com/adsense/thread/292831058/%E7%BD%91%E7%AB%99%E5%AE%A1%E6%A0%B8%E4%B8%8D%E9%80%9A%E8%BF%87%EF%BC%8C%E5%B8%AE%E7%9C%8B%E4%B8%8B%E5%8E%9F%E5%9B%A0?hl=zh-Hans\u0026amp;sjid=5393313994536777596-AP\"\u003e帖子\u003c/a\u003e，咨询到底是什么原因，结果也没收到答复。\u003c/p\u003e\n\u003cp\u003e这个时候，就已经有点心灰意冷，想要放弃了。\u003c/p\u003e\n\u003cp\u003e9月5日的时候，想着再最后申请一把试试看，再不通过就算了。\u003c/p\u003e\n\u003cp\u003e等了1周多，感觉这次估计又悬了，已经放弃了，结果今天竟然审核通过了。\u003c/p\u003e\n\u003cp\u003e历经了8次申请，耗时半年，终于申请下来了，算是这段时间难得的一件好事。\u003c/p\u003e\n","date_published":"2024-09-16T23:18:50+08:00","tags":["google adsense"]},{"title":"让你的IPFS站点持久在线：接入Filebase的Names(IPNS)服务","id":"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/","url":"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/","summary":"\u003cp\u003e本文会介绍如何接入\u003ccode\u003efilebase\u003c/code\u003e的Names(IPNS)服务，使你的\u003ccode\u003eIPFS\u003c/code\u003e站点持久在线。\u003c/p\u003e\n\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e周末更新博客时，发现workflow的上传IPFS任务执行失败了。\u003c/p\u003e","content_html":"\u003cp\u003e本文会介绍如何接入\u003ccode\u003efilebase\u003c/code\u003e的Names(IPNS)服务，使你的\u003ccode\u003eIPFS\u003c/code\u003e站点持久在线。\u003c/p\u003e\n\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e周末更新博客时，发现workflow的上传IPFS任务执行失败了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRun aquiladev/ipfs-action@master\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eError: RequestInit: duplex option is required when sending a body.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enode:internal/deps/undici/undici:12502\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Error.captureStackTrace(err, this);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ^\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTypeError: RequestInit: duplex option is required when sending a body.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    at node:internal/deps/undici/undici:12502:13\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNode.js v20.13.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查了一下，应该是\u003ccode\u003eGithub\u003c/code\u003e更新了NodeJS版本导致的。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThe following actions use a deprecated Node.js version and will be forced to run on node20: actions/checkout@v2, peaceiris/actions-hugo@v2, peaceiris/actions-gh-pages@v3, aquiladev/ipfs-action@master. For more info: https://github.blog/changelog/2024-03-07-github-actions-all-actions-will-run-on-node20-instead-of-node16-by-default/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e研究了一下，问题在于\u003ca href=\"https://github.com/ipfs/js-ipfs\"\u003ejs-ipfs\u003c/a\u003e包的\u003ccode\u003efetch\u003c/code\u003e方法没有传\u003ccode\u003eduplex\u003c/code\u003e参数导致。\u003c/p\u003e\n\u003cp\u003e看\u003ccode\u003eGithub\u003c/code\u003e文档，官方已经不再更新了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDEPRECATED: js-IPFS has been superseded by Helia\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e搜索一番，发现了两个包\u003ca href=\"https://github.com/ipfs/helia\"\u003ehelia\u003c/a\u003e和\u003ca href=\"https://github.com/ipfs/js-kubo-rpc-client\"\u003ejs-kubo-rpc-client\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehelia\u003c/code\u003e调用方法有\u003ca href=\"https://github.com/ipfs/helia/wiki/Migrating-from-js-IPFS\"\u003e变化\u003c/a\u003e，\u003ccode\u003ejs-kubo-rpc-client\u003c/code\u003e和原来的\u003ccode\u003ejs-ipfs\u003c/code\u003e使用一致。\u003c/p\u003e\n\u003cp\u003e捣鼓了一番，没调通，不懂前端的锅，只能放弃，顺便给作者提了个\u003ca href=\"https://github.com/aquiladev/ipfs-action/issues/78\"\u003eissue\u003c/a\u003e，还是作者来适配吧。\u003c/p\u003e\n\u003cp\u003e隔天看的时候，在\u003ca href=\"https://github.com/aquiladev/ipfs-action/pulls\"\u003ePull requests\u003c/a\u003e里发现已经有升级后的提交了。\u003c/p\u003e\n\u003cp\u003e哈哈，原来\u003ccode\u003efilebase\u003c/code\u003e官方早就升级适配了，\u003ca href=\"https://github.com/filebase/ipfs-action/tree/master\"\u003efilebase/ipfs-action\u003c/a\u003e，顺带发现居然还支持了\u003ccode\u003eIPNS\u003c/code\u003e更新，太完美了！！！\u003c/p\u003e\n\u003ch4 id=\"折腾记录\"\u003e折腾记录\u003c/h4\u003e\n\u003cp\u003e关于\u003ccode\u003eIPNS\u003c/code\u003e的作用，可以参考zu1k大佬的\u003ca href=\"https://zu1k.com/posts/tutorials/p2p/ipfs/\"\u003eIPFS 新手指北\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e关于\u003ccode\u003eIPFS\u003c/code\u003e的部署，可以参考我的\u003ca href=\"https://liudon.com/posts/deploy-blog-to-ipfs/\"\u003e将博客部署到星际文件系统(IPFS)\u003c/a\u003e。\u003c/p\u003e\n\u003ch5 id=\"生成密钥\"\u003e生成密钥\u003c/h5\u003e\n\u003cp\u003e因为我在云主机上部署了\u003ccode\u003eipfs\u003c/code\u003e服务，已经有在更新\u003ccode\u003eIPNS\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e这里引入\u003ccode\u003efilebase\u003c/code\u003e后，相当于多个节点来更新，需要保证\u003ccode\u003eIPNS\u003c/code\u003e地址上一致的。\u003c/p\u003e\n\u003cp\u003e所以需要将云主机的密钥导出后，导入到\u003ccode\u003efilebase\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e之前使用的是\u003ccode\u003eipfs\u003c/code\u003e默认密钥，这个是无法导出的，所以只能重新生成一个密钥,\n\u003ccode\u003eipfs-action\u003c/code\u003e为密钥名字，改成你自己的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eipfs key gen ipfs-action\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; k51qzi5uqu5dh5kbbff1ucw3ksphpy3vxx4en4dbtfh90pvw4mzd8nfm5r5fnl\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e注意：\u003c/strong\u003e\u003ccode\u003efilebase\u003c/code\u003e还不支持\u003ccode\u003etype/size\u003c/code\u003e参数，这里必须使用默认方式创建，否则在\u003ccode\u003efilebase\u003c/code\u003e导入已有密钥会报错。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/20240904-214210.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/20240904-214210.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240904-214210.png\" width=\"800\" height=\"990\" alt=\"chat\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e查看已有密钥：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eipfs key list -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; k51qzi5uqu5djx9olgjcibdiurrr09w75v6rdfx0cvwye295k787sssssf0d9d self        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; k51qzi5uqu5dktnw0vc8j9ci42e8gk741ici7ofpv40mo4f6e1ossssnc7uwg ipfs-action\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e导出密钥：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eipfs key \u003cspan style=\"color:#66d9ef\"\u003eexport\u003c/span\u003e ipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eaction\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行后，当前目录下会生成一个\u003ccode\u003eipfs-action.key\u003c/code\u003e文件，内容为二进制。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003efilebase\u003c/code\u003e导入key要求为base64编码，将其转为base64编码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecat ipfs-action.key | base64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; 5oiR5piv5rWL6K+V\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e记住这里的base64内容，下面会用到。\u003c/p\u003e\n\u003ch5 id=\"创建name\"\u003e创建NAME\u003c/h5\u003e\n\u003cp\u003e进入\u003ca href=\"https://console.filebase.com/names\"\u003efilebase控制台\u003c/a\u003e，点击\u003ccode\u003eCreate Name\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/20240904-214908.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/20240904-214908.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240904-214908.png\" width=\"940\" height=\"1348\" alt=\"input\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLabel: 备注，可以随便填\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCID: 填入IPFS的cid地址\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eName Network: 固定选IPNS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEnabled：固定选Yes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImport Existing Private Key (Optional)：填入第一步的base64内容\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e确定提交。\u003c/p\u003e\n\u003ch5 id=\"修改workflow\"\u003e修改workflow\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: IPFS upload to filebase\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euses: filebase\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eaction\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003emaster\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewith:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    path: \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003epublic\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    service: filebase\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    pinName: ipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eaction\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    filebaseBucket: \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{{ secrets\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFILEBASE_BUCKET }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    filebaseKey: \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{{ secrets\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFILEBASE_KEY }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    filebaseSecret: \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{{ secrets\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFILEBASE_SECRET }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    key: ipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eaction\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e新增\u003ccode\u003ekey\u003c/code\u003e参数，值为第二步\u003ccode\u003eLabel\u003c/code\u003e填入的内容。\u003c/p\u003e\n\u003cp\u003e提交后，执行workflow，在执行结果里找到\u003ccode\u003eIPNS\u003c/code\u003e地址。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRun filebase\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eaction\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003emaster\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParsing options\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eParsed Options: {\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;path\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/home/runner/work/***.github.io/***.github.io/public\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;service\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;filebase\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;host\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ipfs.io\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;port\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;5001\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;protocol\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;headers\u0026#34;\u003c/span\u003e:{},\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;key\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ipfs-action\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pinName\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ipfs-action\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pinataKey\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pinataSecret\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pinataPinName\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;filebaseBucket\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;***\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;filebaseKey\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;***\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;filebaseSecret\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;***\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;infuraProjectId\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;infuraProjectSecret\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;timeout\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;60000\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;verbose\u0026#34;\u003c/span\u003e:false,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pattern\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;public/**/*\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAdding files\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStarting filebase client\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStarted filebase client\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStoring files\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStored files\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCID: bafybeihagzsdupyrecky7bnstzckgf5flxbrdz542jmfaep4xtbj6aa2ea\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUpdating name\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUpdated name\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDone\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUpload to IPFS finished successfully {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  cid: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;bafybeihagzsdupyrecky7bnstzckgf5flxbrdz542jmfaep4xtbj6aa2ea\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ipfs: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;bafybeihagzsdupyrecky7bnstzckgf5flxbrdz542jmfaep4xtbj6aa2ea\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ipns: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;k51qzi5uqu5dktnw0vc8j9ci42e8gk741ici7ofpv40mo4f6e1ovj1isnc7uwg\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"更新dnslink\"\u003e更新DNSlink\u003c/h5\u003e\n\u003cp\u003e更新域名的dnslink值：\u003c/p\u003e\n\u003cp\u003e普通域名\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/20240904-215553.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/20240904-215553.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240904-215553.png\" width=\"1080\" height=\"246\" alt=\"dns\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003eeth域名\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/WechatIMG16.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/keep-your-ipfs-site-online-with-filebase-ipns/WechatIMG16.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG16.jpg\" width=\"1080\" height=\"2341\" alt=\"eth\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e第一次和外国人在线沟通，时差原因搞了两天才把\u003ccode\u003efilebase\u003c/code\u003e导入报错的问题解决。 😂😂😂\u003c/p\u003e\n\u003cp\u003e另外吐槽一下\u003ccode\u003efilebase\u003c/code\u003e服务，sdk已经有相关实现了，文档都还没更新。\u003c/p\u003e\n","date_published":"2024-09-04T22:39:37+08:00","tags":["ipfs","filebase","github"]},{"title":"一次简短的青岛之行","id":"https://liudon.com/posts/the-trip-of-qingdao/","url":"https://liudon.com/posts/the-trip-of-qingdao/","summary":"\u003cp\u003e刚放暑假的时候，就答应了娃带她去一趟青岛。\u003c/p\u003e\n\u003cp\u003e8月份要回老家，所以定在了7月中下旬出发。\u003c/p\u003e\n\u003cp\u003e车票/酒店都订好了，结果来了个台风格美。\u003c/p\u003e\n\u003cp\u003e出发前一周一直在查天气，就怕去了一直下雨。\u003c/p\u003e","content_html":"\u003cp\u003e刚放暑假的时候，就答应了娃带她去一趟青岛。\u003c/p\u003e\n\u003cp\u003e8月份要回老家，所以定在了7月中下旬出发。\u003c/p\u003e\n\u003cp\u003e车票/酒店都订好了，结果来了个台风格美。\u003c/p\u003e\n\u003cp\u003e出发前一周一直在查天气，就怕去了一直下雨。\u003c/p\u003e\n\u003cp\u003e看了台风的预测路径，感觉可能能赶在台风来之前的空档，硬着头皮出发吧。\u003c/p\u003e\n\u003cp\u003e7月26日乘坐高铁G203，中午12点左右到达青岛。\u003c/p\u003e\n\u003cp\u003e老天很给面子，是个晴天，还有点晒。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/route.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/route.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"route.png\" width=\"1080\" height=\"543\" alt=\"出行计划\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e本来的计划路线：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e第一天：\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e中午到达青岛 -\u0026gt; 天主教堂 -\u0026gt; 栈桥 -\u0026gt; 八大关 -\u0026gt; 第二海水浴场\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e第二天：\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e海底世界/极地海洋馆 -\u0026gt; 石老人海水浴场 -\u0026gt; 五四广场/奥帆中心夜景\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e第三天：\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e酒店休息返京\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e按这个路线，定了两个酒店，一个在栈桥附近，一个在海洋馆附近。\u003c/p\u003e\n\u003cp\u003e到了青岛后，先去酒店放行李，然后打车去吃饭。\u003c/p\u003e\n\u003cp\u003e青岛的第一顿饭，我们选了吃海鲜，事前查了些攻略，选择了栈桥附近的燕欣饭馆。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/yanxin.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/yanxin.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"yanxin.png\" width=\"1080\" height=\"1441\" alt=\"燕欣饭馆\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e中午很饿，上来就吃，忘记拍照了，只有吃完后的照片了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/chiwan.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/chiwan.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"chiwan.png\" width=\"960\" height=\"720\" alt=\"一扫而光\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e油焖大虾相当不错，海肠捞饭非常好吃，韭菜很鲜。\u003c/p\u003e\n\u003cp\u003e3个人，一共花了240元，非常推荐的一家店。\u003c/p\u003e\n\u003cp\u003e吃完饭，溜达到天主教堂打卡。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/jiaotang.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/jiaotang.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"jiaotang.png\" width=\"1080\" height=\"1441\" alt=\"天主教堂\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e然后是栈桥，人非常多，中午非常晒。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/zhanqiao.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/zhanqiao.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"zhanqiao.png\" width=\"1080\" height=\"1441\" alt=\"栈桥\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e于是回酒店稍作休息，决定打车直奔第二海水浴场玩水。\u003c/p\u003e\n\u003cp\u003e踩水的感觉太好玩了，娃从一开始的有点害怕，到后面追着水玩。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/caishui.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/caishui.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"caishui.png\" width=\"1080\" height=\"1441\" alt=\"踩水\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e玩完打车去的美团推荐的双合园，地方很小，需要等位。\u003c/p\u003e\n\u003cp\u003e吃下来，感觉不如第一顿好吃，菜品一般，不太推荐。\u003c/p\u003e\n\u003cp\u003e吃完已经9点了，错过了夜景时间，直接回酒店休息了。\u003c/p\u003e\n\u003cp\u003e第二天起床，发现外面下雨了，风很大，最终没逃过台风的影响。\u003c/p\u003e\n\u003cp\u003e昨天路过海洋馆，看了外面排队的人巨多，决定不去室内这种海洋馆了。\u003c/p\u003e\n\u003cp\u003e先去了银鱼巷溜达一圈，没啥看的，中午在1907青岛老味道吃的午饭，非常不推荐的一家店。\u003c/p\u003e\n\u003cp\u003e吃完饭打车到奥帆中心，想着坐船玩一圈，到了发现因为风大停运了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/wusiguangchang.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/wusiguangchang.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"wusiguangchang.png\" width=\"1080\" height=\"810\" alt=\"五四广场打卡\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e打卡完，直奔第三海水浴场玩水。\u003c/p\u003e\n\u003cp\u003e到了发现因为风大不让下水了，只能在沙滩上玩沙子了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/disanhaishuiyuchang.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/disanhaishuiyuchang.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"disanhaishuiyuchang.png\" width=\"1080\" height=\"1441\" alt=\"第三海水浴场\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e和娃一起抓了几只小螃蟹，虽然天气不好，娃玩的还是很开心。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/pangxie.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-trip-of-qingdao/pangxie.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"pangxie.png\" width=\"1080\" height=\"810\" alt=\"赶海\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e实在不想吃海鲜了，晚饭在酒店附近吃了个米村拌饭，发现旁边有家类似北京的老年厨房，非常便宜，菜品也不错，第二天早晨在这里解决了。\u003c/p\u003e\n\u003cp\u003e天气不好，晚上在酒店看电视了，点了个麦当劳夜宵，结果娃没吃多少，全我吃了，给我撑的。\u003c/p\u003e\n\u003cp\u003e第三天天晴了，但是风还是大。\u003c/p\u003e\n\u003cp\u003e决定到第二海水浴场看看运气，到了之后还是不让下水，在沙滩上玩了会沙子。\u003c/p\u003e\n\u003cp\u003e时间差不多，回酒店办退房。\u003c/p\u003e\n\u003cp\u003e然后步行到火车站，上车回京。\u003c/p\u003e\n\u003cp\u003e青岛之行就此结束了，尽管行程很短，天气不太好，但一家人在一起就很开心，唯一的教训就是晚上夜宵不要吃的太多。 😂\u003c/p\u003e\n","date_published":"2024-08-31T21:24:53+08:00","tags":["旅行"]},{"title":"解决 \"undeclared name: any (requires version go1.18 or later)\" 编译错误","id":"https://liudon.com/posts/solving-undeclared-name-any-requires-version-go1.18-or-later-compilation-error/","url":"https://liudon.com/posts/solving-undeclared-name-any-requires-version-go1.18-or-later-compilation-error/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go install google.golang.org/protobuf/cmd/protoc-gen-go@latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ protoc-gen-go --version\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc-gen-go v1.34.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sh make.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euser.pb.go:123:45: undeclared name: any (requires version go1.18 or later)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e流水线编译报错，其中\u003ccode\u003emake.sh\u003c/code\u003e文件代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc -I=./ --proto_path=./ --go_out=./ --go_opt=paths=source_relative user.proto \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego build\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e同样的代码在本机编译就没问题，但是放到流水线里编译就报上面的错误。\u003c/p\u003e","content_html":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go install google.golang.org/protobuf/cmd/protoc-gen-go@latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ protoc-gen-go --version\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc-gen-go v1.34.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sh make.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euser.pb.go:123:45: undeclared name: any (requires version go1.18 or later)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e流水线编译报错，其中\u003ccode\u003emake.sh\u003c/code\u003e文件代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc -I=./ --proto_path=./ --go_out=./ --go_opt=paths=source_relative user.proto \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego build\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e同样的代码在本机编译就没问题，但是放到流水线里编译就报上面的错误。\u003c/p\u003e\n\u003cp\u003e登到流水线编译机器上，看了下\u003ccode\u003ego\u003c/code\u003e的版本已经是\u003ccode\u003e1.18.1\u003c/code\u003e了，按理不应该报这个错误的。\u003c/p\u003e\n\u003cp\u003e关键之前流水线编译是没问题的，怀疑是开发分支代码的问题，用\u003ccode\u003emaster\u003c/code\u003e分支编译了一下，也还是报这个错误。\u003c/p\u003e\n\u003cp\u003e手动执行\u003ccode\u003emake.sh\u003c/code\u003e里的每条命令，发现是\u003ccode\u003eprotoc\u003c/code\u003e编译pb文件时报的这个错误。\u003c/p\u003e\n\u003cp\u003e经过一番查找后，发现是\u003ccode\u003eprotoc-gen-go\u003c/code\u003e在4月份更新了版本，引入了新特性。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://pkg.go.dev/google.golang.org/protobuf@v1.34.2/cmd/protoc-gen-go?tab=versions\"\u003eprotoc-gen-go\u0026rsquo;s versions\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVersions in this module\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ev1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    v1.34.2 Jun 11, 2024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    v1.34.1 May 6, 2024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    v1.34.0 Apr 30, 2024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    v1.33.0 Mar 5, 2024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    v1.32.0 Dec 22, 2023\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://protobuf.dev/editions/overview/\"\u003eProtobuf Editions Overview\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eProtobuf Editions replace the proto2 and proto3 designations that we have used for Protocol Buffers. Instead of adding syntax = \u0026ldquo;proto2\u0026rdquo; or syntax = \u0026ldquo;proto3\u0026rdquo; at the top of proto definition files, you use an edition number, such as edition = \u0026ldquo;2024\u0026rdquo;, to specify the default behaviors your file will have. Editions enable the language to evolve incrementally over time.\u003c/p\u003e\n\u003cp\u003eInstead of the hardcoded behaviors that older versions have had, editions represent a collection of features with a default value (behavior) per feature. Features are options on a file, message, field, enum, and so on, that specify the behavior of protoc, the code generators, and protobuf runtimes. You can explicitly override a behavior at those different levels (file, message, field, …) when your needs don’t match the default behavior for the edition you’ve selected. You can also override your overrides. The section later in this topic on lexical scoping goes into more detail on that.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e改用历史版本后解决。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install google.golang.org/protobuf/cmd/protoc-gen-go@v1.33.0\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date_published":"2024-06-14T20:41:20+08:00","tags":["go","protoc"]},{"title":"搭建自托管IPFS Gateway服务，替代Cloudflare的IPFS Gateway","id":"https://liudon.com/posts/replacing-cloudflare-ipfs-gateway-with-self-hosted-gateway/","url":"https://liudon.com/posts/replacing-cloudflare-ipfs-gateway-with-self-hosted-gateway/","summary":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e4月底的时候，Livid大佬提醒，\u003ccode\u003eCloudflare\u003c/code\u003e应该是调整了\u003ccode\u003eIPFS Gateway\u003c/code\u003e网关策略，我的\u003ca href=\"https://liudon.xyz\"\u003eIPFS镜像博客\u003c/a\u003e无法访问了。\u003c/p\u003e\n\u003cp\u003e没查到\u003ccode\u003eCloudflare\u003c/code\u003e的调整说明，不过还好\u003ccode\u003eIPFS\u003c/code\u003e官方也提供了公共网关\u003ccode\u003egateway.ipfs.io\u003c/code\u003e，将域名解析改到官网网关。\u003c/p\u003e","content_html":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e4月底的时候，Livid大佬提醒，\u003ccode\u003eCloudflare\u003c/code\u003e应该是调整了\u003ccode\u003eIPFS Gateway\u003c/code\u003e网关策略，我的\u003ca href=\"https://liudon.xyz\"\u003eIPFS镜像博客\u003c/a\u003e无法访问了。\u003c/p\u003e\n\u003cp\u003e没查到\u003ccode\u003eCloudflare\u003c/code\u003e的调整说明，不过还好\u003ccode\u003eIPFS\u003c/code\u003e官方也提供了公共网关\u003ccode\u003egateway.ipfs.io\u003c/code\u003e，将域名解析改到官网网关。\u003c/p\u003e\n\u003cp\u003e但还是无法访问，被\u003ccode\u003eCloudflare\u003c/code\u003e拦截了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eError 1014 Ray ID: 887cc7fcfa2804bb • 2024-05-22 12:24:05 UTC\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCNAME Cross-User Banned\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWhat happened?\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eYou\u0026#39;ve requested a page on a website that is part of the Cloudflare network. The host is configured as a CNAME across accounts on Cloudflare, which is not allowed by Cloudflare\u0026#39;s security policy.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWhat can I do?\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eIf this is an R2 custom domain, it may still be initializing. If you have attempted to manually point a CNAME DNS record to your R2 bucket, you must do it using a custom domain. Refer to R2\u0026#39;s documentation for details.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVisit our website to learn more about Cloudflare.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这周在Discord群里，看到有人发消息，说是\u003ccode\u003eCloudflare\u003c/code\u003e将下线\u003ccode\u003eIPFS Gateway\u003c/code\u003e网关服务。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.cloudflare.com/cloudflares-public-ipfs-gateways-and-supporting-interplanetary-shipyard\"\u003ehttps://blog.cloudflare.com/cloudflares-public-ipfs-gateways-and-supporting-interplanetary-shipyard\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAll traffic using the cloudflare-ipfs.com or cf-ipfs.com hostname(s) will continue to work without interruption and be redirected to ipfs.io or dweb.link until August 14th, 2024, at which time the Cloudflare hostnames will no longer connect to IPFS and all users must switch the hostname they use to ipfs.io or dweb.link to ensure no service interruption takes place. If you are using either of the Cloudflare hostnames, please be sure to switch to one of the new ones as soon as possible ahead of the transition date to avoid any service interruptions!\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"方案调研\"\u003e方案调研\u003c/h4\u003e\n\u003cp\u003e经过一番搜索，找到了一篇\u003ca href=\"https://railway.app/template/PhPjgz\"\u003e自建IPFS Gateway网关的资料\u003c/a\u003e，里面用到了\u003ca href=\"https://github.com/ipfs/bifrost-gateway\"\u003ebifrost-gateway\u003c/a\u003e组件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTo run against a compatible, local trustless gateway provided by Kubo or IPFS Desktop:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ PROXY_GATEWAY_URL=\u0026#34;http://127.0.0.1:8080\u0026#34; ./bifrost-gateway\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e看文档，可以通过这个命令搭建一个自己的网关服务，同时支持\u003ccode\u003eDNSLink\u003c/code\u003e方式访问。\u003c/p\u003e\n\u003cp\u003e太棒了，感觉可以自己搭一套网关，然后用\u003ccode\u003eNginx\u003c/code\u003e反代对外提供服务。\u003c/p\u003e\n\u003cp\u003e在之前\u003ca href=\"https://liudon.com/posts/deploy-blog-to-ipfs/\"\u003e将博客部署到星际文件系统(IPFS)\u003c/a\u003e文章中，已经通过\u003ccode\u003eKubo\u003c/code\u003e搭建了一套本地\u003ccode\u003eIPFS\u003c/code\u003e服务。\u003c/p\u003e\n\u003cp\u003e上机器验证一下可行性：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e启动Bifrost Gateway，网关默认地址为\u003ccode\u003ehttps://127.0.0.1:8081\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ PROXY_GATEWAY_URL=\u0026#34;http://127.0.0.1:8080\u0026#34; ./bifrost-gateway\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00 Starting bifrost-gateway dev-build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00 Proxy backend (PROXY_GATEWAY_URL) at http://127.0.0.1:8080\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00 BLOCK_CACHE_SIZE: 1024\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00 GRAPH_BACKEND: false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00 Legacy RPC at /api/v0 (KUBO_RPC_URL) provided by http://127.0.0.1:5001\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00 Path gateway listening on http://127.0.0.1:8081\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00   Smoke test (JPG): http://127.0.0.1:8081/ipfs/bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00 Subdomain gateway configured on dweb.link and http://localhost:8081\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00   Smoke test (Subdomain+DNSLink+UnixFS+HAMT): http://localhost:8081/ipns/en.wikipedia-on-ipfs.org/wiki/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/05/22 20:54:00 Metrics exposed at http://127.0.0.1:8041/debug/metrics/prometheus\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在另外一个终端下，执行命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ curl \u0026#39;http://127.0.0.1:8081/\u0026#39; -H\u0026#34;Host:liudon.xyz\u0026#34; -I\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHTTP/1.1 200 OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccept-Ranges: bytes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Headers: Content-Type\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Headers: Range\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Headers: User-Agent\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Headers: X-Requested-With\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Methods: GET\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Methods: HEAD\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Methods: OPTIONS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Origin: *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: Content-Length\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: Content-Range\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: X-Chunked-Output\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: X-Ipfs-Path\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: X-Ipfs-Roots\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: X-Stream-Output\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Length: 26283\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Type: text/html\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEtag: \u0026#34;QmebCXeD6XDB9xsVvX5Te91EeF5t7sk65A3adsLQ9bostj\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLast-Modified: Wed, 22 May 2024 12:57:29 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eX-Ipfs-Path: /ipns/liudon.xyz/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eX-Ipfs-Roots: QmebCXeD6XDB9xsVvX5Te91EeF5t7sk65A3adsLQ9bostj\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDate: Wed, 22 May 2024 12:57:29 GMT\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e验证可行，不过我记得\u003ccode\u003eKubo\u003c/code\u003e默认就有网关服务的，试一下直接通过\u003ccode\u003eKubo\u003c/code\u003e默认网关的情况。\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eKubo默认网关地址为http://127.0.0.1:8080，注意不要对外网提供8080端口访问，否则会被别人当成公共网关使用\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ curl \u0026#39;http://127.0.0.1:8080/\u0026#39; -H\u0026#34;Host:liudon.xyz\u0026#34; -I\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHTTP/1.1 200 OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccept-Ranges: bytes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Headers: Content-Type\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Headers: Range\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Headers: User-Agent\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Headers: X-Requested-With\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Methods: GET\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Origin: *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: Content-Length\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: Content-Range\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: X-Chunked-Output\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: X-Ipfs-Path\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: X-Ipfs-Roots\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Expose-Headers: X-Stream-Output\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Length: 26283\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Type: text/html\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEtag: \u0026#34;QmebCXeD6XDB9xsVvX5Te91EeF5t7sk65A3adsLQ9bostj\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLast-Modified: Wed, 22 May 2024 12:59:25 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eX-Ipfs-Path: /ipns/liudon.xyz/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eX-Ipfs-Roots: QmebCXeD6XDB9xsVvX5Te91EeF5t7sk65A3adsLQ9bostj\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDate: Wed, 22 May 2024 12:59:25 GMT\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e也是可以的，那就没必要多搞一套bifrost网关了。\u003c/p\u003e\n\u003ch4 id=\"具体实现\"\u003e具体实现\u003c/h4\u003e\n\u003cp\u003e通过\u003ccode\u003eNginx\u003c/code\u003e反向代理转发到本地\u003ccode\u003eIPFS\u003c/code\u003e网关，只需要改一下解析就可以继续使用\u003ccode\u003eIPFS\u003c/code\u003e服务了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/replacing-cloudflare-ipfs-gateway-with-self-hosted-gateway/20240522210154.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/replacing-cloudflare-ipfs-gateway-with-self-hosted-gateway/20240522210154.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240522210154.png\" width=\"904\" height=\"1040\" alt=\"方案\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003eNginx\u003c/code\u003e反向代理\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eserver {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    listen \u003cspan style=\"color:#ae81ff\"\u003e443\u003c/span\u003e ssl http2;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    server_name liudon\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003exyz;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ssl_certificate \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eetc\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003enginx\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003essl\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eliudon\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003exyz\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003efullchain\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecer;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ssl_certificate_key \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eetc\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003enginx\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003essl\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eliudon\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003exyz\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eliudon\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003exyz\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ekey;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ssl_protocols TLSv1\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e TLSv1\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ssl_ciphers \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ssl_prefer_server_ciphers on;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ssl_session_cache shared:SSL:\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003em;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ssl_session_timeout \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003em;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    location \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            proxy_pass http:\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e127.0\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e8080\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            proxy_set_header Host \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehost; \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e注意这里要传递反代的域名信息，限制只能访问我们自己\u003c/span\u003ednslink对应的资源\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    access_log \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003elog\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003enginx\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eliudon\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003exyz\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eaccess\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elog;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    error_log \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003elog\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003enginx\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eliudon\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003exyz\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eerror\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elog;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e申请\u003ccode\u003eLet's Encrypt\u003c/code\u003e证书，证书相关的就不多做介绍了，网上资料很多。\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e更改DNS解析\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e原有的解析\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e类型：CNAME\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e名称：liudon.xyz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e内容：cloudflare-ipfs.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e新的解析\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e类型：A\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e名称：liudon.xyz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e内容：你的服务器公网IP\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e搞定，又可以继续白嫖\u003ccode\u003eIPFS\u003c/code\u003e服务了。\u003c/p\u003e\n","date_published":"2024-05-22T21:20:20+08:00","tags":["cloudflare","ipfs"]},{"title":"302跳转的跨域问题(CORS)","id":"https://liudon.com/posts/the-cors-issue-with-302-redirect/","url":"https://liudon.com/posts/the-cors-issue-with-302-redirect/","summary":"\u003cp\u003e302跳转的跨域问题\u003c/p\u003e\n\u003ch4 id=\"场景一302不返回跨域头\"\u003e场景一：302不返回跨域头\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e请求\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGET /302 HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHost: liudon.xyz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOrigin: https://www.baidu.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e返回\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHTTP/1.1 200 OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCache-Control: private, max-age=0, no-store, no-cache, must-revalidate, post-check=0, pre-check=0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCf-Ray: 88535773eaf5107e-HKG\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Length: 143\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Type: text/html\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDate: Fri, 17 May 2024 11:42:00 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExpires: Thu, 01 Jan 1970 00:00:01 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLocation: https://liudon.org\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eServer: cloudflare\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVary: Accept-Encoding\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e浏览器报错\u003c/strong\u003e\u003c/p\u003e","content_html":"\u003cp\u003e302跳转的跨域问题\u003c/p\u003e\n\u003ch4 id=\"场景一302不返回跨域头\"\u003e场景一：302不返回跨域头\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e请求\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGET /302 HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHost: liudon.xyz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOrigin: https://www.baidu.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e返回\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHTTP/1.1 200 OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCache-Control: private, max-age=0, no-store, no-cache, must-revalidate, post-check=0, pre-check=0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCf-Ray: 88535773eaf5107e-HKG\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Length: 143\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Type: text/html\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDate: Fri, 17 May 2024 11:42:00 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExpires: Thu, 01 Jan 1970 00:00:01 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLocation: https://liudon.org\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eServer: cloudflare\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVary: Accept-Encoding\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e浏览器报错\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess to fetch at \u0026#39;https://liudon.xyz/302\u0026#39; from origin \u0026#39;https://www.baidu.com\u0026#39; has been blocked by CORS policy: No \u0026#39;Access-Control-Allow-Origin\u0026#39; header is present on the requested resource. If an opaque response serves your needs, set the request\u0026#39;s mode to \u0026#39;no-cors\u0026#39; to fetch the resource with CORS disabled.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-cors-issue-with-302-redirect/302.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-cors-issue-with-302-redirect/302.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"302.png\" width=\"1080\" height=\"124\" alt=\"302\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch4 id=\"场景二302跳转返回跨域头\"\u003e场景二：302跳转返回跨域头\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e请求\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGET /302_return_origin_header HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHost: liudon.xyz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOrigin: https://www.baidu.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e返回\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHTTP/1.1 200 OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess-Control-Allow-Origin: https://www.baidu.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCache-Control: private, max-age=0, no-store, no-cache, must-revalidate, post-check=0, pre-check=0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCf-Ray: 88535773eaf5107e-HKG\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Length: 143\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Type: text/html\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDate: Fri, 17 May 2024 11:42:00 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExpires: Thu, 01 Jan 1970 00:00:01 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLocation: https://liudon.org\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eServer: cloudflare\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVary: Accept-Encoding\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e浏览器报错\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess to fetch at \u0026#39;https://liudon.org/\u0026#39; (redirected from \u0026#39;https://liudon.xyz/302_return_origin_header\u0026#39;) from origin \u0026#39;https://www.baidu.com\u0026#39; has been blocked by CORS policy: No \u0026#39;Access-Control-Allow-Origin\u0026#39; header is present on the requested resource. If an opaque response serves your needs, set the request\u0026#39;s mode to \u0026#39;no-cors\u0026#39; to fetch the resource with CORS disabled.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-cors-issue-with-302-redirect/302_return_origin_header.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-cors-issue-with-302-redirect/302_return_origin_header.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"302_return_origin_header.png\" width=\"1080\" height=\"70\" alt=\"302 return origin header\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e注意，这里302跳转请求没有报错，是跳转后的连接报了跨域错误。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eLocation请求\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGET / HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHost: liudon.org\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOrigin: null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eReferer: https://www.baidu.com/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-cors-issue-with-302-redirect/location.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-cors-issue-with-302-redirect/location.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"location.png\" width=\"1080\" height=\"847\" alt=\"location\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e302返回了跨域头，所以浏览器请求了Location地址。\u003c/p\u003e\n\u003cp\u003e但为什么两次请求header头里的\u003ccode\u003eOrigin\u003c/code\u003e字段值不一致呢？第二次Location请求为什么\u003ccode\u003eOrigin\u003c/code\u003e字段值是null？\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e第一次：\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOrigin: https://www.baidu.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e第二次\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOrigin: null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e经过一番搜索，终于找到了一些资料。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe Origin header value may be null in a number of cases, including (non-exhaustively):\u003c/p\u003e\n\u003cp\u003eOrigins whose scheme is not one of http, https, ftp, ws, wss, or gopher (including blob, file and data).\nCross-origin images and media data, including that in \u003c!-- raw HTML omitted --\u003e, \u003c!-- raw HTML omitted --\u003e and \u003c!-- raw HTML omitted --\u003e elements.\nDocuments created programmatically using createDocument(), generated from a data: URL, or that do not have a creator browsing context.\nRedirects across origins.\niframes with a sandbox attribute that doesn\u0026rsquo;t contain the value allow-same-origin.\nResponses that are network errors.\nReferrer-Policy set to no-referrer for non-cors request modes (e.g. simple form posts).\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e出自 \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin#description\"\u003ehttps://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin#description\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA request request has a redirect-tainted origin if these steps return true:\u003c/p\u003e\n\u003cp\u003eLet lastURL be null.\u003c/p\u003e\n\u003cp\u003eFor each url of request’s URL list:\u003c/p\u003e\n\u003cp\u003eIf lastURL is null, then set lastURL to url and continue.\u003c/p\u003e\n\u003cp\u003eIf url’s origin is not same origin with lastURL’s origin and request’s origin is not same origin with lastURL’s origin, then return true.\u003c/p\u003e\n\u003cp\u003eSet lastURL to url.\nReturn false.\nSerializing a request origin, given a request request, is to run these steps:\u003c/p\u003e\n\u003cp\u003eIf request has a redirect-tainted origin, then return \u0026ldquo;null\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eReturn request’s origin, serialized.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e出自 \u003ca href=\"https://fetch.spec.whatwg.org/#concept-request-tainted-origin\"\u003ehttps://fetch.spec.whatwg.org/#concept-request-tainted-origin\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e简单说就是如果302跳转的域与上一次请求域不同的话，就会将Origin设置为\u003ccode\u003enull\u003c/code\u003e。\u003c/p\u003e\n","date_published":"2024-05-17T20:13:57+08:00","tags":["cors"]},{"title":"GORM增加sqlcommenter特性","id":"https://liudon.com/posts/gorm-supports-sqlcommenter/","url":"https://liudon.com/posts/gorm-supports-sqlcommenter/","summary":"\u003cp\u003e什么是sqlcommenter？\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003esqlcommenter is a suite of middlewares/plugins that enable your ORMs to augment SQL statements before execution, with comments containing information about the code that caused its execution. This helps in easily correlating slow performance with source code and giving insights into backend database performance. In short it provides some observability into the state of your client-side applications and their impact on the database’s server-side.\u003c/p\u003e","content_html":"\u003cp\u003e什么是sqlcommenter？\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003esqlcommenter is a suite of middlewares/plugins that enable your ORMs to augment SQL statements before execution, with comments containing information about the code that caused its execution. This helps in easily correlating slow performance with source code and giving insights into backend database performance. In short it provides some observability into the state of your client-side applications and their impact on the database’s server-side.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003eGORM\u003c/code\u003e提供了\u003ca href=\"https://github.com/go-gorm/hints\"\u003ehints组件\u003c/a\u003e，可以支持\u003ccode\u003esqlcommenter\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-mysql\" data-lang=\"mysql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eimport \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm.io/hints\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDB.\u003cspan style=\"color:#a6e22e\"\u003eClauses\u003c/span\u003e(hints.\u003cspan style=\"color:#a6e22e\"\u003eComment\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;select\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;master\u0026#34;\u003c/span\u003e)).\u003cspan style=\"color:#a6e22e\"\u003eFind\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eUser\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{}\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eSELECT\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e/*master*/\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eusers\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDB.\u003cspan style=\"color:#a6e22e\"\u003eClauses\u003c/span\u003e(hints.\u003cspan style=\"color:#a6e22e\"\u003eCommentBefore\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;insert\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;node2\u0026#34;\u003c/span\u003e)).\u003cspan style=\"color:#66d9ef\"\u003eCreate\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e/*node2*/\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINSERT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINTO\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eusers\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e ...;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDB.\u003cspan style=\"color:#a6e22e\"\u003eClauses\u003c/span\u003e(hints.\u003cspan style=\"color:#a6e22e\"\u003eCommentAfter\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;select\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;node2\u0026#34;\u003c/span\u003e)).\u003cspan style=\"color:#66d9ef\"\u003eCreate\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e/*node2*/\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINSERT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINTO\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eusers\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e ...;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDB.\u003cspan style=\"color:#a6e22e\"\u003eClauses\u003c/span\u003e(hints.\u003cspan style=\"color:#a6e22e\"\u003eCommentAfter\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;where\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;hint\u0026#34;\u003c/span\u003e)).\u003cspan style=\"color:#a6e22e\"\u003eFind\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eUser\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{}\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;id = ?\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eSELECT\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eusers\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eWHERE\u003c/span\u003e id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e?\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e/* hint */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e但是需要在每个执行语句里引入类似\u003ccode\u003e.Clauses(hints.CommentBefore(\u0026quot;insert\u0026quot;, \u0026quot;node2\u0026quot;))\u003c/code\u003e代码。\u003c/p\u003e\n\u003cp\u003e我希望是全局增加\u003ccode\u003esqlcommenter\u003c/code\u003e，业务侧不需要过多调整。\u003c/p\u003e\n\u003cp\u003e完整代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplugins\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ego\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epackage plugins\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eimport (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tgorm \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm.io/gorm\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tgormclause \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm.io/gorm/clause\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Comment struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tContent string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (c Comment) Name() string {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;COMMENT\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (c Comment) Build(builder gormclause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuilder) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteString(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/* \u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteString(c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContent)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteString(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; */\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (c Comment) MergeClause(mergeClause \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egormclause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClause) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (c Comment) ModifyStatement(stmt \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tclause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses[c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName()]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e注意这里一定要是\u003c/span\u003eExpression\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，因为\u003c/span\u003eExpression为nil的话\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，是不会触发\u003c/span\u003eBuild方法执行的\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e这里一开始参考\u003c/span\u003ehints注册的BeforeExpression\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，导致\u003c/span\u003eBuild未执行\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，直到把整个\u003c/span\u003egorm流程梳理一遍才发现问题所在\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tclause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e c\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses[c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName()] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e extraClause \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;COMMENT\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype CommentClausePlugin struct{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e NewCommentClausePlugin create a new ExtraPlugin\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e NewCommentClausePlugin() \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eCommentClausePlugin {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eCommentClausePlugin{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Name plugin name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (ep \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eCommentClausePlugin) Name() string {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CommentClausePlugin\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Initialize register BuildClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (ep \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eCommentClausePlugin) Initialize(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB) (err error) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tinitClauses(db)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreate()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBefore(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:create\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CommentClausePlugin\u0026#34;\u003c/span\u003e, AddAnnotation)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDelete()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBefore(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:delete\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CommentClausePlugin\u0026#34;\u003c/span\u003e, AddAnnotation)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQuery()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBefore(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:query\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CommentClausePlugin\u0026#34;\u003c/span\u003e, AddAnnotation)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdate()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBefore(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:update\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CommentClausePlugin\u0026#34;\u003c/span\u003e, AddAnnotation)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRaw()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBefore(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:raw\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CommentClausePlugin\u0026#34;\u003c/span\u003e, AddAnnotation)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRow()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBefore(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:row\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CommentClausePlugin\u0026#34;\u003c/span\u003e, AddAnnotation)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e AddAnnotation(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eError \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trid :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;xx\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e从\u003c/span\u003econtext上下文里取rid信息\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e v, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContext\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eValue(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rid\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e(string); ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\trid \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e v\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcontent :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e fmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSprintf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rid=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e, rid)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLen() \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\toldSQL :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eString()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReset()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteString(fmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSprintf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e, content, oldSQL))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClause(Comment{Content: content})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e initClauses init SQL clause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e initClauses(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eError \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateClause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(extraClause, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreate()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteClause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(extraClause, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDelete()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tqueryClause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(extraClause, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQuery()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateClause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(extraClause, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdate()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trawClause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(extraClause, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRaw()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trowClause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(extraClause, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRow()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreate()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e createClause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDelete()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e deleteClause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQuery()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e queryClause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdate()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e updateClause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRaw()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e rawClause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRow()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e rowClause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emain\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ego\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epackage main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eimport (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;context\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;plugins\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    gorm \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm.io/gorm\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;github.com/google/uuid\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Product struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  Code  string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  Price uint\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e main() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    dsn :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;user:pass@tcp(127.0.0.1:3306)/dbname?charset=utf8mb4\u0026amp;parseTime=True\u0026amp;loc=Local\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    db, err :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOpen(mysql\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOpen(dsn), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig{})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUse(plugins\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNewCommentClausePlugin())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreate(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eProduct{Code: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;D42\u0026#34;\u003c/span\u003e, Price: \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e传入\u003c/span\u003econtext\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，指定\u003c/span\u003erid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ctx :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e context\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWithValue(context\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBackground(), \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rid\u0026#34;\u003c/span\u003e, uuid\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNew()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eString())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWithContext(ctx)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreate(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eProduct{Code: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;D42\u0026#34;\u003c/span\u003e, Price: \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e阻塞了两天的问题，终于解决了！😁😁😁\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/how-gorm-generates-sql/\"\u003ehow gorm generates sql\u003c/a\u003e\u003c/p\u003e\n","date_published":"2024-04-18T21:25:24+08:00","tags":["gorm","sqlcommenter"]},{"title":"源码分析：GORM是如何生成sql的","id":"https://liudon.com/posts/how-gorm-generates-sql/","url":"https://liudon.com/posts/how-gorm-generates-sql/","summary":"\u003cp\u003e在\u003ccode\u003egorm\u003c/code\u003e下实现\u003ca href=\"https://google.github.io/sqlcommenter/\"\u003esqlcommenter\u003c/a\u003e过程中，遇到一些问题，顺便把\u003ccode\u003egorm\u003c/code\u003e整个流程梳理了一遍，整理记录一下。\u003c/p\u003e\n\u003cp\u003egorm使用示例\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epackage main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eimport (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm.io/driver/mysql\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm.io/gorm\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Product struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  Code  string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  Price uint\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e main() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e参考\u003c/span\u003e https:\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003egithub\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecom\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ego\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003esql\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edriver\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003emysql\u003cspan style=\"color:#75715e\"\u003e#dsn-data-source-name 获取详情\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  dsn :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;user:pass@tcp(127.0.0.1:3306)/dbname?charset=utf8mb4\u0026amp;parseTime=True\u0026amp;loc=Local\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  db, err :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOpen(mysql\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOpen(dsn), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig{})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e product Product\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFirst(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eproduct, \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e根据整型主键查找\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e我们以\u003ccode\u003eFirst\u003c/code\u003e查询为例，看一下是怎么转成具体sql的。\u003c/p\u003e","content_html":"\u003cp\u003e在\u003ccode\u003egorm\u003c/code\u003e下实现\u003ca href=\"https://google.github.io/sqlcommenter/\"\u003esqlcommenter\u003c/a\u003e过程中，遇到一些问题，顺便把\u003ccode\u003egorm\u003c/code\u003e整个流程梳理了一遍，整理记录一下。\u003c/p\u003e\n\u003cp\u003egorm使用示例\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epackage main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eimport (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm.io/driver/mysql\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm.io/gorm\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Product struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  Code  string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  Price uint\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e main() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e参考\u003c/span\u003e https:\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003egithub\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecom\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ego\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003esql\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edriver\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003emysql\u003cspan style=\"color:#75715e\"\u003e#dsn-data-source-name 获取详情\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  dsn :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;user:pass@tcp(127.0.0.1:3306)/dbname?charset=utf8mb4\u0026amp;parseTime=True\u0026amp;loc=Local\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  db, err :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOpen(mysql\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOpen(dsn), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig{})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e product Product\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFirst(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eproduct, \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e根据整型主键查找\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e我们以\u003ccode\u003eFirst\u003c/code\u003e查询为例，看一下是怎么转成具体sql的。\u003c/p\u003e\n\u003cp\u003e在\u003ca href=\"https://github.com/go-gorm/gorm/blob/master/finisher_api.go\"\u003efinisher_api.go\u003c/a\u003e文件，声明了\u003ccode\u003eFirst\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e First finds the first record ordered by primary key, matching given conditions conds\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eDB) First(dest interface{}, conds \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003einterface{}) (tx \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eDB) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e注册\u003c/span\u003eOrder类型的Clause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\ttx \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLimit(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOrder(clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOrderByColumn{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tColumn: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCurrentTable, Name: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePrimaryKey},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e这里如果有指定条件的话，注册一个\u003c/span\u003eWhere类型的Clause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(conds) \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e exprs :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e tx\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuildCondition(conds[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e], conds[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e:]\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e); len(exprs) \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\ttx\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClause(clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWhere{Exprs: exprs})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\ttx\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRaiseErrorOnNotFound \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\ttx\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDest \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e dest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e tx\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecallbacks\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQuery()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExecute(tx)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在\u003ca href=\"https://github.com/go-gorm/gorm/blob/master/gorm.go\"\u003egorm.go\u003c/a\u003e文件，可以找到\u003ccode\u003etx.callbacks\u003c/code\u003e定义。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Config struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcallbacks  *callbacks\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcacheStore *sync.Map\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://github.com/go-gorm/gorm/blob/master/callbacks.go\"\u003ecallbacks.go\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e callbacks gorm callbacks manager\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype callbacks struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tprocessors map[string]\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eprocessor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype processor struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdb        \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eDB\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tClauses   []string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tfns       []\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eDB)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcallbacks []\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003ecallback\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype callback struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tname      string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tbefore    string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tafter     string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tremove    \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\treplace   \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tmatch     \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eDB) \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\thandler   \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eDB)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tprocessor \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eprocessor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e返回\u003c/span\u003equery类型的processor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (cs \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003ecallbacks) Query() \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eprocessor {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e cs\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprocessors[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;query\u0026#34;\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (p \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eprocessor) Execute(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eDB) \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eDB {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e call scopes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003escopes) \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eexecuteScopes()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tcurTime           \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e time\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNow()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tstmt              \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tresetBuildClauses \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e注意这里的\u003c/span\u003estmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuildClauses\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，后面会用到这个信息\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuildClauses) \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuildClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e p\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tresetBuildClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e optimizer, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDest\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e(StatementModifier); ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\toptimizer\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModifyStatement(stmt)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e assign model values\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModel \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModel \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDest \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDest \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e parse model values\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModel \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e err :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParse(stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModel); err \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eerrors\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIs(err, schema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eErrUnsupportedDataType) \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e (stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTable \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTableExpr \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLen() \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e errors\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIs(err, schema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eErrUnsupportedDataType) \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTable \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTableExpr \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddError(fmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eErrorf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%w: Table not set, please set it like: db.Model(\u0026amp;user) or db.Table(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eusers\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e)\u0026#34;\u003c/span\u003e, err))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddError(err)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e assign stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDest \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e reflect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eValueOf(stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDest)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eKind() \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e reflect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePtr {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsNil() \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCanAddr() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSet(reflect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNew(stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eType()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eElem()))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eElem()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003estmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsValid() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddError(ErrInvalidValue)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e根据优先级执行不同\u003c/span\u003ecallback的回调方法\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, f :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range p\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efns {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tf(db)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLen() \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLogger\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTrace(stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContext, curTime, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() (string, int64) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tsql, vars :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eString(), stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eVars\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e filter, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLogger\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e(ParamsFilter); ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tsql, vars \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e filter\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParamsFilter(stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContext, stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eString(), stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eVars\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExplain(sql, vars\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e), db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRowsAffected\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eError)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003estmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDryRun {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReset()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eVars \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e nil\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e resetBuildClauses {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuildClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e nil\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e db\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e接下来，我们来看一下内置的\u003ccode\u003ecallback\u003c/code\u003e是如何注册的。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/go-gorm/mysql/blob/master/mysql.go\"\u003emysql.go\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e CreateClauses create clauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tCreateClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;INSERT\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;VALUES\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ON CONFLICT\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e QueryClauses query clauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tQueryClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e UpdateClauses update clauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tUpdateClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;UPDATE\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SET\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;WHERE\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ORDER BY\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;LIMIT\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e DeleteClauses delete clauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tDeleteClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DELETE\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;FROM\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;WHERE\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ORDER BY\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;LIMIT\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdefaultDatetimePrecision \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (dialector Dialector) Initialize(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB) (err error) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDriverName \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDriverName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;mysql\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDefaultDatetimePrecision \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDefaultDatetimePrecision \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003edefaultDatetimePrecision\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConn \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConnPool \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConn\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConnPool, err \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e sql\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOpen(dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDriverName, dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDSN)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e err \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e err\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\twithReturning :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003edialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSkipInitializeWithVersion {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\terr \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConnPool\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryRowContext(context\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBackground(), \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SELECT VERSION()\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eScan(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003edialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eServerVersion)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e err \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e err\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e strings\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContains(dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eServerVersion, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;MariaDB\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportRenameIndex \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportRenameColumn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportForShareClause \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportNullAsDefaultValue \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\twithReturning \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e checkVersion(dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eServerVersion, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;10.5\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e strings\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eHasPrefix(dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eServerVersion, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;5.6.\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportRenameIndex \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportRenameColumn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportForShareClause \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportDropConstraint \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e strings\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eHasPrefix(dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eServerVersion, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;5.7.\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportRenameColumn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportForShareClause \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportDropConstraint \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e strings\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eHasPrefix(dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eServerVersion, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;5.\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDisableDatetimePrecision \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportRenameIndex \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportRenameColumn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportForShareClause \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportDropConstraint \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e strings\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContains(dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eServerVersion, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;TiDB\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDontSupportRenameColumnUnique \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e register callbacks\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcallbackConfig :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ecallbacks\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tCreateClauses: CreateClauses,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tQueryClauses:  QueryClauses,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tUpdateClauses: UpdateClauses,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tDeleteClauses: DeleteClauses,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003edialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDisableWithReturning \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e withReturning {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eutils\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContains(callbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreateClauses, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;RETURNING\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tcallbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreateClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(callbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreateClauses, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;RETURNING\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eutils\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContains(callbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdateClauses, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;RETURNING\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tcallbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdateClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(callbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdateClauses, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;RETURNING\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eutils\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContains(callbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDeleteClauses, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;RETURNING\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tcallbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDeleteClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(callbackConfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDeleteClauses, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;RETURNING\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e注册默认\u003c/span\u003ecallback\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcallbacks\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegisterDefaultCallbacks(db, callbackConfig)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e k, v :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range dialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauseBuilders() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauseBuilders[k] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e v\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://github.com/go-gorm/gorm/blob/master/callbacks/callbacks.go\"\u003ecallbacks.go\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;INSERT\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;VALUES\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ON CONFLICT\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tqueryClauses  \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SELECT\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;FROM\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;WHERE\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;GROUP BY\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ORDER BY\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;LIMIT\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;FOR\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;UPDATE\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SET\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;WHERE\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []string{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DELETE\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;FROM\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;WHERE\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Config struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tLastInsertIDReversed \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tCreateClauses        []string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tQueryClauses         []string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tUpdateClauses        []string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tDeleteClauses        []string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e RegisterDefaultCallbacks(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB, config \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eConfig) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tenableTransaction :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB) \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003edb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSkipDefaultTransaction\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreateClauses) \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tconfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreateClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e createClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryClauses) \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tconfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e queryClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDeleteClauses) \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tconfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDeleteClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e deleteClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdateClauses) \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tconfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdateClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e updateClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e注册不同类型的\u003c/span\u003ecallback\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreate()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMatch(enableTransaction)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:begin_transaction\u0026#34;\u003c/span\u003e, BeginTransaction)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:before_create\u0026#34;\u003c/span\u003e, BeforeCreate)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:save_before_associations\u0026#34;\u003c/span\u003e, SaveBeforeAssociations(true))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:create\u0026#34;\u003c/span\u003e, Create(config))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:save_after_associations\u0026#34;\u003c/span\u003e, SaveAfterAssociations(true))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:after_create\u0026#34;\u003c/span\u003e, AfterCreate)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMatch(enableTransaction)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:commit_or_rollback_transaction\u0026#34;\u003c/span\u003e, CommitOrRollbackTransaction)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcreateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCreateClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tqueryCallback :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQuery()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tqueryCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:query\u0026#34;\u003c/span\u003e, Query)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tqueryCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:preload\u0026#34;\u003c/span\u003e, Preload)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tqueryCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:after_query\u0026#34;\u003c/span\u003e, AfterQuery)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tqueryCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteCallback :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDelete()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMatch(enableTransaction)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:begin_transaction\u0026#34;\u003c/span\u003e, BeginTransaction)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:before_delete\u0026#34;\u003c/span\u003e, BeforeDelete)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:delete_before_associations\u0026#34;\u003c/span\u003e, DeleteBeforeAssociations)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:delete\u0026#34;\u003c/span\u003e, Delete(config))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:after_delete\u0026#34;\u003c/span\u003e, AfterDelete)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMatch(enableTransaction)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:commit_or_rollback_transaction\u0026#34;\u003c/span\u003e, CommitOrRollbackTransaction)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdeleteCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDeleteClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdate()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMatch(enableTransaction)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:begin_transaction\u0026#34;\u003c/span\u003e, BeginTransaction)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:setup_reflect_value\u0026#34;\u003c/span\u003e, SetupUpdateReflectValue)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:before_update\u0026#34;\u003c/span\u003e, BeforeUpdate)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:save_before_associations\u0026#34;\u003c/span\u003e, SaveBeforeAssociations(false))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:update\u0026#34;\u003c/span\u003e, Update(config))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:save_after_associations\u0026#34;\u003c/span\u003e, SaveAfterAssociations(false))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:after_update\u0026#34;\u003c/span\u003e, AfterUpdate)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMatch(enableTransaction)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:commit_or_rollback_transaction\u0026#34;\u003c/span\u003e, CommitOrRollbackTransaction)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tupdateCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUpdateClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trowCallback :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRow()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trowCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:row\u0026#34;\u003c/span\u003e, RowQuery)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trowCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trawCallback :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCallback()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRaw()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trawCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRegister(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gorm:raw\u0026#34;\u003c/span\u003e, RawExec)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\trawCallback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryClauses\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e到这里，默认callback就注册完成了，但是是如何转成对应sql的呢？\u003c/p\u003e\n\u003cp\u003e别急，我们继续往下看。\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003eRegisterDefaultCallbacks\u003c/code\u003e方法里注册了一个\u003ccode\u003egorm:query\u003c/code\u003e类型的callback，对应的回调方法为\u003ccode\u003eQuery\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/go-gorm/gorm/blob/master/callbacks/query.go\"\u003equery.go\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e Query(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eError \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e调用\u003c/span\u003eBuildQuerySQL方法\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tBuildQuerySQL(db)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003edb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDryRun \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eError \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\trows, err :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConnPool\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryContext(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContext, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eString(), db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eVars\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e err \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddError(err)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdefer \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddError(rows\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClose())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tgorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eScan(rows, db, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e BuildQuerySQL(db \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003egorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, c :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryClauses {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClause(c)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLen() \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGrow(\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tclauseSelect :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSelect{Distinct: db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDistinct}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eKind() \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e reflect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStruct \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eType() \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModelType {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e conds []clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, primaryField :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePrimaryFields {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e v, isZero :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e primaryField\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eValueOf(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eContext, db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue); \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eisZero {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tconds \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(conds, clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eEq{Column: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTable, Name: primaryField\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBName}, Value: v})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(conds) \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClause(clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWhere{Exprs: conds})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSelects) \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e make([]clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn, len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSelects))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e idx, name :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSelects {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns[idx] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Name: name, Raw: true}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e f :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLookUpField(name); f \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns[idx] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Name: f\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBName}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns[idx] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Name: name, Raw: true}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOmits) \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tselectColumns, _ :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSelectAndOmitColumns(false, false)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e make([]clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBNames))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, dbName :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBNames {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e v, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e selectColumns[dbName]; (ok \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e v) \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(clauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns, clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTable, Name: dbName})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsValid() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tqueryFields :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryFields\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003equeryFields {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eswitch\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eKind() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e reflect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStruct:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tqueryFields \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eType() \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModelType\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e reflect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSlice:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tqueryFields \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReflectValue\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eType()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eElem() \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModelType\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e queryFields {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tstmt :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement{DB: db}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e smaller struct\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e err :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParse(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDest); err \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e nil \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e (db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryFields \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModelType \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eModelType) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e make([]clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn, len(stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBNames))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e idx, dbName :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBNames {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns[idx] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTable, Name: dbName}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e inline joins\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tfromClause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFrom{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e v, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;FROM\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e(clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFrom); ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tfromClause \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e v\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins) \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e len(fromClause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins) \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSelects) \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOmits) \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e make([]clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn, len(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBNames))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e idx, dbName :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBNames {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns[idx] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTable, Name: dbName}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tspecifiedRelationsName :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e make(map[string]interface{})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, join :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e isRelations \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e is relations \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e raw sql\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e relations []\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eschema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelationship\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\trelation, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelationships\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelations[join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\tisRelations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\trelations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(relations, relation)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e handle nested join like \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Manager.Company\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\tnestedJoinNames :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e strings\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSplit(join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;.\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(nestedJoinNames) \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\tisNestedJoin :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\tgussNestedRelations :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e make([]\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eschema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelationship, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, len(nestedJoinNames))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\tcurrentRelations :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelationships\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, relname :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range nestedJoinNames {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e incomplete match, only treated as raw sql\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e relation, ok \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e currentRelations[relname]; ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\tgussNestedRelations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(gussNestedRelations, relation)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\tcurrentRelations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e relation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFieldSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelationships\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\tisNestedJoin \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e isNestedJoin {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tisRelations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\trelations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e gussNestedRelations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e isRelations {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\tgenJoinClause :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(joinType clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoinType, parentTableName string, relation \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eschema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelationship) clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoin {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\ttableAliasName :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e relation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e parentTableName \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCurrentTable {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\ttableAliasName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e utils\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNestedRelationName(parentTableName, tableAliasName)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\tcolumnStmt :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tTable: tableAliasName, DB: db, Schema: relation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFieldSchema,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tSelects: join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSelects, Omits: join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOmits,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\tselectColumns, restricted :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e columnStmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSelectAndOmitColumns(false, false)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, s :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range relation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFieldSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBNames {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e v, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e selectColumns[s]; (ok \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e v) \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eok \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003erestricted) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\tclauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(clauseSelect\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns, clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\tTable: tableAliasName,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\tName:  s,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\tAlias: utils\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNestedRelationName(tableAliasName, s),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\texprs :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e make([]clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression, len(relation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReferences))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e idx, ref :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range relation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReferences {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ref\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOwnPrimaryKey {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\texprs[idx] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eEq{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\tColumn: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: parentTableName, Name: ref\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePrimaryKey\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBName},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\tValue:  clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: tableAliasName, Name: ref\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eForeignKey\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBName},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ref\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePrimaryValue \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\texprs[idx] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eEq{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\tColumn: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: parentTableName, Name: ref\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eForeignKey\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBName},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\tValue:  clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: tableAliasName, Name: ref\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePrimaryKey\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBName},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\texprs[idx] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eEq{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\tColumn: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumn{Table: tableAliasName, Name: ref\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eForeignKey\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDBName},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\tValue:  ref\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePrimaryValue,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tonStmt :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e gorm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement{Table: tableAliasName, DB: db, Clauses: map[string]clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClause{}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, c :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range relation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFieldSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eQueryClauses {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\tonStmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClause(c)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOn \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\tonStmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClause(join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eOn)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e cs, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e onStmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;WHERE\u0026#34;\u003c/span\u003e]; ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e where, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e cs\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e(clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWhere); ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\twhere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuild(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eonStmt)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e onSQL :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e onStmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eString(); onSQL \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\tvars :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e onStmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eVars\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e idx, v :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range vars {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\t\tbindvar :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e strings\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuilder{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\t\tonStmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eVars \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e vars[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e : idx\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDialector\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBindVarTo(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ebindvar, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eonStmt, v)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\t\tonSQL \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e strings\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eReplace(onSQL, bindvar\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eString(), \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;?\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t\texprs \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(exprs, clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpr{SQL: onSQL, Vars: vars})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoin{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tType:  joinType,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tTable: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTable{Name: relation\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFieldSchema\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTable, Alias: tableAliasName},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tON:    clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWhere{Exprs: exprs},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\tparentTableName :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCurrentTable\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, rel :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range relations {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e joins table alias like \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Manager, Company, Manager__Company\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\tnestedAlias :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e utils\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNestedRelationName(parentTableName, rel\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e _, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e specifiedRelationsName[nestedAlias]; \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tfromClause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(fromClause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins, genJoinClause(join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoinType, parentTableName, rel))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tspecifiedRelationsName[nestedAlias] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e nil\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e parentTableName \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eCurrentTable {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tparentTableName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e utils\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNestedRelationName(parentTableName, rel\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t\tparentTableName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e rel\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\tfromClause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(fromClause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins, clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoin{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t\tExpression: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNamedExpr{SQL: join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName, Vars: join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConds},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\tfromClause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e append(fromClause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoins, clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eJoin{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\tExpression: clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eNamedExpr{SQL: join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName, Vars: join\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eConds},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClause(fromClause)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClauseIfNotExists(clause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFrom{})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAddClauseIfNotExists(clauseSelect)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuildClauses眼熟吗\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e？还记得前面的\u003c/span\u003estmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuildClauses吗\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e？\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tdb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuild(db\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eStatement\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuildClauses\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e重头戏终于来了，\u003ccode\u003eQuery\u003c/code\u003e方法里调用了\u003ccode\u003eBuildQuerySQl\u003c/code\u003e，看名字也能猜到这里就是生成sql了，这里最终调用了\u003ccode\u003edb.Statement.Build\u003c/code\u003e方法。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/go-gorm/gorm/blob/master/statement.go\"\u003estatement.go\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Build build sql with clauses names\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (stmt \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eStatement) Build(clauses \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003estring) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e firstClauseWritten \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e _, name :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range clauses {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e c, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauses[name]; ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e firstClauseWritten {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tstmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteByte(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tfirstClauseWritten \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e b, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e stmt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDB\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eClauseBuilders[name]; ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tb(c, stmt)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuild(stmt)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里会根据\u003ccode\u003estatement\u003c/code\u003e的\u003ccode\u003eBuildCluauses\u003c/code\u003e属性，执行\u003ccode\u003eClause\u003c/code\u003e的\u003ccode\u003eBuild\u003c/code\u003e方法。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/go-gorm/gorm/blob/master/clause/clause.go\"\u003eclause.go\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e ClauseBuilder clause builder, allows to customize how to build clause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype ClauseBuilder \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(Clause, Builder)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Writer interface {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tWriteByte(byte) error\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tWriteString(string) (\u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e, error)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Builder builder interface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Builder interface {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tWriter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tWriteQuoted(field interface{})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tAddVar(Writer, \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003einterface{})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tAddError(error) error\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Clause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Clause struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tName                string \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e WHERE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tBeforeExpression    Expression\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tAfterNameExpression Expression\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tAfterExpression     Expression\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tExpression          Expression\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tBuilder             ClauseBuilder\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Build build clause\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (c Clause) Build(builder Builder) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuilder \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuilder(c, builder)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBeforeExpression \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBeforeExpression\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuild(builder)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteByte(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteString(c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eName)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteByte(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAfterNameExpression \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAfterNameExpression\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuild(builder)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteByte(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuild(builder)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e c\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAfterExpression \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteByte(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAfterExpression\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eBuild(builder)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里会执行对应Clause的Build方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Select select attrs when querying, updating, creating\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype Select struct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tDistinct   \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tColumns    []Column\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tExpression Expression\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (s Select) Name() string {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SELECT\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (s Select) Build(builder Builder) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(s\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns) \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e s\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDistinct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteString(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DISTINCT \u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e idx, column :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range s\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eColumns {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e idx \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteByte(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;,\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteQuoted(column)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tbuilder\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWriteByte(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (s Select) MergeClause(clause \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003eClause) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e s\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e nil {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e s\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDistinct {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e expr, ok :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e s\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e(Expr); ok {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\texpr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DISTINCT \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e expr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSQL\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\tclause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e expr\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tclause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e s\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tclause\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eExpression \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e s\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这是\u003ccode\u003eSelect\u003c/code\u003e类型的\u003ccode\u003eClause\u003c/code\u003e定义，是不是一下就清楚了。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003egorm\u003c/code\u003e通过\u003ccode\u003ecallback\u003c/code\u003e里注册\u003ccode\u003eClause\u003c/code\u003e，在\u003ccode\u003eClause\u003c/code\u003e里实现了sql拼接操作。\u003c/p\u003e\n\u003cp\u003e看了几回源码，这次总算是搞清楚了。\u003c/p\u003e\n","date_published":"2024-04-18T21:14:24+08:00","tags":["gorm"]},{"title":"工银亚洲网银密码重置","id":"https://liudon.com/posts/%E5%B7%A5%E9%93%B6%E4%BA%9A%E6%B4%B2%E7%BD%91%E9%93%B6%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/","url":"https://liudon.com/posts/%E5%B7%A5%E9%93%B6%E4%BA%9A%E6%B4%B2%E7%BD%91%E9%93%B6%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/","summary":"\u003cp\u003e18年的时候办了张工银亚洲的银行卡，好几年没有用过了。\u003c/p\u003e\n\u003cp\u003e今年想起来了，发现网银登不上了，密码忘了。\u003c/p\u003e\n\u003cp\u003e最悲剧的是，试了超过10次，账户冻结了。\u003c/p\u003e\n\u003cp\u003e打95588咨询了一下，说是可以内地见证方式修改密码，只需要带上港澳通行证和身份证即可。\u003c/p\u003e","content_html":"\u003cp\u003e18年的时候办了张工银亚洲的银行卡，好几年没有用过了。\u003c/p\u003e\n\u003cp\u003e今年想起来了，发现网银登不上了，密码忘了。\u003c/p\u003e\n\u003cp\u003e最悲剧的是，试了超过10次，账户冻结了。\u003c/p\u003e\n\u003cp\u003e打95588咨询了一下，说是可以内地见证方式修改密码，只需要带上港澳通行证和身份证即可。\u003c/p\u003e\n\u003cp\u003e1月27日，东城出入境办理港澳通行证签注，排队半个小时左右，自助机操作。\u003c/p\u003e\n\u003cp\u003e顺路跑到附近可以见证开户的工行，说需要香港那边配合，人周末不上班，只能工作日。\u003c/p\u003e\n\u003cp\u003e电话西二旗支行，说是可以早上早点来办理，要不过年人多，没时间处理。\u003c/p\u003e\n\u003cp\u003e1月30日，早上直奔银行，赶在开门前到，第一个办理。\u003c/p\u003e\n\u003cp\u003e工作人员会指导你填写资料，填完后会给你两个信封，里面是重置后的网银密码。\u003c/p\u003e\n\u003cp\u003e1月31日下午，95588打电话，我以为是广告没接。\u003c/p\u003e\n\u003cp\u003e第二天早上反应过来，在路上的时候又打过来了。\u003c/p\u003e\n\u003cp\u003e香港那边直接电话，跟你确认身份信息后，下午就收到工行发来的已更新资料邮件。\u003c/p\u003e\n\u003cp\u003e其实这里密码就重置完了，因为我同时办理了更新通信地址，我以为是只更新了地址。\u003c/p\u003e\n\u003cp\u003e至此，整个流程就办完了，还是非常方便的。\u003c/p\u003e\n\u003cp\u003e另外，发现招银亚洲也没法登陆了，U盾过期了，又跑了一趟招行，重新办了个U盾。\u003c/p\u003e\n\u003cp\u003e好了，这下两个银行都可以正常使用了。\u003c/p\u003e\n","date_published":"2024-03-16T10:09:59+08:00","tags":[]},{"title":"加速Cloudflare访问","id":"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/","url":"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/","summary":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/blog.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/blog.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"blog.png\" width=\"828\" height=\"753\" alt=\"博客架构\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这是当前的博客架构，文件保存在\u003ccode\u003eGithub\u003c/code\u003e仓库，通过\u003ccode\u003eCloudflare Page\u003c/code\u003e提供访问。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/slow.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/slow.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"slow.png\" width=\"1080\" height=\"311\" alt=\"国内访问情况\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e众所周知，在国内，\u003ccode\u003eCloudflare\u003c/code\u003e的CDN属于反向加速，平均耗时在1.5s左右。\u003c/p\u003e","content_html":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/blog.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/blog.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"blog.png\" width=\"828\" height=\"753\" alt=\"博客架构\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这是当前的博客架构，文件保存在\u003ccode\u003eGithub\u003c/code\u003e仓库，通过\u003ccode\u003eCloudflare Page\u003c/code\u003e提供访问。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/slow.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/slow.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"slow.png\" width=\"1080\" height=\"311\" alt=\"国内访问情况\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e众所周知，在国内，\u003ccode\u003eCloudflare\u003c/code\u003e的CDN属于反向加速，平均耗时在1.5s左右。\u003c/p\u003e\n\u003cp\u003e今天，我们就来讲一下，如何实现国内海外双线路博客访问。\u003c/p\u003e\n\u003ch4 id=\"大体思路\"\u003e大体思路\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e海外继续走Cloudflare Page，国内再套一层CDN回源Cloudflare Page。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCloudflare Page已经提供了一个cname域名A，形如xxx.pages.dev。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e国内CDN添加域名后，也会提供一个cname域名B。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e使用国内dns解析服务，配置cname双线路解析。\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"具体操作\"\u003e具体操作\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eCloudflare Page\u003c/code\u003e添加新域名解析\u003c/p\u003e\n\u003cp\u003e这个域名是为了给国内CDN回源使用，与博客当前域名不同即可。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/page.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/page.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"page.png\" width=\"1080\" height=\"323\" alt=\"Cloudflare Page添加域名\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e配置国内CDN\u003c/p\u003e\n\u003cp\u003e我用的腾讯云，其他服务商也是可以的。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/cdn.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/cdn.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"cdn.png\" width=\"957\" height=\"992\" alt=\"添加CDN域名\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e加速域名：填写博客对外访问的域名\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e回源地址和Host：填写第一步新加的域名\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e添加成功后，会有一个cname地址，这里是国内线路解析要用到的。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDNS解析调整\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eCloudflare\u003c/code\u003e不支持双线路配置，国内服务商支持，我这里用的是腾讯云。\u003c/p\u003e\n\u003cp\u003e首先将域名的NS解析改为国内服务商的NS地址，修改后2周左右会收到\u003ccode\u003eCloudflare\u003c/code\u003e的邮件，不需要理会。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eliudon.com 的名称服务器不再指向 Cloudflare。它们现在指向：\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esandals.dnspod.net\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eheron.dnspod.net\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[not set]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[not set]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[not set]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e此更改意味着 liudon.com 不再使用 Cloudflare，因此不会再享受我们的安全和性能服务带来的优势。您的 DNS 记录将在 7 天内从我们的系统中彻底删除。\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e然后添加解析，默认走国内CDN，境外走\u003ccode\u003eCloudflare Page\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/dns.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/dns.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"dns.png\" width=\"1006\" height=\"249\" alt=\"DNS双线路解析\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"额外的问题\"\u003e额外的问题\u003c/h4\u003e\n\u003cp\u003e为了加速\u003ccode\u003eGoogle Analytics\u003c/code\u003e，使用\u003ccode\u003eCloudflare Worker\u003c/code\u003e进行了反代，具体见\u003ca href=\"https://liudon.com/posts/optimize-google-analytics/\"\u003e加速Google Analytics\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e更改NS后，导致海外访问无法触发\u003ccode\u003eCloudflare Worker\u003c/code\u003e了，导致没有博客统计数据了。\u003c/p\u003e\n\u003cp\u003e经过一番搜索后，发现\u003ccode\u003eCloudflare Page\u003c/code\u003e有类似的\u003ccode\u003eFunction\u003c/code\u003e功能，只需要在网站根目录下新建\u003ccode\u003efunctions\u003c/code\u003e目录，添加对应文件即可。\u003c/p\u003e\n\u003cp\u003e这里以\u003ccode\u003eHugo\u003c/code\u003e静态博客举例说明：\u003c/p\u003e\n\u003cp\u003e在根目录的\u003ccode\u003estatic\u003c/code\u003e目录下，新建\u003ccode\u003efunctions\u003c/code\u003e目录，新建\u003ccode\u003eanalytics\u003c/code\u003e目录，添加\u003ccode\u003epost.js\u003c/code\u003e文件。\u003c/p\u003e\n\u003cp\u003e这个\u003ccode\u003eanalytics/post.js\u003c/code\u003e是为了对应原有\u003ccode\u003eWorker\u003c/code\u003e的访问地址\u003ccode\u003eanalytics/post\u003c/code\u003e，可自行修改。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epost.js\u003c/code\u003e文件代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eexport\u003c/span\u003e async function onRequest(context) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    try {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e await postHandler(context);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } catch(e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e new Response(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003emessage}\\n\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estack}\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e, { status: \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e }); \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003easync function postHandler(context) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e GA_DOMAIN \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;google-analytics.com\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e GA_COLLECT_PATH \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;g\\/collect\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e COLLECT_PATH \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;analytics/post\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e DOMAIN \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;这里填你博客的域名\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e context\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erequest\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eurl;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e cf_ip \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e context\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erequest\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eheaders\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;CF-Connecting-IP\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e cf_country \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e context\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erequest\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecf\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecountry;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e ga_url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e url\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{DOMAIN}\u003cspan style=\"color:#f92672\"\u003e/$\u003c/span\u003e{COLLECT_PATH}\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{GA_DOMAIN}\u003cspan style=\"color:#f92672\"\u003e/$\u003c/span\u003e{GA_COLLECT_PATH}\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e newReq \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e await readRequest(context\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erequest, ga_url);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    context\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ewaitUntil(fetch(newReq));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e new Response(null, {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        status: \u003cspan style=\"color:#ae81ff\"\u003e204\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        statusText: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;No Content\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      });\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003easync function readRequest(request, url) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e { _, headers } \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e request;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e nq \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      method: request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003emethod,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      headers: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Origin: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;origin\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Cache-Control\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;max-age=0\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;User-Agent\u0026#39;\u003c/span\u003e: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;user-agent\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Accept: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;accept\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Accept-Language\u0026#39;\u003c/span\u003e: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;accept-language\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Content-Type\u0026#39;\u003c/span\u003e: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;content-type\u0026#39;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;text/plain\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Referer: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;referer\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      body: request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebody,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    };\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e new Request(url, nq);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"优化效果\"\u003e优化效果\u003c/h4\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/result.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8A%A0%E9%80%9Fcloudflare%E8%AE%BF%E9%97%AE/result.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"result.png\" width=\"1080\" height=\"284\" alt=\"优化后的访问\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e有了国内CDN的加持，平均耗时优化到1s左右了。\u003c/p\u003e\n","date_published":"2024-02-21T20:25:49+08:00","tags":["cloudflare","博客优化"]},{"title":"2023年终总结","id":"https://liudon.com/posts/review-2023/","url":"https://liudon.com/posts/review-2023/","summary":"\u003cp\u003e2023年过完了，是时候来个总结了。\u003c/p\u003e\n\u003ch4 id=\"博客\"\u003e博客\u003c/h4\u003e\n\u003cp\u003e2023年一共更新了15篇内容，共计12000字。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240104184720.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240104184720.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240104184720.png\" width=\"733\" height=\"436\" alt=\"Google Analytics全年统计\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e访问Top3的文章：\u003c/p\u003e","content_html":"\u003cp\u003e2023年过完了，是时候来个总结了。\u003c/p\u003e\n\u003ch4 id=\"博客\"\u003e博客\u003c/h4\u003e\n\u003cp\u003e2023年一共更新了15篇内容，共计12000字。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240104184720.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240104184720.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240104184720.png\" width=\"733\" height=\"436\" alt=\"Google Analytics全年统计\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e访问Top3的文章：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/deploy-blog-to-ipfs/\"\u003e将博客部署到星际文件系统(IPFS)\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/\"\u003e利用Github Actions定时抓取微博\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/fix-blog-cls/\"\u003e优化博客的累计布局偏移(CLS)问题\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e主要是因为有在v2ex发帖导流，所以访问量高一些。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/\"\u003e2023年12月北京暴雪记录\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e没想到的是一篇暴雪记录，收获了最多的评论，可能大家更容易共情。\u003c/p\u003e\n\u003cp\u003e不过从侧面也说明了技术的东西并没有太多人看，所以后来就不再分享导流了。\u003c/p\u003e\n\u003ch4 id=\"工作\"\u003e工作\u003c/h4\u003e\n\u003cp\u003e今年搬到了后厂村，见识了互联网的人流。\u003c/p\u003e\n\u003cp\u003e在23年最后一个工作日，下班路上，算了一下，这一年晚上9点半之后打车59次。\u003c/p\u003e\n\u003cp\u003e而且年底这段时间，打车愈发困难，至少要排队1个小时。\u003c/p\u003e\n\u003cp\u003e相比之前一坐坐一天，每天中午会绕公司大楼转两圈。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240104190037.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240104190037.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240104190037.jpg\" width=\"1080\" height=\"1099\" alt=\"23年步行统计\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch4 id=\"驾照\"\u003e驾照\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/my-journey-of-learning-to-drive/\"\u003e驾照终于到手了\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e趁着娃暑假、十一假期，开车上路了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240104190649.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240104190649.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240104190649.jpg\" width=\"1080\" height=\"1920\" alt=\"第一次开车上路\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e参与了第一次摇号。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240106165345.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240106165345.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240106165345.jpg\" width=\"1080\" height=\"2341\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch4 id=\"换了新手机\"\u003e换了新手机\u003c/h4\u003e\n\u003cp\u003e用了5年的iPhone7 plus，过地铁NFC时不时刷不开了，感觉得换手机了。\u003c/p\u003e\n\u003cp\u003e十一假期回来在官网订了15pro，需要11月21日才能发货。\u003c/p\u003e\n\u003cp\u003e订货后，老手机的问题越来越多，换手机变的急迫起来。\u003c/p\u003e\n\u003cp\u003e于是，开始刷实体店取货。\u003c/p\u003e\n\u003cp\u003e用了探火app监控，10月11日中午抢到一台王府井取货。\u003c/p\u003e\n\u003cp\u003e10月12日晚上8点出发，上16号线地铁后，老手机开始持续发烫，过一会自动黑屏了。\u003c/p\u003e\n\u003cp\u003e按键有触感，但是屏幕不亮，怎么捣鼓也不行，手机越来越烫，都有点怕它炸了。\u003c/p\u003e\n\u003cp\u003e换乘8号线的路上，试了试按住所有按键，手机重启了，看见苹果logo那一刻真好。\u003c/p\u003e\n\u003cp\u003e重启完总算正常了，进店排队取货，提前了一个月拿到了新手机。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105132858.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105132858.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105132858.jpg\" width=\"1080\" height=\"1440\" alt=\"王府井Apple Store\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105132906.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105132906.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105132906.jpg\" width=\"1080\" height=\"1440\" alt=\"取完手机\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e升级体验非常好，使用丝滑，再也不用插着充电器玩手机了，感谢老婆。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133752.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133752.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133752.jpg\" width=\"1080\" height=\"810\" alt=\"大风\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133758.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133758.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133758.jpg\" width=\"1080\" height=\"810\" alt=\"公司大楼\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133747.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133747.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133747.jpg\" width=\"1080\" height=\"1440\" alt=\"枫叶\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133803.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133803.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133803.jpg\" width=\"1080\" height=\"1440\" alt=\"秋\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133808.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133808.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133808.jpg\" width=\"1080\" height=\"1440\" alt=\"冬\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133819.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133819.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133819.jpg\" width=\"1080\" height=\"1440\" alt=\"冬\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133739.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133739.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133739.jpg\" width=\"1080\" height=\"1440\" alt=\"秋天的百望山\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133814.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133814.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133814.jpg\" width=\"1080\" height=\"1440\" alt=\"冬天的百望山\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240105133825.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240105133825.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240105133825.jpg\" width=\"1080\" height=\"1440\" alt=\"冬天的百望山\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch4 id=\"财务\"\u003e财务\u003c/h4\u003e\n\u003cp\u003e提前还了两笔房贷，希望明年可以把商贷还完。\u003c/p\u003e\n\u003cp\u003e股市收益率-1.11%，港股套牢中，美股稍微回了点血。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2023/20240104191508.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2023/20240104191508.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20240104191508.jpg\" width=\"1080\" height=\"939\" alt=\"股市收益\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e本命年了，希望一切顺利。\u003c/p\u003e\n\u003cp\u003e祝大家新年快乐！\u003c/p\u003e\n","date_published":"2024-01-04T18:41:20+08:00","tags":["年终总结"]},{"title":"2023年12月北京暴雪记录","id":"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/","url":"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/","summary":"\u003cblockquote\u003e\n\u003cp\u003e记录暴雪下普通打工人的生活。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"12月14日-周四\"\u003e12月14日 周四\u003c/h4\u003e\n\u003cp\u003e北京的雪已经连着下了两天了。\u003c/p\u003e\n\u003cp\u003e12月11日，也是因为下雪，晚上打车打到10点半才叫到车。\u003c/p\u003e\n\u003cp\u003e所以这次下雪后，晚上就早走了。\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003e记录暴雪下普通打工人的生活。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"12月14日-周四\"\u003e12月14日 周四\u003c/h4\u003e\n\u003cp\u003e北京的雪已经连着下了两天了。\u003c/p\u003e\n\u003cp\u003e12月11日，也是因为下雪，晚上打车打到10点半才叫到车。\u003c/p\u003e\n\u003cp\u003e所以这次下雪后，晚上就早走了。\u003c/p\u003e\n\u003cp\u003e7:15坐上公司摆渡车，7:40左右到西二旗。\u003c/p\u003e\n\u003cp\u003e下车前刷微博看到有说昌平线故障，还没细看就到站下车了，还没想到事情的严重性。\u003c/p\u003e\n\u003cp\u003e路口已经有交警在指挥交通，看见两辆消防车在等红灯，事后想可能是去救援的。\u003c/p\u003e\n\u003cp\u003e走到进站口，就听到有人喊，“昌平线故障不停车，请更换其他交通工具”。\u003c/p\u003e\n\u003cp\u003e我坐13号线，继续往前走，就看到了下面的情景。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/WechatIMG150.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/WechatIMG150.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG150.jpg\" width=\"1080\" height=\"810\" alt=\"西二旗进站口\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e栏杆里全是人，后面的人还在不断的往里进。\u003c/p\u003e\n\u003cp\u003e看了下门口的人不动，人太多，不敢进去，先看看情况。\u003c/p\u003e\n\u003cp\u003e过了一会，有人喊13号线也停了，扭头赶紧走。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/WechatIMG151.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/WechatIMG151.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG151.jpg\" width=\"1080\" height=\"2340\" alt=\"打车等候人数\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e第一反应打车，看了下，排队900人，直接放弃，换公交。\u003c/p\u003e\n\u003cp\u003e最近的公交站在西二旗大街，走吧。\u003c/p\u003e\n\u003cp\u003e到公交站一看，人更多，本来路就窄，全是人，走都没法走。\u003c/p\u003e\n\u003cp\u003e公交也没戏了，继续走吧，走过这段到前面看看再。\u003c/p\u003e\n\u003cp\u003e事后看说有的车被挤爆了，吓的别的车都不敢开门了。\u003c/p\u003e\n\u003cp\u003e走的有点冷，闻见一股香味，一看手机快8点半了，找个地吃点东西先。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/WechatIMG152.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/WechatIMG152.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG152.jpg\" width=\"1080\" height=\"810\" alt=\"吉祥馄饨\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e一碗馄饨下肚，暖和多了，继续上路。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/WechatIMG153.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/2023%E5%B9%B412%E6%9C%88%E5%8C%97%E4%BA%AC%E6%9A%B4%E9%9B%AA%E8%AE%B0%E5%BD%95/WechatIMG153.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG153.jpg\" width=\"1080\" height=\"1440\" alt=\"路上\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e走的小腿有点酸了，终于到公交站了。\u003c/p\u003e\n\u003cp\u003e等了一小会，总算上车了。\u003c/p\u003e\n\u003cp\u003e车也不敢开的快，10迈左右。\u003c/p\u003e\n\u003cp\u003e晚上10点，终于到家了。\u003c/p\u003e\n\u003cp\u003e路上花费\u003cstrong\u003e2小时45分钟\u003c/strong\u003e。\u003c/p\u003e\n\u003ch4 id=\"12月15日-周五\"\u003e12月15日 周五\u003c/h4\u003e\n\u003cp\u003e早上坐公交到地铁站。\u003c/p\u003e\n\u003cfigure\u003e\n    \u003cvideo src=QWh2AALxlx08aXnxzCB201041200h2nD0E018.mp4 controls\u003e\n    你的浏览器不支持 \u003ccode\u003evideo\u003c/code\u003e 标签。\n    \u003c/video\u003e\n\u003c/figure\u003e\n\u003cp\u003e霍营地铁站盛况，人挤满了整个通道。\u003c/p\u003e\n\u003cp\u003e立马出站，换乘公交。\u003c/p\u003e\n\u003cp\u003e路上花费\u003cstrong\u003e2小时\u003c/strong\u003e。\u003c/p\u003e\n","date_published":"2023-12-16T10:15:33+08:00","tags":[]},{"title":"使用Hugo实现响应式和优化的图片","id":"https://liudon.com/posts/responsive-and-optimized-images-with-hugo/","url":"https://liudon.com/posts/responsive-and-optimized-images-with-hugo/","summary":"\u003cp\u003e继续我们的\u003ca href=\"/tags/%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96/\"\u003e博客优化之旅\u003c/a\u003e，本篇内容我们将介绍如何使用\u003ccode\u003eHugo\u003c/code\u003e实现响应式和优化的图片。\u003c/p\u003e\n\u003ch4 id=\"问题\"\u003e问题\u003c/h4\u003e\n\u003cp\u003e在之前文章里，通过腾讯云数据万象实现了图片优化能力，具体的可参考文章\u003ca href=\"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/\"\u003e累计布局偏移修复方案改进 —— 自动生成图片宽高\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e经过一段运行后，发现这里有一个弊端。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRun hugo --gc --minify --cleanDestinationDir\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStart building sites … \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehugo v0.119.0-b84644c008e0dc2c4b67bd69cccf87a41a03937e linux/amd64 BuildDate=2023-09-24T15:20:17Z VendorInfo=gohugoio\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eERROR Failed to get JSON resource \u0026#34;https://static.***.com/64412246-9050f100-d0c1-11e9-893a-f9b0766533ad.png?imageInfo\u0026amp;t=1698674110\u0026#34;: Get \u0026#34;https://static.***.com/64412246-9050f100-d0c1-11e9-893a-f9b0766533ad.png?imageInfo\u0026amp;t=1698674110\u0026#34;: stream error: stream ID 1; STREAM_CLOSED; received from peer\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eERROR Failed to get JSON resource \u0026#34;https://static.***.com/SkRx5uFwQ8Cliyq.jpg?imageInfo\u0026amp;t=1698674110\u0026#34;: Get \u0026#34;https://static.***.com/SkRx5uFwQ8Cliyq.jpg?imageInfo\u0026amp;t=1698674110\u0026#34;: stream error: stream ID 3; STREAM_CLOSED; received from peer\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e随着图片数量增多，因为需要调接口查询图片信息，这里构建耗时变长，同时也特别容易出现超时导致构建失败。\u003c/p\u003e","content_html":"\u003cp\u003e继续我们的\u003ca href=\"/tags/%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96/\"\u003e博客优化之旅\u003c/a\u003e，本篇内容我们将介绍如何使用\u003ccode\u003eHugo\u003c/code\u003e实现响应式和优化的图片。\u003c/p\u003e\n\u003ch4 id=\"问题\"\u003e问题\u003c/h4\u003e\n\u003cp\u003e在之前文章里，通过腾讯云数据万象实现了图片优化能力，具体的可参考文章\u003ca href=\"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/\"\u003e累计布局偏移修复方案改进 —— 自动生成图片宽高\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e经过一段运行后，发现这里有一个弊端。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRun hugo --gc --minify --cleanDestinationDir\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStart building sites … \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehugo v0.119.0-b84644c008e0dc2c4b67bd69cccf87a41a03937e linux/amd64 BuildDate=2023-09-24T15:20:17Z VendorInfo=gohugoio\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eERROR Failed to get JSON resource \u0026#34;https://static.***.com/64412246-9050f100-d0c1-11e9-893a-f9b0766533ad.png?imageInfo\u0026amp;t=1698674110\u0026#34;: Get \u0026#34;https://static.***.com/64412246-9050f100-d0c1-11e9-893a-f9b0766533ad.png?imageInfo\u0026amp;t=1698674110\u0026#34;: stream error: stream ID 1; STREAM_CLOSED; received from peer\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eERROR Failed to get JSON resource \u0026#34;https://static.***.com/SkRx5uFwQ8Cliyq.jpg?imageInfo\u0026amp;t=1698674110\u0026#34;: Get \u0026#34;https://static.***.com/SkRx5uFwQ8Cliyq.jpg?imageInfo\u0026amp;t=1698674110\u0026#34;: stream error: stream ID 3; STREAM_CLOSED; received from peer\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e随着图片数量增多，因为需要调接口查询图片信息，这里构建耗时变长，同时也特别容易出现超时导致构建失败。\u003c/p\u003e\n\u003cp\u003e失败的时候，需要手动重跑构建，自动化发布卡壳了。\u003c/p\u003e\n\u003ch4 id=\"优化\"\u003e优化\u003c/h4\u003e\n\u003cp\u003e经过一番搜索，发现其实\u003ccode\u003eHugo\u003c/code\u003e本身是支持图片处理能力的。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eImage processing\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eResize, crop, rotate, filter, and convert images.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gohugo.io/content-management/image-processing/\"\u003ehttps://gohugo.io/content-management/image-processing/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e下面以我使用的\u003ca href=\"https://github.com/adityatelange/hugo-PaperMod/\"\u003ePaperMod主题\u003c/a\u003e为例，讲下如何通过\u003ccode\u003eimage processing\u003c/code\u003e实现图片响应式优化。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eimage processing\u003c/code\u003e需要用到\u003ccode\u003ePage bundles\u003c/code\u003e，所以\u003cstrong\u003e文章目录结构需要调整\u003c/strong\u003e，\n将一篇文章的资源（md文件，图片等）放在一个目录下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econtent/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├── posts\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   ├── my-post\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   │   ├── content1.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   │   ├── content2.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   │   ├── image1.jpg\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   │   ├── image2.png\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   │   └── index.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   └── my-other-post\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│       └── index.md\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e目录结构调整完毕后，接下来修改图片显示文件代码。\u003c/p\u003e\n\u003cp\u003e这里需要生成\u003ccode\u003ewebp\u003c/code\u003e格式图片，所以\u003cstrong\u003e需要使用\u003ccode\u003ehugo\u003c/code\u003e的extended版本\u003c/strong\u003e。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ePagerMod\u003c/code\u003e主题涉及到图片显示的一共三个文件：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e_default/_markup/render-image.html，对应markdown图片语法解析。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e slice \u003cspan style=\"color:#ae81ff\"\u003e480\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e720\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1080\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}} \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e生成的图片规格\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(min-width: 768px) 720px, 100vw\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eholder :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;GIP\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehint :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;photo\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;box\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eDestination :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDestination \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eText :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eText \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eTitle :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTitle \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e内容图片响应式开关配置，默认为\u003c/span\u003etrue\u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePage\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default site\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages) \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default true }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePage\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResources\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGetMatch \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDestination }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e只有使用了\u003c/span\u003ehugo扩展版本的\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，才生成\u003c/span\u003ewebp格式图片\u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e hugo\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsExtended (ne \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMediaType\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eType \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e range \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei }}, {{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResize (print \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x webp \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehint \u003cspan style=\"color:#e6db74\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter) )\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelPermalink \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e absURL }} {{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}w\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; sizes=\u0026#34;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes }}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; /\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $src.MediaType.Type }}\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e range \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ge \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei }}, {{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResize (print \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x jpg \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter) )\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelPermalink \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e absURL}} {{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}w\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}, {{\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePermalink }} {{printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ew\u0026#34;\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth)}}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; sizes=\u0026#34;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes }}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; /\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Destination | safeURL }}\u0026#34;\u003c/span\u003e width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .Width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .Height }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Text }}\u0026#34;\u003c/span\u003e title\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Title }}\u0026#34;\u003c/span\u003e loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Destination | safeURL }}\u0026#34;\u003c/span\u003e width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $src.Width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $src.Height }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Text }}\u0026#34;\u003c/span\u003e title\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Title }}\u0026#34;\u003c/span\u003e loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ end }}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003epartials/cover.html，对应文章封面解析。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e slice \u003cspan style=\"color:#ae81ff\"\u003e480\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e720\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1080\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(min-width: 768px) 720px, 100vw\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eholder :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;GIP\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehint :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;photo\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;box\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecxt}} {{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e Apply proper context from dict \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eimage (\u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$.\u003c/span\u003eisHidden)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealt :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ealt \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecaption \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e plainify) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003efigure \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;entry-cover\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e封面响应式图片配置开关，默认为\u003c/span\u003etrue\u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default site\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages) \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default true }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e site\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elinkFullImages (\u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$.\u003c/span\u003eIsHome)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResources\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eByType \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGetMatch (printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e*\u0026#34;\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eimage)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e i\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ee it is present \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e page bundle \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (path.Join .RelPermalink .Params.cover.image) | absURL }}\u0026#34;\u003c/span\u003e target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_blank\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            rel\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;noopener noreferrer\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e hugo\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsExtended (ne \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMediaType\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eType \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e range \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei }}, {{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResize (print \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x webp \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehint \u003cspan style=\"color:#e6db74\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter) )\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelPermalink \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e absURL }} {{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}w\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; sizes=\u0026#34;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes }}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; /\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $cover.MediaType.Type }}\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e range \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ge \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei }}, {{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResize (print \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x jpg \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter) )\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelPermalink \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e absURL}} {{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}w\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}, {{\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePermalink }} {{printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ew\u0026#34;\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth)}}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; sizes=\u0026#34;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes }}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; /\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $cover.Permalink }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $alt }}\u0026#34;\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $cover.Width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $cover.Height }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e }}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e Unprocessable image \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e responsive images disabled \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (path.Join .RelPermalink .Params.cover.image) | absURL }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $alt }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e }}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e For absolute urls \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e external links, no img processing here \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.image) | absURL }}\u0026#34;\u003c/span\u003e target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_blank\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            rel\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;noopener noreferrer\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.image) | absURL }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $alt }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003ea\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e  Display Caption  \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$.\u003c/span\u003eIsHome }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{ with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecaption }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ep\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e markdownify }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003ep\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003efigure\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e End image \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e End context \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eshortcodes/figure.html，对应文章内\u003ccode\u003efigure\u003c/code\u003e语法解析。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e slice \u003cspan style=\"color:#ae81ff\"\u003e480\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e720\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1080\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(min-width: 768px) 720px, 100vw\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eholder :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;GIP\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehint :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;photo\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;box\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;src\u0026#34;\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealign :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;align\u0026#34;\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealt :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;alt\u0026#34;\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecaption :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;caption\u0026#34;\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e内容图片响应式开关配置，默认为\u003c/span\u003etrue\u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePage\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default site\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages) \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default true }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003efigure{{ \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;class\u0026#34;\u003c/span\u003e) (eq (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;align\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;center\u0026#34;\u003c/span\u003e) }} \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e eq (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;align\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;center\u0026#34;\u003c/span\u003e }}align\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecenter {{ end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;class\u0026#34;\u003c/span\u003e }}{{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;link\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .Get \u0026#34;\u003c/span\u003elink\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; }}\u0026#34;\u003c/span\u003e{{ with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;target\u0026#34;\u003c/span\u003e }} target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{ end }}{{ with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rel\u0026#34;\u003c/span\u003e }} rel\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{ end }}\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{ with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$.\u003c/span\u003ePage\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResources\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGetMatch (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;src\u0026#34;\u003c/span\u003e) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e hugo\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsExtended (ne \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMediaType\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eType \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e range \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei }}, {{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResize (print \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x webp \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehint \u003cspan style=\"color:#e6db74\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter) )\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelPermalink \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e absURL }} {{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}w\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; sizes=\u0026#34;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes }}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; /\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $src.MediaType.Type }}\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erespSizes \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e range \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ge \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ei }}, {{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResize (print \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x jpg \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilter) )\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRelPermalink \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e absURL}} {{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}w\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}, {{\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePermalink }} {{printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ew\u0026#34;\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth)}}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; sizes=\u0026#34;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edataSzes }}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; /\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $src }}{{- if eq ($align) \u0026#34;\u003c/span\u003ecenter\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; }}#center{{- end }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealt) (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecaption) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ with $alt }}{{ . }}{{ else }}{{ $caption | markdownify| plainify }}{{ end }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}} width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esrc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eHeight \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}} height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;!--\u003c/span\u003e Closing img tag \u003cspan style=\"color:#f92672\"\u003e--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{ end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;link\u0026#34;\u003c/span\u003e }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003ea\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;title\u0026#34;\u003c/span\u003e) (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;caption\u0026#34;\u003c/span\u003e)) (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;attr\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003efigcaption\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{ with (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;title\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;caption\u0026#34;\u003c/span\u003e) (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;attr\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ep\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;caption\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e markdownify \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;attrlink\u0026#34;\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;attr\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e markdownify \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;attrlink\u0026#34;\u003c/span\u003e }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003ea\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003ep\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003efigcaption\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003efigure\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"使用效果\"\u003e使用效果\u003c/h4\u003e\n\u003cp\u003e正常插入\u003ccode\u003ejpg/png\u003c/code\u003e图片，构建后会自动生成webp/原始格式下不同规格的图片。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emarkdown图片显示\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/responsive-and-optimized-images-with-hugo/render-image.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/responsive-and-optimized-images-with-hugo/render-image.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"render-image.png\" width=\"1080\" height=\"808\" alt=\"render-image\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efigure短代码显示\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/responsive-and-optimized-images-with-hugo/figure.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/responsive-and-optimized-images-with-hugo/figure.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"figure.png\" width=\"1080\" height=\"766\" alt=\"figure\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e封面显示\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/responsive-and-optimized-images-with-hugo/cover.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/responsive-and-optimized-images-with-hugo/cover.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"cover.png\" width=\"1080\" height=\"671\" alt=\"cover\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e提示：\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e随着图片数量增多，可能会遇到构建超时的错误，类似下述信息：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-mysql\" data-lang=\"mysql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStart building sites \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e…\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehugo v0.\u003cspan style=\"color:#ae81ff\"\u003e96\u003c/span\u003e.\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003eextended darwin\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003earm64 BuildDate\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eunknown\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eError: Error building site: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/Users/dondonliu/Code/liudon.github.io/content/posts/xxxx/index.md:1:1\u0026#34;\u003c/span\u003e: timed \u003cspan style=\"color:#66d9ef\"\u003eout\u003c/span\u003e initializing value. You may have a circular \u003cspan style=\"color:#66d9ef\"\u003eloop\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ein\u003c/span\u003e a shortcode, \u003cspan style=\"color:#66d9ef\"\u003eor\u003c/span\u003e your site may have resources that take longer \u003cspan style=\"color:#66d9ef\"\u003eto\u003c/span\u003e build than the \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003etimeout\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003elimit\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ein\u003c/span\u003e your Hugo config file.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBuilt \u003cspan style=\"color:#66d9ef\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e22356\u003c/span\u003e ms\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可以通过修改配置文件\u003ccode\u003econfig.yml\u003c/code\u003e，新增\u003ccode\u003etimeout\u003c/code\u003e配置，调大超时时间解决。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebuildDrafts: false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebuildFuture: false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebuildExpired: false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etimeout: 60s // 调大此处的时间即可\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e终于知道为啥\u003ccode\u003ePagerMod\u003c/code\u003e主题默认只有封面下才有生成不同规格的逻辑了。\u003c/p\u003e\n","date_published":"2023-12-10T08:29:05+08:00","tags":["hugo","博客优化"]},{"title":"加速Google Analytics","id":"https://liudon.com/posts/optimize-google-analytics/","url":"https://liudon.com/posts/optimize-google-analytics/","summary":"\u003ch3 id=\"起因\"\u003e起因\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eGoogle Analytics\u003c/code\u003e是一款优秀的流量分析服务，集成方便，使用简单。\u003c/p\u003e\n\u003cp\u003e最近在优化页面访问速度，发现\u003ccode\u003eGoogle Analytics\u003c/code\u003e是一个优化点。\u003c/p\u003e\n\u003ch3 id=\"优化\"\u003e优化\u003c/h3\u003e\n\u003ch4 id=\"1-访问加速\"\u003e1. 访问加速\u003c/h4\u003e\n\u003cp\u003e国内访问\u003ccode\u003eGoogle Analytics\u003c/code\u003e很慢，同时还面临着各种广告屏蔽插件拦截。\u003c/p\u003e","content_html":"\u003ch3 id=\"起因\"\u003e起因\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eGoogle Analytics\u003c/code\u003e是一款优秀的流量分析服务，集成方便，使用简单。\u003c/p\u003e\n\u003cp\u003e最近在优化页面访问速度，发现\u003ccode\u003eGoogle Analytics\u003c/code\u003e是一个优化点。\u003c/p\u003e\n\u003ch3 id=\"优化\"\u003e优化\u003c/h3\u003e\n\u003ch4 id=\"1-访问加速\"\u003e1. 访问加速\u003c/h4\u003e\n\u003cp\u003e国内访问\u003ccode\u003eGoogle Analytics\u003c/code\u003e很慢，同时还面临着各种广告屏蔽插件拦截。\u003c/p\u003e\n\u003cp\u003e这里借助\u003ccode\u003eCloudflare Worker\u003c/code\u003e实现\u003ccode\u003eGoogle Analytics\u003c/code\u003e反代，同时更换采集路由规避广告屏蔽插件的拦截。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eCloudflare\u003c/code\u003e新建Worker，代码如下，保存后部署。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaddEventListener(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;fetch\u0026#39;\u003c/span\u003e, (event) \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e这里可以加\u003c/span\u003e filter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e event\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erespondWith(handleRequest(event));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  });\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e worker \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e应用的路由地址，末尾不加\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，改为你的博客地址\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e DOMAIN \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;xxx.com\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e博客插入的\u003c/span\u003ejs地址文件名\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，可自定义\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e JS_FILE \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ga.js\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e响应上报的接口路径，可自定义，规避广告屏蔽插件拦截\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e COLLECT_PATH \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;collect_path\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e原\u003c/span\u003e gtag \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e地址，将\u003c/span\u003eG\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eXXX改为你的id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e JS_URL \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;https://www.googletagmanager.com/gtag/js?id=G-XXX\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e下面不需要改\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e G_DOMAIN \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;google-analytics.com\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e G_COLLECT_PATH \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;g\\/collect\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  async function handleRequest(event) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e event\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erequest\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eurl;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (url\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ematch(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{DOMAIN}\u003cspan style=\"color:#f92672\"\u003e/$\u003c/span\u003e{JS_FILE}\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e requestJs \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e await (await fetch(JS_URL))\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etext();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e jsText \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e requestJs\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplaceAll(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ewww\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplaceAll(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;.\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e G_DOMAIN, DOMAIN)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplaceAll(G_COLLECT_PATH, COLLECT_PATH);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e new Response(jsText, {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        status: \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        statusText: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;OK\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        headers: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Content-Type\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;application/javascript\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      });\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (url\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ematch(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{DOMAIN}\u003cspan style=\"color:#f92672\"\u003e/$\u003c/span\u003e{COLLECT_PATH}\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e newReq \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e await readRequest(event\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erequest);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        event\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ewaitUntil(fetch(newReq));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e new Response(null, {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      status: \u003cspan style=\"color:#ae81ff\"\u003e204\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      statusText: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;No Content\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    });\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  async function readRequest(request) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e { url, headers } \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e request;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e body \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e await request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etext();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e ga_url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e url\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{DOMAIN}\u003cspan style=\"color:#f92672\"\u003e/$\u003c/span\u003e{COLLECT_PATH}\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003ewww\u003cspan style=\"color:#f92672\"\u003e.$\u003c/span\u003e{G_DOMAIN}\u003cspan style=\"color:#f92672\"\u003e/$\u003c/span\u003e{G_COLLECT_PATH}\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e nq \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      method: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      headers: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Host: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;www.google-analytics.com\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Origin: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;origin\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Cache-Control\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;max-age=0\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;User-Agent\u0026#39;\u003c/span\u003e: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;user-agent\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Accept: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;accept\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Accept-Language\u0026#39;\u003c/span\u003e: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;accept-language\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Content-Type\u0026#39;\u003c/span\u003e: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;content-type\u0026#39;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;text/plain\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Referer: headers\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;referer\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      body: body,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    };\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e new Request(ga_url, nq);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e页面插入对应js\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;!-- Google tag (gtag.js) --\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;script async src=\u0026#34;https://xxx.com/ga.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; // 对应worker里的DOMAIN 和 JS_FILE，需要保持一致\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;script\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  window.dataLayer = window.dataLayer || [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  function gtag(){dataLayer.push(arguments);}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  gtag(\u0026#39;js\u0026#39;, new Date());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  gtag(\u0026#39;config\u0026#39;, \u0026#39;G-XXX\u0026#39;); // 将G-XXX改为你的id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;/script\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"2-文件瘦身\"\u003e2. 文件瘦身\u003c/h4\u003e\n\u003cp\u003e通过\u003ca href=\"https://gtmetrix.com/\"\u003e性能分析\u003c/a\u003e，发现js文件过大，影响页面加载速度。\u003c/p\u003e\n\u003cp\u003e虽然使用了\u003ccode\u003eCloudfare\u003c/code\u003e代理，但是\u003ccode\u003eGoogle Analytics\u003c/code\u003e原始的js文件为80KB左右。\u003c/p\u003e\n\u003cp\u003e搜索一番，找到一个\u003ca href=\"https://minimalanalytics.com/\"\u003e瘦身版Google Analytics\u003c/a\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMinimal Google Analytics Snippet\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eA simple snippet for tracking page views on your website without having to add external libraries. Also works for single page applications made with the likes of react and vue.js.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBefore\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGoogle Tag Manager + Analytics = 73kB\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSnippet = 1.5kB\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e插入的js片断，只有1.5kb大小。\u003c/p\u003e\n\u003cp\u003e唯一的缺点就是只有基本功能，这对于我们来说足够了。\u003c/p\u003e\n\u003cp\u003e将第一步插入的js代码，更换为下述代码，需要将其中的xxx.com/collect_path改为第一步定义的DOMAIN和COLLECT_PATH变量值。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003escript\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eenScroll\u003cspan style=\"color:#f92672\"\u003e=!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,enFdl\u003cspan style=\"color:#f92672\"\u003e=!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,extCurrent\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,filename\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,targetText\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,splitOrigin\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e lStor\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003elocalStorage,sStor\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esessionStorage,doc\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edocument,docEl\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edocument\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edocumentElement,docBody\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edocument\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebody,docLoc\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edocument\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elocation,w\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ewindow,s\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003escreen,nav\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enavigator\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e{},extensions\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pdf\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;xls\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;xlsx\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;doc\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;docx\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;txt\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rtf\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;csv\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;exe\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;key\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pps\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ppt\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pptx\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;7z\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pkg\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rar\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gz\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;zip\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;avi\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;mov\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;mp4\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;mpe\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;mpeg\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;wmv\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;mid\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;midi\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;mp3\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;wav\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;wma\u0026#34;\u003c/span\u003e];function a(e,t,n,o){\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e j\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;G-G9ZDJQN9E2\u0026#34;\u003c/span\u003e,r\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003eMath\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efloor(Math\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erandom()\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1e9\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,c\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003eMath\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efloor(Date\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003enow()\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1e3\u003c/span\u003e),F\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e(sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_p\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e(sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_p\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003er()),sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_p),E\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003er()\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;.\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003ec(),_\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e(lStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecid_v4\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e(lStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecid_v4\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eE()),lStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecid_v4),m\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003elStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egetItem(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cid_v4\u0026#34;\u003c/span\u003e),v\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003em\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e:enScroll\u003cspan style=\"color:#f92672\"\u003e==!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e,p\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e(sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esid\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e(sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esid\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ec()),sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esid),O\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e{\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003esStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_ss)\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_ss\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e,sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_ss;\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egetItem(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_ss\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e void \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e},a\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e,g\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e{\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esct)\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(enScroll\u003cspan style=\"color:#f92672\"\u003e==!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e)\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esct;\u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e x\u003cspan style=\"color:#f92672\"\u003e=+\u003c/span\u003esStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egetItem(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sct\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003ea,sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esct\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ex;\u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esct\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ea;\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e sStor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esct},i\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edocLoc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esearch,b\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enew URLSearchParams(i),h\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;q\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;s\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;search\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;query\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;keyword\u0026#34;\u003c/span\u003e],y\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eh\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esome(e\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003ei\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eincludes(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026amp;\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003ee\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;=\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003ei\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eincludes(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;?\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003ee\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;=\u0026#34;\u003c/span\u003e)),u\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003ey\u003cspan style=\"color:#f92672\"\u003e==!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;view_search_results\u0026#34;\u003c/span\u003e:enScroll\u003cspan style=\"color:#f92672\"\u003e==!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;scroll\u0026#34;\u003c/span\u003e:enFdl\u003cspan style=\"color:#f92672\"\u003e==!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;file_download\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;page_view\u0026#34;\u003c/span\u003e,f\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003eenScroll\u003cspan style=\"color:#f92672\"\u003e==!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;90\u0026#34;\u003c/span\u003e:void \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,C\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e()\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e{\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(u()\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;view_search_results\u0026#34;\u003c/span\u003e){\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e(let e of b)\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(h\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eincludes(e[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]))\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e e[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e]}\u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e void \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e},d\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eencodeURIComponent,k\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ee\u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e{let t\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[];\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e(let n \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e e)e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehasOwnProperty(n)\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003ee[n]\u003cspan style=\"color:#f92672\"\u003e!==\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003et\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epush(d(n)\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;=\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003ed(e[n]));\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e t\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejoin(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026amp;\u0026#34;\u003c/span\u003e)},A\u003cspan style=\"color:#f92672\"\u003e=!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,S\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://xxx.com/collect_path\u0026#34;\u003c/span\u003e,M\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ek({v:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e,tid:j,_p:F(),sr:(s\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ewidth\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003ew\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edevicePixelRatio\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003es\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eheight\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003ew\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edevicePixelRatio)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etoString(),ul:(nav\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elanguage\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etoLowerCase(),cid:_(),_fv:v(),_s:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e,dl:docLoc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eorigin\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003edocLoc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epathname\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003ei,dt:doc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etitle\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,dr:doc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereferrer\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,sid:p(),sct:g(),seg:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e,en:u(),\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;epn.percent_scrolled\u0026#34;\u003c/span\u003e:f(),\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ep.search_term\u0026#34;\u003c/span\u003e:C(),\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ep.file_extension\u0026#34;\u003c/span\u003e:e\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ep.file_name\u0026#34;\u003c/span\u003e:t\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ep.link_text\u0026#34;\u003c/span\u003e:n\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ep.link_url\u0026#34;\u003c/span\u003e:o\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003evoid \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,_ss:O(),_dbg:A\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e:void \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e}),l\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eS\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;?\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003eM;\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(nav\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esendBeacon)nav\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esendBeacon(l);\u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e{let e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enew XMLHttpRequest;e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eopen(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;POST\u0026#34;\u003c/span\u003e,l,\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e)}}a();function sPr(){\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e(docEl\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003escrollTop\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003edocBody\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003escrollTop)\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e((docEl\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003escrollHeight\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003edocBody\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003escrollHeight)\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003edocEl\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eclientHeight)\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e}doc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eaddEventListener(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;scroll\u0026#34;\u003c/span\u003e,sEv,{passive:\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e});function sEv(){\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esPr();\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e90\u003c/span\u003e)\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;enScroll\u003cspan style=\"color:#f92672\"\u003e=!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,a(),doc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eremoveEventListener(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;scroll\u0026#34;\u003c/span\u003e,sEv,{passive:\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e}),enScroll\u003cspan style=\"color:#f92672\"\u003e=!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e}document\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eaddEventListener(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DOMContentLoaded\u0026#34;\u003c/span\u003e,function(){let e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edocument\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egetElementsByTagName(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;a\u0026#34;\u003c/span\u003e);\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e(let t\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;t\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ee\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elength;t\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e)\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e(e[t]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egetAttribute(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;href\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003enull){\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e n\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ee[t]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egetAttribute(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;href\u0026#34;\u003c/span\u003e),s\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003en\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esubstring(n\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elastIndexOf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e),o\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003es\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;.\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epop();(e[t]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehasAttribute(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;download\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003eextensions\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eincludes(o))\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003ee[t]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eaddEventListener(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;click\u0026#34;\u003c/span\u003e,fDl,{passive:\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e})}});function fDl(e){enFdl\u003cspan style=\"color:#f92672\"\u003e=!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e t\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ee\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecurrentTarget\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egetAttribute(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;href\u0026#34;\u003c/span\u003e),n\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003et\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esubstring(t\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elastIndexOf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e),s\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003en\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;.\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epop(),o\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003en\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;.\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003es,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e),i\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ee\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecurrentTarget\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etext,r\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003et\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(docLoc\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eorigin,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e);a(s,o,i,r),enFdl\u003cspan style=\"color:#f92672\"\u003e=!\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003escript\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"效果\"\u003e效果\u003c/h4\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/optimize-google-analytics/gtmetrix-report.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/optimize-google-analytics/gtmetrix-report.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"gtmetrix-report.png\" width=\"1080\" height=\"383\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2023-12-02T09:25:49+08:00","tags":["google analytics","cloudflare","博客优化"]},{"title":"使用Google Indexing API加速博客收录","id":"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/","url":"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/","summary":"\u003cp\u003e对于一个新站点来说，总是想着能让搜索引擎快点收录网站内容。\u003c/p\u003e\n\u003cp\u003e今天，我们就来介绍一种利用\u003ccode\u003eGoogle Indexing API\u003c/code\u003e接口，通过\u003ccode\u003eGithub Actions\u003c/code\u003e实现部署时通知\u003ccode\u003eGoogle\u003c/code\u003e抓取页面内容。\u003c/p\u003e","content_html":"\u003cp\u003e对于一个新站点来说，总是想着能让搜索引擎快点收录网站内容。\u003c/p\u003e\n\u003cp\u003e今天，我们就来介绍一种利用\u003ccode\u003eGoogle Indexing API\u003c/code\u003e接口，通过\u003ccode\u003eGithub Actions\u003c/code\u003e实现部署时通知\u003ccode\u003eGoogle\u003c/code\u003e抓取页面内容。\u003c/p\u003e\n\u003cp\u003e操作步骤：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e申请\u003ccode\u003eGoogle API\u003c/code\u003e凭证\u003c/p\u003e\n\u003cp\u003e访问\u003ca href=\"https://console.cloud.google.com/\"\u003eGoogle Cloud控制台\u003c/a\u003e，如果没有项目，点击选择项目，然后新建项目。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/20231027193906.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/20231027193906.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231027193906.png\" width=\"1080\" height=\"468\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e选择对应项目，点击\u003ccode\u003eIAM和管理\u003c/code\u003e标签，点击\u003ccode\u003e服务帐号\u003c/code\u003e，选择新建服务帐号。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/20231027194257.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/20231027194257.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231027194257.png\" width=\"670\" height=\"581\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e服务帐号名称：自己起个名字即可\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e服务帐号id：不需要修改，自动生成\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e服务角色：Owner\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e填写相关信息后，点击完成创建好服务帐号。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/20231027194753.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/20231027194753.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231027194753.png\" width=\"1080\" height=\"276\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e创建完，默认是没有密钥的，记住账号的邮箱地址，后面要用到。\u003c/p\u003e\n\u003cp\u003e点击后面的三个点按钮，选择管理密钥。\u003c/p\u003e\n\u003cp\u003e点击添加密钥-\u0026gt;新建密钥，选择\u003ccode\u003eJSON\u003c/code\u003e格式，点击创建会下载一个文件，这里后面会用到。\u003c/p\u003e\n\u003cp\u003e回到首页，点击\u003ccode\u003eAPI和服务\u003c/code\u003e，点击\u003ccode\u003e启用API和服务\u003c/code\u003e，搜索框输入\u003ccode\u003eIndexing\u003c/code\u003e，选择\u003ccode\u003eWeb Search Indexing API\u003c/code\u003e，点击启用即可。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e将服务账号关联到\u003ccode\u003eGoogle Search Console\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e进入\u003ca href=\"https://search.google.com/\"\u003eGoogle Search Console控制台\u003c/a\u003e，选择你的网站。\u003c/p\u003e\n\u003cp\u003e找到设置里的用户和权限，点击添加用户。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/202310280923031.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/202310280923031.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202310280923031.png\" width=\"1080\" height=\"492\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e邮箱地址：填写第一步分配的邮箱地址\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e权限：选择拥有者\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e配置\u003ccode\u003eGithub Action\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e添加\u003ccode\u003eSecret\u003c/code\u003e变量，变量key为\u003ccode\u003eGOOGLE_INDEXING_API_TOKEN\u003c/code\u003e，值为前面下载文件的内容。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e编辑\u003ccode\u003eworkflow\u003c/code\u003e编排任务，新增步骤\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: easyindex\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;${{ secrets.GOOGLE_INDEXING_API_TOKEN }}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003ecredentials\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejson\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      touch \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eurl\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecsv\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003enotification_type\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eurl\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecsv \u003cspan style=\"color:#75715e\"\u003e# Headers line\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eURL_UPDATED\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ehttps://liudon.com/\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eurl\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecsv \u003cspan style=\"color:#75715e\"\u003e# ADD URL 这里改为你的博客首页\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eURL_UPDATED\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ehttps://liudon.com/sitemap.xml\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eurl\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecsv \u003cspan style=\"color:#75715e\"\u003e# ADD URL 这里改为你的sitemap地址\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      curl \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003es \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eL https:\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003egithub\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecom\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eusk81\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eeasyindex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecli\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ereleases\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003edownload\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ev1\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.6\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eeasyindex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecli_1\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.6\u003c/span\u003e_linux_amd64\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etar\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egz \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e tar xz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      chmod \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003ex \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eeasyindex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecli\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eeasyindex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecli google \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ed \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ec \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eurl\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecsv\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/20231027200238.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-use-google-indexing-api-to-speed-up-blog-indexing/20231027200238.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231027200238.png\" width=\"444\" height=\"212\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n","date_published":"2023-10-27T19:32:24+08:00","tags":["google","github","hugo"]},{"title":"在Netlify上部署Twikoo评论系统","id":"https://liudon.com/posts/deploy-twikoo-on-netlify/","url":"https://liudon.com/posts/deploy-twikoo-on-netlify/","summary":"\u003cblockquote\u003e\n\u003cp\u003e在本篇文章里，我会介绍如何在Netlify上部署Twikoo评论系统，如何接入到静态博客Hugo，以及如何实现Twikoo系统版本自动更新。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cem\u003e2024年7月30日更新：因为\u003ca href=\"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\u003eGithub接口策略调整\u003c/a\u003e，原有的匿名通过接口获取版本号方法失效，已更改为带token方式请求接口获取版本号，详见workflow里Get twikoo version步骤配置。\u003c/em\u003e\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003e在本篇文章里，我会介绍如何在Netlify上部署Twikoo评论系统，如何接入到静态博客Hugo，以及如何实现Twikoo系统版本自动更新。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cem\u003e2024年7月30日更新：因为\u003ca href=\"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\u003eGithub接口策略调整\u003c/a\u003e，原有的匿名通过接口获取版本号方法失效，已更改为带token方式请求接口获取版本号，详见workflow里Get twikoo version步骤配置。\u003c/em\u003e\u003c/p\u003e\n\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e博客之前通过\u003ccode\u003eVercel\u003c/code\u003e部署了\u003ccode\u003eTwikoo\u003c/code\u003e评论系统，但是最近发现加载很慢。\u003c/p\u003e\n\u003cp\u003e看\u003ca href=\"https://twikoo.js.org/backend.html\"\u003eTwikoo官网文档\u003c/a\u003e，\u003ccode\u003eNetlify\u003c/code\u003e比\u003ccode\u003eVercel\u003c/code\u003e国内访问会更优一些，于是搞了一把迁移。\u003c/p\u003e\n\u003cp\u003e迁移过程中遇到了一些问题，网上搜了一番，发现\u003ccode\u003eNetlify\u003c/code\u003e下部署\u003ccode\u003eTwikoo\u003c/code\u003e的信息很少，这篇文章我会介绍整个操作过程。\u003c/p\u003e\n\u003ch4 id=\"部署\"\u003e部署\u003c/h4\u003e\n\u003cp\u003e参考\u003ca href=\"https://twikoo.js.org/backend.html#netlify-%E9%83%A8%E7%BD%B2\"\u003e官网文档\u003c/a\u003e，部署即可。\u003c/p\u003e\n\u003cp\u003e这里一开始Fork成了\u003ccode\u003ehttps://github.com/twikoojs/twikoo\u003c/code\u003e，导致部署后访问404。\u003c/p\u003e\n\u003cp\u003e注意，正确的仓库是\u003ccode\u003ehttps://github.com/twikoojs/twikoo-netlify\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/netlify-3.4f565e5d.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/netlify-3.4f565e5d.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"netlify-3.4f565e5d.png\" width=\"1080\" height=\"520\" alt=\"Netlify部署Twikoo\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e使用同一个\u003ccode\u003eMongoDB\u003c/code\u003e，配置原来的地址，这样已有的评论也不会丢。\u003c/p\u003e\n\u003cp\u003e部署后，通过\u003ccode\u003ehttps://comment.liudon.com\u003c/code\u003e访问，返回200。\u003c/p\u003e\n\u003cp\u003e但是访问\u003ccode\u003ehttps://liudon.com\u003c/code\u003e，提示\u003ccode\u003eCORS跨域错误\u003c/code\u003e，搜索一番网上资料也没找到相关信息。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019190935.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019190935.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231019190935.png\" width=\"1080\" height=\"309\" alt=\"CORS报错\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e一般跨域错误都是返回头里缺少跨域相关的字段导致，因此决定使用\u003ccode\u003eNetlify\u003c/code\u003e来新增返回头规避。\u003c/p\u003e\n\u003cp\u003e仓库下新增\u003ccode\u003enetlify.toml\u003c/code\u003e文件，针对根目录返回跨域头，内容如下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[[headers]]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  # Define which paths this specific [[headers]] block will cover.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  for = \u0026#34;/\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    [headers.values]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Access-Control-Allow-Origin = \u0026#34;*\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Access-Control-Allow-Headers = \u0026#34;Content-Type\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Access-Control-Allow-Methods = \u0026#34;*\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e再次刷新页面，报错又变成了404，但是直接访问\u003ccode\u003ehttps://comment.liudon.com\u003c/code\u003e地址是返回的200。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019191326.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019191326.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231019191326.png\" width=\"1080\" height=\"263\" alt=\"404报错\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e经过一番定位，发现了问题所在：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003etwikoo-netlify\u003c/code\u003e库根目录地址是通过\u003ccode\u003eLocation\u003c/code\u003e跳转到的\u003ccode\u003e/.netlify/functions/twikoo\u003c/code\u003e接口，\u003ccode\u003e/.netlify/functions/twikoo\u003c/code\u003e才是真正处理的接口。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019191522.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019191522.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231019191522.png\" width=\"1080\" height=\"284\" alt=\"twikoo-netlify根目录返回\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e而\u003ccode\u003evercel-netlify\u003c/code\u003e库是通过rewrite将所有请求转发到了\u003ccode\u003e/api/index\u003c/code\u003e接口。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019191833.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019191833.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231019191833.png\" width=\"1012\" height=\"442\" alt=\"twikoo-vercel转发\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e博客里写的\u003ccode\u003eTwikoo\u003c/code\u003e环境id填的是\u003ccode\u003ehttps://comment.liudon.com\u003c/code\u003e，更换为\u003ccode\u003eNetlify\u003c/code\u003e后，需要更换环境id，补齐后面的\u003ccode\u003e/.netlify/functions/twikoo\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019192158.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-twikoo-on-netlify/20231019192158.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231019192158.png\" width=\"663\" height=\"137\" alt=\"twikoo环境id\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e因为\u003ccode\u003eNetlify\u003c/code\u003e也支持\u003ccode\u003eRewrite\u003c/code\u003e转发，所以决定还是通过\u003ccode\u003enetlify.toml\u003c/code\u003e文件增加转发配置解决，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[[redirects]]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  from = \u0026#34;/\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  to = \u0026#34;/.netlify/functions/twikoo\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  status = 200\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  force = true\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e注意一定不要漏了\u003ccode\u003eforce\u003c/code\u003e参数，因为根目录文件是存在的，不带这个参数的话\u003ccode\u003eRewrite\u003c/code\u003e是不生效的，必须指定这个。\u003c/p\u003e\n\u003cp\u003e这下访问彻底ok了。\u003c/p\u003e\n\u003cp\u003e不过很快又发现另外一个问题，看到别人博客上\u003ccode\u003eTwikoo\u003c/code\u003e版本已经是\u003ccode\u003e1.6.22\u003c/code\u003e，自己的还是\u003ccode\u003e1.5.11\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e搜索一番后，\u003ccode\u003eTwikoo\u003c/code\u003e已经给出了更新操作:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e针对 Netlify 部署的更新方式\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e1. 登录 Github，找到部署时 fork 到自己账号下的名为 twikoo-netlify 的仓库\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2. 打开 package.json，点击编辑\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e3. 将 \u0026#34;twikoo-vercel\u0026#34;: \u0026#34;latest\u0026#34; 其中的 latest 修改为最新版本号。点击 Commit changes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e4. 部署会自动触发\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e不过这样操作，每次版本更新，都需要手动去改一下\u003ccode\u003epackage.json\u003c/code\u003e文件的版本，重新构建。\u003c/p\u003e\n\u003cp\u003e对于一个程序员，我们的追求就是自动化。\u003c/p\u003e\n\u003ch4 id=\"自动版本更新\"\u003e自动版本更新\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e服务端版本自动更新\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e这里利用\u003ccode\u003eGithub Actions\u003c/code\u003e定时任务，通过接口拉取\u003ca href=\"https://github.com/twikoojs/twikoo/releases\"\u003etwikoo\u003c/a\u003e最新的版本，然后更新到\u003ccode\u003epackage.json\u003c/code\u003e文件，从而实现版本自动更新。\u003c/p\u003e\n\u003cp\u003e在自己\u003ccode\u003etwikoo-netlify\u003c/code\u003e仓库下，新增\u003ccode\u003eActions\u003c/code\u003e，代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# This is a basic workflow to help you get started with Actions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ename: CI\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# Controls when the workflow will run\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eon:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  # Triggers the workflow on push or pull request events but only for the \u0026#34;main\u0026#34; branch\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  push:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    branches: [ \u0026#34;main\u0026#34; ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  pull_request:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    branches: [ \u0026#34;main\u0026#34; ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  # Allows you to run this workflow manually from the Actions tab\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  workflow_dispatch:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  schedule:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - cron: \u0026#39;0 2 * * *\u0026#39; # 每天定时2点执行一次\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# A workflow run is made up of one or more jobs that can run sequentially or in parallel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejobs:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  # This workflow contains a single job called \u0026#34;build\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  build:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    # The type of runner that the job will run on\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    runs-on: ubuntu-latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    permissions:      \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      contents: write\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    # Steps represent a sequence of tasks that will be executed as part of the job\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    steps:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - uses: actions/checkout@v3\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      # Runs a single command using the runners shell\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - name: update version\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        env:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          github_token: ${{ secrets.TOKEN }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        run: |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          response=$(curl -sf -H \u0026#34;Authorization: token $github_token\u0026#34; -H \u0026#34;Accept: application/vnd.github+json\u0026#34; https://api.github.com/repos/twikoojs/twikoo/releases/latest)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          version=$(echo $response | jq -r \u0026#39;.tag_name\u0026#39;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          if [ -n \u0026#34;$version\u0026#34; ]; then\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            sed -i \u0026#34;s/\\\u0026#34;twikoo-netlify\\\u0026#34;: \\\u0026#34;.*\\\u0026#34;/\\\u0026#34;twikoo-netlify\\\u0026#34;: \\\u0026#34;$version\\\u0026#34;/\u0026#34; package.json\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          fi\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        shell: bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      # Runs a set of commands using the runners shell\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - name: Commit changes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        uses: EndBug/add-and-commit@v9\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        env:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          github_token: ${{ secrets.TOKEN }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          add: .\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里会把修改后的\u003ccode\u003epackage.json\u003c/code\u003e文件提交到仓库，所以需要申请一个\u003ccode\u003eToken\u003c/code\u003e，可以参考我上一篇\u003ca href=\"https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/\"\u003e文章\u003c/a\u003e申请，然后添加到仓库变量里。\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e博客引用版本自动更新\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e这里一开始想到在前端去查服务端最新版本号，然后引用对应版本的js文件来实现。\u003c/p\u003e\n\u003cp\u003e但是这样就会导致每次页面加载都要去查一次版本，会导致加载时间变长。\u003c/p\u003e\n\u003cp\u003e因此还是决定在服务端部署时，获取最新版本号更新服务。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e引用版本配置化\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003ecomments.html\u003c/code\u003e文件修改：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;script src=\u0026#34;https://cdn.staticfile.org/twikoo/{{ .Site.Params.twikoo.version }}/twikoo.all.min.js\u0026#34;\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003econfig.tml\u003c/code\u003e配置修改：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eparams:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  env: production # to enable google analytics, opengraph, twitter-cards and schema.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ... # 其他配置\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  assets:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    disableHLJS: true # to disable highlight.js\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  twikoo:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    version: 1.5.11 # 配置twikoo版本号\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e获取最新版本号部署\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003eActions\u003c/code\u003e新增步骤：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - name: Setup Hugo\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uses: peaceiris/actions-hugo@v2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    with:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        hugo-version: \u0026#39;latest\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ####\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - name: Get twikoo version\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    id: twikoo\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        version=$(curl -s https://raw.githubusercontent.com/Liudon/twikoo-netlify/main/package.json | jq -r \u0026#39;.dependencies.\u0026#34;twikoo-netlify\u0026#34;\u0026#39;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        echo \u0026#34;Twikoo version: $version\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        echo \u0026#34;twikoo_version=$version\u0026#34; \u0026gt;\u0026gt; $GITHUB_OUTPUT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - name: Update config.yml version\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uses: fjogeleit/yaml-update-action@main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    with:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        valueFile: \u0026#39;config.yml\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        propertyPath: \u0026#39;params.twikoo.version\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        value: ${{ steps.twikoo.outputs.twikoo_version }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        commitChange: true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ####\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - name: Build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: hugo --gc --minify --cleanDestinationDir \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003e####\u003c/code\u003e内代码即为获取版本号，更新\u003ccode\u003econfig.tml\u003c/code\u003e版本号逻辑，然后再进行\u003ccode\u003ehugo\u003c/code\u003e部署。\u003c/p\u003e\n\u003cp\u003e需要将\u003ccode\u003ehttps://raw.githubusercontent.com/Liudon/twikoo-netlify/main/package.json\u003c/code\u003e这个url里的\u003ccode\u003eLiudon/twikoo-netlify\u003c/code\u003e改为你的仓库名。\u003c/p\u003e\n\u003cp\u003e这下后面\u003ccode\u003eTwikoo\u003c/code\u003e官方更新版本，博客的\u003ccode\u003eTwikoo\u003c/code\u003e也会跟着自动更新。\u003c/p\u003e\n","date_published":"2023-10-19T19:46:32+08:00","tags":["netlify","twikoo","github","vercel","hugo"]},{"title":"利用Github Actions定时抓取微博","id":"https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/","url":"https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/","summary":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e在微博上关注了一些用户，比如\u003ca href=\"https://weibo.com/u/1401527553\"\u003etk教主\u003c/a\u003e，\u003ca href=\"https://weibo.com/u/1670659923\"\u003e月风\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e但是有些内容过段时间不可见了，所以希望可以定时抓取微博归档备份下来。\u003c/p\u003e\n\u003ch4 id=\"实现方案\"\u003e实现方案\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e整体思路：利用\u003ccode\u003eGithub Actions\u003c/code\u003e的\u003ccode\u003eScheduled\u003c/code\u003e任务，定时执行抓取shell脚本，将内容保存到文件，提交到Github仓库。\u003c/strong\u003e\u003c/p\u003e","content_html":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e在微博上关注了一些用户，比如\u003ca href=\"https://weibo.com/u/1401527553\"\u003etk教主\u003c/a\u003e，\u003ca href=\"https://weibo.com/u/1670659923\"\u003e月风\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e但是有些内容过段时间不可见了，所以希望可以定时抓取微博归档备份下来。\u003c/p\u003e\n\u003ch4 id=\"实现方案\"\u003e实现方案\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e整体思路：利用\u003ccode\u003eGithub Actions\u003c/code\u003e的\u003ccode\u003eScheduled\u003c/code\u003e任务，定时执行抓取shell脚本，将内容保存到文件，提交到Github仓库。\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e新建仓库，比如\u003ccode\u003eweibo_archive\u003c/code\u003e。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e添加抓取脚本，\u003ca href=\"https://github.com/Liudon/weibo_archive/blob/main/weibo_archive.sh\"\u003e完整代码\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e这里用到微博两个接口：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// 抓取某个用户最新的10条微博数据，返回里有每条微博的id，这里如果内容过长的话会被截断\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehttps://m.weibo.cn/api/container/getIndex?jumpfrom=weibocom\u0026amp;type=uid\u0026amp;value=$uid\u0026amp;containerid=107603$uid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// 根据微博id，抓取微博完整的内容\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehttps://m.weibo.cn/statuses/extend?id=$id\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e添加环境变量。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e进入\u003ccode\u003e个人设置\u003c/code\u003e-\u0026gt;\u003ccode\u003eDeveloper Settings\u003c/code\u003e-\u0026gt;\u003ccode\u003ePersonal access tokens\u003c/code\u003e-\u0026gt;\u003ccode\u003eTokens (classic)\u003c/code\u003e，创建新的Token，记下对应的值。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e进入第一步创建仓库的配置页，点击\u003ccode\u003eSecrets and variables\u003c/code\u003e下的\u003ccode\u003eActions\u003c/code\u003e：\u003c/p\u003e\n\u003cp\u003e切到\u003ccode\u003eSecret\u003c/code\u003e目录，创建新的\u003ccode\u003eSecret\u003c/code\u003e变量，名称为\u003ccode\u003eTOKEN\u003c/code\u003e，值为前一步记录的值；切到\u003ccode\u003eVariables\u003c/code\u003e目录，创建新的\u003ccode\u003eVariables\u003c/code\u003e变量，名称为\u003ccode\u003eWEIBO_UIDS\u003c/code\u003e，值为你需要抓取的微博用户id，多个用户的话以\u003ccode\u003e|\u003c/code\u003e分割。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e添加定时任务，完整yaml文件如下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# This is a basic workflow to help you get started with Actions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ename: CI\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Controls when the workflow will run\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eon:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Triggers the workflow on push or pull request events but only for the \u0026#34;main\u0026#34; branch\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epush:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    branches: [ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;main\u0026#34;\u003c/span\u003e ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epull_request:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    branches: [ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;main\u0026#34;\u003c/span\u003e ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Allows you to run this workflow manually from the Actions tab\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eworkflow_dispatch:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eschedule:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e cron: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*/5 * * * *\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# A workflow run is made up of one or more jobs that can run sequentially or in parallel\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejobs:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# This workflow contains a single job called \u0026#34;build\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebuild:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# The type of runner that the job will run on\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    runs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eon: ubuntu\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003elatest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    permissions:      \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    contents: write\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Steps represent a sequence of tasks that will be executed as part of the job\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    steps:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e uses: actions\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003echeckout\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ev3\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Runs a single command using the runners shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: archive weibo\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        run: \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        chmod \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003ex \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eweibo_archive\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003eweibo_archive\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        shell: bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        env:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        weibo_uids: \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{{ vars\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eweibo_uids }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Runs a set of commands using the runners shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Commit changes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        uses: EndBug\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eadd\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecommit\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ev9\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        env:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        github_token: \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{{ secrets\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTOKEN }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        add: \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"效果\"\u003e效果\u003c/h4\u003e\n\u003cp\u003e抓取后的内容，会按用户id分别保存到不同文件。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/20231007132025.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/using-github-actions-to-schedule-weibo-scraping/20231007132025.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20231007132025.png\" width=\"824\" height=\"207\" alt=\"效果\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e不过这个方案有一个唯一的缺点，\u003ccode\u003eGithub Actions\u003c/code\u003e定时任务时间粒度最小是5分钟，而且不能保证执行时间完全符合这个粒度，所以可能还是会有漏掉的内容。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote: The schedule event can be delayed during periods of high loads of GitHub Actions workflow runs. High load times include the start of every hour. If the load is sufficiently high enough, some queued jobs may be dropped. To decrease the chance of delay, schedule your workflow to run at a different time of the hour.\u003c/p\u003e\u003c/blockquote\u003e\n","date_published":"2023-10-07T13:17:57+08:00","tags":["github","weibo"]},{"title":"北大口腔牙周刮治记录","id":"https://liudon.com/posts/%E5%8C%97%E5%A4%A7%E5%8F%A3%E8%85%94%E7%89%99%E5%91%A8%E5%88%AE%E6%B2%BB%E8%AE%B0%E5%BD%95/","url":"https://liudon.com/posts/%E5%8C%97%E5%A4%A7%E5%8F%A3%E8%85%94%E7%89%99%E5%91%A8%E5%88%AE%E6%B2%BB%E8%AE%B0%E5%BD%95/","summary":"\u003ch4 id=\"病情\"\u003e病情\u003c/h4\u003e\n\u003cp\u003e上次洗完牙后，还是不时有出血的情况。\u003c/p\u003e\n\u003cp\u003e前段时间更是出现牙龈劈开一块肉，特别容易塞东西的情况。\u003c/p\u003e\n\u003cp\u003e于是，又跑到医院来看牙了。\u003c/p\u003e\n\u003cp\u003e医生检查后，说是牙周病，需要牙周刮治，要约到8月份了。\u003c/p\u003e","content_html":"\u003ch4 id=\"病情\"\u003e病情\u003c/h4\u003e\n\u003cp\u003e上次洗完牙后，还是不时有出血的情况。\u003c/p\u003e\n\u003cp\u003e前段时间更是出现牙龈劈开一块肉，特别容易塞东西的情况。\u003c/p\u003e\n\u003cp\u003e于是，又跑到医院来看牙了。\u003c/p\u003e\n\u003cp\u003e医生检查后，说是牙周病，需要牙周刮治，要约到8月份了。\u003c/p\u003e\n\u003cp\u003e回来查了下，牙周刮治还是挺痛苦的，想着找个专业医院看看再。\u003c/p\u003e\n\u003ch4 id=\"挂号\"\u003e挂号\u003c/h4\u003e\n\u003cp\u003e于是开始北大口腔挂号，中间挂了一次总院的普通号，但是网上好多说是规培生操作，又取消了。\u003c/p\u003e\n\u003cp\u003e找了农行的代挂号服务，北大口腔只能微信预约，他们也没渠道，只能自己挂了。\u003c/p\u003e\n\u003cp\u003e总院实在是挂不到，于是转战第一门诊部的号。\u003c/p\u003e\n\u003cp\u003e功夫不负有心人，7月5日总算挂上了牙周科李菲医生的号。\u003c/p\u003e\n\u003cp\u003e\n\n\n\u003c/p\u003e\n\u003ch4 id=\"治疗\"\u003e治疗\u003c/h4\u003e\n\u003cp\u003e7月7日，第一次看医生，刮治是没的跑了。\u003c/p\u003e\n\u003cp\u003e\n\n\n\u003c/p\u003e\n\u003cp\u003e做了牙齿探针，每个牙都要测一下，略疼。\u003c/p\u003e\n\u003cp\u003e开了治疗计划，刮治分两次，每次半口牙，总费用3000元左右。\u003c/p\u003e\n\u003cp\u003e第一次只洗牙，确实是专业，洗牙不到半个小时搞定。\u003c/p\u003e\n\u003cp\u003e最关键的，洗完后我刷牙确实很少再出血了。\u003c/p\u003e\n\u003cp\u003e8月3日，第一次刮治，只做了右半边。\u003c/p\u003e\n\u003cp\u003e医生说我这算是轻的，刮治比洗牙会疼一些，可以打麻药也可以不打。\u003c/p\u003e\n\u003cp\u003e行吧，那咱就不打麻药，来吧。\u003c/p\u003e\n\u003cp\u003e医生开始操作，感觉和洗牙是一样的，也是拿喷水的机器在牙上弄来弄去。\u003c/p\u003e\n\u003cp\u003e但是比洗牙更深一些，感觉是直接到牙龈下面了，确实要更疼一些。\u003c/p\u003e\n\u003cp\u003e洗完后，再拿一个铁丝一样的东西在牙上使劲刮来刮去。\u003c/p\u003e\n\u003cp\u003e自我感觉，还是前面洗牙更痛苦一些，后面刮来刮去没什么感觉。\u003c/p\u003e\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \u003cfigcaption\u003e\n            铁丝一样的工具，第二次刮治拍的\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003e半个小时搞定，本来我以为我这得一俩小时，医生说那得是非常严重的，你这属于轻的。\u003c/p\u003e\n\u003cp\u003e9月2日，第二次刮治，做了左半边。\u003c/p\u003e\n\u003cp\u003e左边牙龈问题更压重些，这次痛感更强烈一些。\u003c/p\u003e\n\u003cp\u003e同样也是半个小时搞定，1个月后再来复诊。\u003c/p\u003e\n\u003ch4 id=\"费用\"\u003e费用\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e洗牙：480元，单子找不到了，我记得是这个数。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e第一次刮治：1286元\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e第二次刮治：1176元\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e总费用2942元，基本都走了医保。\u003c/p\u003e\n","date_published":"2023-09-17T15:46:32+08:00","tags":[]},{"title":"故乡回忆之旅","id":"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/","url":"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/","summary":"\u003cp\u003e赶在8月底，趁着娃暑假的尾声，回了趟老家。\u003c/p\u003e\n\u003cp\u003e老家有条俗语，“永福庄的街，三里长”。\u003c/p\u003e\n\u003cp\u003e这天吃完午饭，临时起意，带媳妇溜溜大街，见识下我们的大街。\u003c/p\u003e\n\u003cp\u003e小时候，整天在这条街上跑来跑去。\u003c/p\u003e","content_html":"\u003cp\u003e赶在8月底，趁着娃暑假的尾声，回了趟老家。\u003c/p\u003e\n\u003cp\u003e老家有条俗语，“永福庄的街，三里长”。\u003c/p\u003e\n\u003cp\u003e这天吃完午饭，临时起意，带媳妇溜溜大街，见识下我们的大街。\u003c/p\u003e\n\u003cp\u003e小时候，整天在这条街上跑来跑去。\u003c/p\u003e\n\u003cp\u003e我们那巷子基本很少是堵头的，你可以穿到任意一个巷子，最后还能回到大街。\u003c/p\u003e\n\u003cp\u003e小时候的大街，感觉很宽很长。\u003c/p\u003e\n\u003cp\u003e现在大街都垫高了，大街也变的窄了许多。\u003c/p\u003e\n\u003cp\u003e大街上的人很少，好多店铺都关门了。\u003c/p\u003e\n\u003cp\u003e走在大街上，小时候的一幕幕映在眼前。\u003c/p\u003e\n\u003cp\u003e有的地方，已经拆了重盖；\u003c/p\u003e\n\u003cp\u003e有的地方，已经人去楼空。\u003c/p\u003e\n\u003cp\u003e\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092348210.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092348210.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092348210.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            爷爷待过的大队部\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092348324.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092348324.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092348324.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            以前的供销社\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e\n\u003cp\u003e\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092350308.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092350308.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092350308.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            老爷爷家\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092350619.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092350619.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092350619.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            姥爷以前的药铺\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309101306461.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309101306461.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309101306461.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            姥姥家\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e\n\u003cp\u003e\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309101307174.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309101307174.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309101307174.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            最早是肉食店，后来开过药铺\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309101308503.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309101308503.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309101308503.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            里面以前是个学校\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e\n\u003cp\u003e\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092349674.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092349674.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092349674.jpg#center\"width=\"1080\"height=\"1920\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            巷口的大饭店\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092349469.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092349469.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092349469.jpg#center\"width=\"1080\"height=\"1920\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            一栋风格怪异的楼\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092351506.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092351506.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092351506.jpg#center\"width=\"1080\"height=\"1920\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            巷子\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e\n\u003cp\u003e\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092352743.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092352743.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092352743.jpg#center\"width=\"1080\"height=\"1920\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            刘家祖庙\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092353811.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092353811.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092353811.jpg#center\"width=\"1080\"height=\"1920\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            赵家祖庙\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e\n\u003cp\u003e\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092352581.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309092352581.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309092352581.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            赵家祖庙\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\n\n\n\n\n\n\n\u003cfigure class=\"align-center \"\u003e\n    \n    \u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309101309020.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E6%95%85%E4%B9%A1%E5%9B%9E%E5%BF%86%E4%B9%8B%E6%97%85/202309101309020.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 720px, 100vw\" /\u003e\n        \u003cimg loading=\"lazy\" src=\"202309101309020.jpg#center\"width=\"1080\"height=\"607\"/\u003e \n    \u003c/picture\u003e\n    \u003cfigcaption\u003e\n            关帝庙\n        \u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e\n","date_published":"2023-09-09T23:19:03+08:00","tags":[]},{"title":"解决Golang使用go get安装包后找不到可执行文件的问题","id":"https://liudon.com/posts/golang-go-get-binary-not-found-solution/","url":"https://liudon.com/posts/golang-go-get-binary-not-found-solution/","summary":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e编译流水线代码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego get google.golang.org/protobuf/cmd/protoc-gen-go@latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc -I=./zzz --proto_path=./xx --go_out=./abc --go_opt=paths=xx.proto\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego build -o xxx\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在go升级到1.20.1版本后，执行报错。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc-gen-go: program not found or is not executable\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"解决\"\u003e解决\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003eStarting in Go 1.17, installing executables with go get is deprecated. go install may be used instead.\u003c/p\u003e\n\u003cp\u003eIn a future Go release, go get will no longer build packages; it will only be used to add, update, or remove dependencies in go.mod. Specifically, go get will act as if the -d flag were enabled.\u003c/p\u003e","content_html":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e编译流水线代码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego get google.golang.org/protobuf/cmd/protoc-gen-go@latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc -I=./zzz --proto_path=./xx --go_out=./abc --go_opt=paths=xx.proto\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego build -o xxx\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在go升级到1.20.1版本后，执行报错。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc-gen-go: program not found or is not executable\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"解决\"\u003e解决\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003eStarting in Go 1.17, installing executables with go get is deprecated. go install may be used instead.\u003c/p\u003e\n\u003cp\u003eIn a future Go release, go get will no longer build packages; it will only be used to add, update, or remove dependencies in go.mod. Specifically, go get will act as if the -d flag were enabled.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.studygolang.com/doc/go-get-install-deprecation\"\u003ehttps://docs.studygolang.com/doc/go-get-install-deprecation\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e从 Go 1.7 版本开始，go get 命令默认只会下载包，不会自动编译和安装可执行文件。\u003c/p\u003e\n\u003cp\u003e因此，如果你想要使用 go get 命令安装包并编译可执行文件，你需要使用 go install 命令。\u003c/p\u003e\n\u003cp\u003e替换为\u003ccode\u003ego install\u003c/code\u003e解决。\u003c/p\u003e\n","date_published":"2023-08-17T09:20:50+08:00","tags":["golang"]},{"title":"修正Hugo的JSON Feed格式","id":"https://liudon.com/posts/fix-hugo-json-feed/","url":"https://liudon.com/posts/fix-hugo-json-feed/","summary":"\u003ch4 id=\"问题背景\"\u003e问题背景\u003c/h4\u003e\n\u003cp\u003e前几天在\u003ca href=\"https://planetics.xyz/\"\u003ePlanet\u003c/a\u003e里follow自己的\u003ca href=\"https://liudon.eth\"\u003eweb3博客\u003c/a\u003e，遇到下面的错误。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/fix-hugo-json-feed/202303251415675.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/fix-hugo-json-feed/202303251415675.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202303251415675.png\" width=\"716\" height=\"544\" alt=\"PlanetFeedError\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e经过Livid大佬提醒，说是网站的JSON Feed不是标准格式导致的。\u003c/p\u003e\n\u003cp\u003e因为我的已经修正没法截图，这里以\u003ca href=\"https://dvel.me/index.json\"\u003edvel的博客\u003c/a\u003e举例，格式类似如下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;content\u0026#34;: \u0026#34;用 ChatGPT 写一些小脚本真是太方便了。\\nGPT-4 发布后试了试，还是蛮不错的，代码是 ChatGPT 生成的。\\n几个来回就可以编写一个能正常使用的油猴脚本：\\n（略，HTML 代码） 在 https://chdbits.co/bakatest.php 有如上内容。 我要为这个网页编写一个油猴脚本。 通过自动获取 ChatGPT 的 API 来解析此问题的答案，供用户参考。 将内容输出到 `#outer \u0026amp;gt; h1` 的下面，同时输出你提取到的问题内容和答案，以便我看看你是否提取正确。 获取错啦。 问题的获取路径是 `#outer \u0026amp;gt; form \u0026amp;gt; table \u0026amp;gt; tbody \u0026amp;gt; tr:nth-child(1) \u0026amp;gt; td` 选项的获取路径是 `#outer \u0026amp;gt; form \u0026amp;gt; table \u0026amp;gt; tbody \u0026amp;gt; tr:nth-child(2) \u0026amp;gt; td` 使用这个 API： ``` curl https://api.openai.com/v1/chat/completions \\\\ -H \u0026amp;#39;Content-Type: application/json\u0026amp;#39; \\\\ -H \u0026amp;#39;Authorization: Bearer YOUR_API_KEY\u0026amp;#39; \\\\ -d \u0026amp;#39;{ \u0026amp;#34;model\u0026amp;#34;: \u0026amp;#34;gpt-3.5-turbo\u0026amp;#34;, \u0026amp;#34;messages\u0026amp;#34;: [{\u0026amp;#34;role\u0026amp;#34;: \u0026amp;#34;user\u0026amp;#34;, \u0026amp;#34;content\u0026amp;#34;: \u0026amp;#34;Say this is a test!\u0026amp;#34;}], \u0026amp;#34;temperature\u0026amp;#34;: 0.7 }\u0026amp;#39; ``` 响应格式为： ``` { \u0026amp;#34;id\u0026amp;#34;:\u0026amp;#34;chatcmpl-abc123\u0026amp;#34;, \u0026amp;#34;object\u0026amp;#34;:\u0026amp;#34;chat.completion\u0026amp;#34;, \u0026amp;#34;created\u0026amp;#34;:1677858242, \u0026amp;#34;model\u0026amp;#34;:\u0026amp;#34;gpt-3.5-turbo-0301\u0026amp;#34;, \u0026amp;#34;usage\u0026amp;#34;:{ \u0026amp;#34;prompt_tokens\u0026amp;#34;:13, \u0026amp;#34;completion_tokens\u0026amp;#34;:7, \u0026amp;#34;total_tokens\u0026amp;#34;:20 }, \u0026amp;#34;choices\u0026amp;#34;:[ { \u0026amp;#34;message\u0026amp;#34;:{ \u0026amp;#34;role\u0026amp;#34;:\u0026amp;#34;assistant\u0026amp;#34;, \u0026amp;#34;content\u0026amp;#34;:\u0026amp;#34;\\\\n\\\\nThis is a test!\u0026amp;#34; }, \u0026amp;#34;finish_reason\u0026amp;#34;:\u0026amp;#34;stop\u0026amp;#34;, \u0026amp;#34;index\u0026amp;#34;:0 } ] } ``` 它没有最近的互联网数据，所以还是需要把 API 的使用方式发给它。\\n然后它就帮我写好了，我不用复习 JavaScript，不用看油猴脚本的教程和文档，也不用查 @grant 等等标记是干嘛的。\\n可以再继续要求它改进一些，比如换个输出位置，优化 prompt，自动选中正确回答，支持单选题和多选题等等。\\n效果展示：\\n安装： https://greasyfork.org/zh-CN/scripts/461944-chd-quiz-answer\\n\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;permalink\u0026#34;: \u0026#34;https://dvel.me/posts/chd-quiz-answer/\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;summary\u0026#34;: \u0026#34;用 ChatGPT 写一些小脚本真是太方便了。\\nGPT-4 发布后试了试，还是蛮不错的，代码是 ChatGPT 生成的。\\n几个来回就可以编写一个能正常使用的油猴脚本：\\n（略，HTML 代码） 在 https://chdbits.co/bakatest.php 有如上内容。 我要为这个网页编写一个油猴脚本。 通过自动获取 ChatGPT 的 API 来解析此问题的答案，供用户参考。 将内容输出到 `#outer \u0026amp;gt; h1` 的下面，同时输出你提取到的问题内容和答案，以便我看看你是否提取正确。 获取错啦。 问题的获取路径是 `#outer \u0026amp;gt; form \u0026amp;gt; table \u0026amp;gt; tbody \u0026amp;gt; tr:nth-child(1) \u0026amp;gt; td` 选项的获取路径是 `#outer \u0026amp;gt; form \u0026amp;gt; table \u0026amp;gt; tbody \u0026amp;gt; tr:nth-child(2) \u0026amp;gt; td` 使用这个 API： ``` curl https://api.openai.com/v1/chat/completions \\\\ -H \u0026amp;#39;Content-Type: application/json\u0026amp;#39; \\\\ -H \u0026amp;#39;Authorization: Bearer YOUR_API_KEY\u0026amp;#39; \\\\ -d \u0026amp;#39;{ \u0026amp;#34;model\u0026amp;#34;: \u0026amp;#34;gpt-3.5-turbo\u0026amp;#34;, \u0026amp;#34;messages\u0026amp;#34;: [{\u0026amp;#34;role\u0026amp;#34;: \u0026amp;#34;user\u0026amp;#34;, \u0026amp;#34;content\u0026amp;#34;: \u0026amp;#34;Say this is a test!\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;title\u0026#34;: \u0026#34;CHD 油猴脚本：每日签到自动答题\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e下面是一个\u003ccode\u003eJSON Feed\u003c/code\u003e的示例，详细规范见\u003ca href=\"https://www.jsonfeed.org/\"\u003ejsonfeed.org\u003c/a\u003e。\u003c/p\u003e","content_html":"\u003ch4 id=\"问题背景\"\u003e问题背景\u003c/h4\u003e\n\u003cp\u003e前几天在\u003ca href=\"https://planetics.xyz/\"\u003ePlanet\u003c/a\u003e里follow自己的\u003ca href=\"https://liudon.eth\"\u003eweb3博客\u003c/a\u003e，遇到下面的错误。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/fix-hugo-json-feed/202303251415675.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/fix-hugo-json-feed/202303251415675.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202303251415675.png\" width=\"716\" height=\"544\" alt=\"PlanetFeedError\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e经过Livid大佬提醒，说是网站的JSON Feed不是标准格式导致的。\u003c/p\u003e\n\u003cp\u003e因为我的已经修正没法截图，这里以\u003ca href=\"https://dvel.me/index.json\"\u003edvel的博客\u003c/a\u003e举例，格式类似如下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;content\u0026#34;: \u0026#34;用 ChatGPT 写一些小脚本真是太方便了。\\nGPT-4 发布后试了试，还是蛮不错的，代码是 ChatGPT 生成的。\\n几个来回就可以编写一个能正常使用的油猴脚本：\\n（略，HTML 代码） 在 https://chdbits.co/bakatest.php 有如上内容。 我要为这个网页编写一个油猴脚本。 通过自动获取 ChatGPT 的 API 来解析此问题的答案，供用户参考。 将内容输出到 `#outer \u0026amp;gt; h1` 的下面，同时输出你提取到的问题内容和答案，以便我看看你是否提取正确。 获取错啦。 问题的获取路径是 `#outer \u0026amp;gt; form \u0026amp;gt; table \u0026amp;gt; tbody \u0026amp;gt; tr:nth-child(1) \u0026amp;gt; td` 选项的获取路径是 `#outer \u0026amp;gt; form \u0026amp;gt; table \u0026amp;gt; tbody \u0026amp;gt; tr:nth-child(2) \u0026amp;gt; td` 使用这个 API： ``` curl https://api.openai.com/v1/chat/completions \\\\ -H \u0026amp;#39;Content-Type: application/json\u0026amp;#39; \\\\ -H \u0026amp;#39;Authorization: Bearer YOUR_API_KEY\u0026amp;#39; \\\\ -d \u0026amp;#39;{ \u0026amp;#34;model\u0026amp;#34;: \u0026amp;#34;gpt-3.5-turbo\u0026amp;#34;, \u0026amp;#34;messages\u0026amp;#34;: [{\u0026amp;#34;role\u0026amp;#34;: \u0026amp;#34;user\u0026amp;#34;, \u0026amp;#34;content\u0026amp;#34;: \u0026amp;#34;Say this is a test!\u0026amp;#34;}], \u0026amp;#34;temperature\u0026amp;#34;: 0.7 }\u0026amp;#39; ``` 响应格式为： ``` { \u0026amp;#34;id\u0026amp;#34;:\u0026amp;#34;chatcmpl-abc123\u0026amp;#34;, \u0026amp;#34;object\u0026amp;#34;:\u0026amp;#34;chat.completion\u0026amp;#34;, \u0026amp;#34;created\u0026amp;#34;:1677858242, \u0026amp;#34;model\u0026amp;#34;:\u0026amp;#34;gpt-3.5-turbo-0301\u0026amp;#34;, \u0026amp;#34;usage\u0026amp;#34;:{ \u0026amp;#34;prompt_tokens\u0026amp;#34;:13, \u0026amp;#34;completion_tokens\u0026amp;#34;:7, \u0026amp;#34;total_tokens\u0026amp;#34;:20 }, \u0026amp;#34;choices\u0026amp;#34;:[ { \u0026amp;#34;message\u0026amp;#34;:{ \u0026amp;#34;role\u0026amp;#34;:\u0026amp;#34;assistant\u0026amp;#34;, \u0026amp;#34;content\u0026amp;#34;:\u0026amp;#34;\\\\n\\\\nThis is a test!\u0026amp;#34; }, \u0026amp;#34;finish_reason\u0026amp;#34;:\u0026amp;#34;stop\u0026amp;#34;, \u0026amp;#34;index\u0026amp;#34;:0 } ] } ``` 它没有最近的互联网数据，所以还是需要把 API 的使用方式发给它。\\n然后它就帮我写好了，我不用复习 JavaScript，不用看油猴脚本的教程和文档，也不用查 @grant 等等标记是干嘛的。\\n可以再继续要求它改进一些，比如换个输出位置，优化 prompt，自动选中正确回答，支持单选题和多选题等等。\\n效果展示：\\n安装： https://greasyfork.org/zh-CN/scripts/461944-chd-quiz-answer\\n\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;permalink\u0026#34;: \u0026#34;https://dvel.me/posts/chd-quiz-answer/\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;summary\u0026#34;: \u0026#34;用 ChatGPT 写一些小脚本真是太方便了。\\nGPT-4 发布后试了试，还是蛮不错的，代码是 ChatGPT 生成的。\\n几个来回就可以编写一个能正常使用的油猴脚本：\\n（略，HTML 代码） 在 https://chdbits.co/bakatest.php 有如上内容。 我要为这个网页编写一个油猴脚本。 通过自动获取 ChatGPT 的 API 来解析此问题的答案，供用户参考。 将内容输出到 `#outer \u0026amp;gt; h1` 的下面，同时输出你提取到的问题内容和答案，以便我看看你是否提取正确。 获取错啦。 问题的获取路径是 `#outer \u0026amp;gt; form \u0026amp;gt; table \u0026amp;gt; tbody \u0026amp;gt; tr:nth-child(1) \u0026amp;gt; td` 选项的获取路径是 `#outer \u0026amp;gt; form \u0026amp;gt; table \u0026amp;gt; tbody \u0026amp;gt; tr:nth-child(2) \u0026amp;gt; td` 使用这个 API： ``` curl https://api.openai.com/v1/chat/completions \\\\ -H \u0026amp;#39;Content-Type: application/json\u0026amp;#39; \\\\ -H \u0026amp;#39;Authorization: Bearer YOUR_API_KEY\u0026amp;#39; \\\\ -d \u0026amp;#39;{ \u0026amp;#34;model\u0026amp;#34;: \u0026amp;#34;gpt-3.5-turbo\u0026amp;#34;, \u0026amp;#34;messages\u0026amp;#34;: [{\u0026amp;#34;role\u0026amp;#34;: \u0026amp;#34;user\u0026amp;#34;, \u0026amp;#34;content\u0026amp;#34;: \u0026amp;#34;Say this is a test!\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;title\u0026#34;: \u0026#34;CHD 油猴脚本：每日签到自动答题\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e下面是一个\u003ccode\u003eJSON Feed\u003c/code\u003e的示例，详细规范见\u003ca href=\"https://www.jsonfeed.org/\"\u003ejsonfeed.org\u003c/a\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;version\u0026#34;: \u0026#34;https://jsonfeed.org/version/1.1\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;title\u0026#34;: \u0026#34;My Example Feed\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;home_page_url\u0026#34;: \u0026#34;https://example.org/\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;feed_url\u0026#34;: \u0026#34;https://example.org/feed.json\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;items\u0026#34;: [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;id\u0026#34;: \u0026#34;2\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;content_text\u0026#34;: \u0026#34;This is a second item.\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;url\u0026#34;: \u0026#34;https://example.org/second-item\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;id\u0026#34;: \u0026#34;1\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;content_html\u0026#34;: \u0026#34;\u0026lt;p\u0026gt;Hello, world!\u0026lt;/p\u0026gt;\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;url\u0026#34;: \u0026#34;https://example.org/initial-post\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"修复方案\"\u003e修复方案\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e添加自定义\u003ccode\u003ejsonfeed\u003c/code\u003e模版文件，路径为\u003ccode\u003elayouts/_default/index.jsonfeed.json\u003c/code\u003e。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e文件内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $pctx := . -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- if .IsHome -}}{{ $pctx = site }}{{- end -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $pages := slice -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- if or $.IsHome $.IsSection -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $pages = $pctx.RegularPages -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- else -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $pages = $pctx.Pages -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- end -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $limit := site.Config.Services.RSS.Limit -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- if ge $limit 1 -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $pages = $pages | first $limit -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- end -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $title := \u0026#34;\u0026#34; }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- if eq .Title .Site.Title }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $title = .Site.Title }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- else }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- with .Title }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $title = print . \u0026#34; on \u0026#34;}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- $title = print $title .Site.Title }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;version\u0026#34;: \u0026#34;https://jsonfeed.org/version/1.1\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;title\u0026#34;: {{ $title | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;home_page_url\u0026#34;: {{ .Permalink | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{- with  .OutputFormats.Get \u0026#34;jsonfeed\u0026#34; }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;feed_url\u0026#34;: {{ .Permalink | jsonify  }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{- if (or .Site.Params.author .Site.Params.author_url) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;authors\u0026#34;: [{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      {{- if .Site.Params.author }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#34;name\u0026#34;: {{ .Site.Params.author | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      {{- if .Site.Params.author_url }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#34;url\u0026#34;: {{ .Site.Params.author_url | jsonify }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{- if $pages }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;items\u0026#34;: [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{- range $index, $element := $pages }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{- with $element }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{- if $index }},{{end}} {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;title\u0026#34;: {{ .Title | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;id\u0026#34;: {{ .Permalink | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;url\u0026#34;: {{ .Permalink | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- if .Site.Params.showFullTextinJSONFeed }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;summary\u0026#34;: {{ with .Description }}{{ . | jsonify }}{{ else }}{{ .Summary | jsonify }}{{ end -}},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;content_html\u0026#34;: {{ .Content | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- else }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;content_text\u0026#34;: {{ with .Description }}{{ . | jsonify }}{{ else }}{{ .Summary | jsonify }}{{ end -}},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- if .Params.cover.image }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- $cover := (.Resources.ByType \u0026#34;image\u0026#34;).GetMatch (printf \u0026#34;*%s*\u0026#34; (.Params.cover.image)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- if $cover }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;image\u0026#34;: {{ (path.Join .RelPermalink $cover) | absURL | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;date_published\u0026#34;: {{ .Date.Format \u0026#34;2006-01-02T15:04:05Z07:00\u0026#34; | jsonify }},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{- $tags := slice -}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{ with .Params.tags }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{ range . }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{ $tags = $tags | append (. | jsonify) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{end}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{end}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#34;tags\u0026#34;: [{{ delimit $tags \u0026#34;, \u0026#34; }}]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{- end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{ end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col start=\"2\"\u003e\n\u003cli\u003e开启\u003ccode\u003eJSON Feed\u003c/code\u003e。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e配置文件调整如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutputFormats:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  jsonfeed: # 添加jsonfeed输出格式\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    mediaType: application/feed+json\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    baseName: feed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    rel: alternate\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    isPlainText: true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutputs:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    home:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        - HTML\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        - RSS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        - json # fusejs搜索依赖index.json，不要漏掉这个配置\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        - jsonfeed # 开启jsonfeed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eparams:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    showFullTextinJSONFeed: true # jsonfeed开启全文输出\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e参考资料：\u003ca href=\"https://foosel.net/til/how-to-add-json-feed-support-to-hugo/\"\u003eHow to add JSON Feed support to Hugo\u003c/a\u003e\u003c/p\u003e\n","date_published":"2023-03-25T14:11:18+08:00","tags":["hugo"]},{"title":"我的学车之路","id":"https://liudon.com/posts/my-journey-of-learning-to-drive/","url":"https://liudon.com/posts/my-journey-of-learning-to-drive/","summary":"\u003cp\u003e之前在\u003ca href=\"https://liudon.com/posts/review-2022/\"\u003e2022年终总结\u003c/a\u003e提到过，我在练车考驾照。\u003c/p\u003e\n\u003cp\u003e就在昨天，终于拿证了。👏👏👏\u003c/p\u003e\n\u003cp\u003e咱也是可以上路开车的人了，虽然比别人晚了快10年才拿证。🐶\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年6月11日，在海淀驾校报名，周末连续班，报名费5380元。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年10月12日，科目一考试通过。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年10月22日，科目二模拟驾驶。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年11月13日，科目二第一次上车练习。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年11月24日，疫情严重，驾校发通知，自11月25日暂停培训。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2023年2月4日，年后驾校恢复培训，继续科目二练车。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2023年2月13日，科目二考试通过。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2023年3月11日，科目三上路练习。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2023年3月23日，上午科目三考试通过，下午科目四考试通过。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e考试的时候，早上遇到临时交通管制，一直到9点40才开考。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e考完回来，班车上的人说又管制不能考了。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e班车拉回驾校，剩下的人中午加班考试。\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e终于不用再5点半起床赶班车了。🥱\u003c/p\u003e","content_html":"\u003cp\u003e之前在\u003ca href=\"https://liudon.com/posts/review-2022/\"\u003e2022年终总结\u003c/a\u003e提到过，我在练车考驾照。\u003c/p\u003e\n\u003cp\u003e就在昨天，终于拿证了。👏👏👏\u003c/p\u003e\n\u003cp\u003e咱也是可以上路开车的人了，虽然比别人晚了快10年才拿证。🐶\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年6月11日，在海淀驾校报名，周末连续班，报名费5380元。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年10月12日，科目一考试通过。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年10月22日，科目二模拟驾驶。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年11月13日，科目二第一次上车练习。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2022年11月24日，疫情严重，驾校发通知，自11月25日暂停培训。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2023年2月4日，年后驾校恢复培训，继续科目二练车。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2023年2月13日，科目二考试通过。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2023年3月11日，科目三上路练习。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2023年3月23日，上午科目三考试通过，下午科目四考试通过。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e考试的时候，早上遇到临时交通管制，一直到9点40才开考。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e考完回来，班车上的人说又管制不能考了。\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e班车拉回驾校，剩下的人中午加班考试。\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e终于不用再5点半起床赶班车了。🥱\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/my-journey-of-learning-to-drive/202303242116962.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/my-journey-of-learning-to-drive/202303242116962.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202303242116962.jpeg\" width=\"1080\" height=\"1441\" alt=\"本本到手啦\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2023-03-24T20:48:24+08:00","tags":["个人技能"]},{"title":"将博客部署到星际文件系统(IPFS)","id":"https://liudon.com/posts/deploy-blog-to-ipfs/","url":"https://liudon.com/posts/deploy-blog-to-ipfs/","summary":"\u003cp\u003e在这篇文章，我将会介绍如何利用\u003ccode\u003eGithub Actions\u003c/code\u003e将\u003ccode\u003ehugo\u003c/code\u003e博客自动部署到\u003ccode\u003eIPFS\u003c/code\u003e上，并通过自定义域名访问\u003ccode\u003eIPFS\u003c/code\u003e上的文件。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIPFS（InterPlanetary File System）中文称为星际文件系统，是一个旨在实现文件的分布式存储、共享和持久化的网络传输协议。\u003c/p\u003e","content_html":"\u003cp\u003e在这篇文章，我将会介绍如何利用\u003ccode\u003eGithub Actions\u003c/code\u003e将\u003ccode\u003ehugo\u003c/code\u003e博客自动部署到\u003ccode\u003eIPFS\u003c/code\u003e上，并通过自定义域名访问\u003ccode\u003eIPFS\u003c/code\u003e上的文件。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIPFS（InterPlanetary File System）中文称为星际文件系统，是一个旨在实现文件的分布式存储、共享和持久化的网络传输协议。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e照惯例,先上演示.\u003ca href=\"https://liudon.xyz\"\u003e访问我的IPFS博客\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e欢迎各位pin我的博客， \u003ccode\u003eipfs pin add /ipns/liudon.xyz\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;https://liudon.xyz\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eI\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHTTP\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edate: Tue, \u003cspan style=\"color:#ae81ff\"\u003e21\u003c/span\u003e Feb \u003cspan style=\"color:#ae81ff\"\u003e2023\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e23\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e59\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e18\u003c/span\u003e GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econtent\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etype: text\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ehtml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evary: Accept\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eEncoding\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaccess\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtrol\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eallow\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003emethods: GET\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaccess\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtrol\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eallow\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003emethods: GET, POST, OPTIONS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elast\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003emodified: Tue, \u003cspan style=\"color:#ae81ff\"\u003e21\u003c/span\u003e Feb \u003cspan style=\"color:#ae81ff\"\u003e2023\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e23\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e59\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e18\u003c/span\u003e GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003egateway\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ehost: ipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ebank1\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003esv15\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003epath: \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eipns\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eliudon\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003exyz\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eroots: Qmd4pnpUj8CaLKoVMJNHJyrqwWVa4wvz1qKxZsU9vKgErL\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003epop: ipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ebank1\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003esv15\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etiming\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eallow\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eorigin: \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaccess\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtrol\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eallow\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eorigin: \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaccess\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtrol\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eallow\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eheaders: X\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eRequested\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eWith, \u003cspan style=\"color:#a6e22e\"\u003eRange\u003c/span\u003e, Content\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eRange\u003c/span\u003e, X\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eChunked\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eOutput, X\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eStream\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eOutput\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaccess\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003econtrol\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eexpose\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eheaders: Content\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eRange\u003c/span\u003e, X\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eChunked\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eOutput, X\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eStream\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eOutput\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003elb\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003epop: gateway\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ebank1\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003esv15\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eproxy\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecache: MISS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecf\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecache\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003estatus: DYNAMIC\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ereport\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eto: {\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;endpoints\u0026#34;\u003c/span\u003e:[{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;url\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https:\\/\\/a.nel.cloudflare.com\\/report\\/v3?s=FLcvWgtngoLuGZkl9jYsviSoOlSoE2Y0rKxI3bgNaKRxhNOrIm6nozqVzndav3%2B9QrvvcJ5GNmC11JBlN8tiigbF9CWPW33TbnLKyfdeblOcEhmZINTcC%2BJ6xhKs\u0026#34;\u003c/span\u003e}],\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;group\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cf-nel\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;max_age\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e604800\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enel: {\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;success_fraction\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;report_to\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cf-nel\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;max_age\u0026#34;\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e604800\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eserver: cloudflare\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecf\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eray: \u003cspan style=\"color:#ae81ff\"\u003e79\u003c/span\u003ed36f598970531f\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eLAX\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ealt\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003esvc: h3\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:443\u0026#34;\u003c/span\u003e; ma\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e86400\u003c/span\u003e, h3\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e29\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:443\u0026#34;\u003c/span\u003e; ma\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e86400\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"准备工作\"\u003e准备工作:\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eCloudflare帐号\u003c/li\u003e\n\u003cli\u003e一台VPS主机,我用到腾讯云lighthouse主机2核2G\u003c/li\u003e\n\u003cli\u003e一个域名\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"方案介绍\"\u003e方案介绍:\u003c/h4\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-blog-to-ipfs/deploy-blog-to-ipfs.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-blog-to-ipfs/deploy-blog-to-ipfs.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"deploy-blog-to-ipfs.png\" width=\"800\" height=\"390\" alt=\"实现方案\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e在VPS主机上安装启动IPFS服务,通过端口5001在内网提供API服务.\u003c/li\u003e\n\u003cli\u003e在GitHub上通过ssh建立端口转发,本地端口5001转发到VPS主机5001.\u003c/li\u003e\n\u003cli\u003e在GitHub上利用ipfs-http-client上传文进到5001端口.\u003c/li\u003e\n\u003cli\u003e绑定域名到IPNS地址,通过域名访问IPFS文件.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"1-部署ipfs服务\"\u003e1. 部署IPFS服务\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e安装kubo,详见\u003ca href=\"https://docs.ipfs.tech/install/command-line/#install-official-binary-distributions\"\u003e官方文档\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://dist.ipfs.tech/kubo/v0.18.1/kubo_v0.18.1_linux-amd64.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etar -xvzf kubo_v0.18.1_linux-amd64.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; x kubo/install.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; x kubo/ipfs\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; x kubo/LICENSE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; x kubo/LICENSE-APACHE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; x kubo/LICENSE-MIT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; x kubo/README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd kubo\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo bash install.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; Moved ./ipfs to /usr/local/bin\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eipfs --version\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; ipfs version 0.18.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e初始化IPFS\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eipfs init --profile=server\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e添加到开机启动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[Unit]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDescription=IPFS Daemon\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter=syslog.target network.target remote-fs.target nss-lookup.target\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[Service]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eType=simple\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStart=/usr/local/bin/ipfs daemon --enable-namesys-pubsub\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser=root\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[Install]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWantedBy=multi-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e注意打开\u003ccode\u003e--enable-namesys-pubsub\u003c/code\u003e参数，不然IPNS更新生效很慢。\u003c/p\u003e\n\u003cp\u003e将上述代码保存到\u003ccode\u003e/usr/lib/systemd/system/ipfs.service\u003c/code\u003e文件.\u003c/p\u003e\n\u003cp\u003e启动进程.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl start ipfs.service\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e开放端口\u003c/p\u003e\n\u003cp\u003eIPFS默认通过4001端口跟DHT网络通信,需要放开4001端口访问.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"2-github-actions配置\"\u003e2. GitHub Actions配置\u003c/h4\u003e\n\u003cp\u003e博客我使用的\u003ccode\u003eHugo\u003c/code\u003e，原有的工作流方案见\u003ca href=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/\"\u003e将博客部署到Cloudflare Pages\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e完整的工作流配置见\u003ca href=\"%E5%AE%8C%E6%95%B4%E9%85%8D%E7%BD%AE%E5%8F%AF%E5%8F%82%E8%80%83%5Bmain.yml%5D(https://github.com/Liudon/liudon.github.io/blob/code/.github/workflows/main.yml)\"\u003emain.yml\u003c/a\u003e。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e添加如下变量到Actions secrets\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSSHKEY VPS主机ssh登陆私钥\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSSHHOST ssh用户@VPS机器IP,类似root@127.0.0.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e更新yaml配置文件,添加如下任务.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: Connect to ssh \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e BG\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    timeout\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eminutes: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;${{ secrets.SSHKEY }}\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e../\u003c/span\u003eprivkey\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      chmod \u003cspan style=\"color:#ae81ff\"\u003e600\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e../\u003c/span\u003eprivkey\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ssh \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eo StrictHostKeyChecking\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eno \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e{{ secrets\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSSHHOST }} \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ei \u003cspan style=\"color:#f92672\"\u003e../\u003c/span\u003eprivkey \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eL \u003cspan style=\"color:#ae81ff\"\u003e5001\u003c/span\u003e:localhost:\u003cspan style=\"color:#ae81ff\"\u003e5001\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003efTN\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e name: ipfs upload\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uses: aquiladev\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eipfs\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eaction\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003emaster\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    id: deploy\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    timeout\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eminutes: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    with:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      path: \u003cspan style=\"color:#f92672\"\u003e./\u003c/span\u003epublic\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      service: ipfs\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      verbose: true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      host: localhost\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      port: \u003cspan style=\"color:#ae81ff\"\u003e5001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      protocol: http\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      key: self \u003cspan style=\"color:#75715e\"\u003e# 要配置key,这样才会生成IPNS地址\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e测试执行action,\u003ca href=\"https://github.com/Liudon/liudon.github.io/actions/runs/4230563492/jobs/7348031553\"\u003e日志\u003c/a\u003e里会有类似如下输出.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUpload to IPFS finished successfully {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecid: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;QmST2Zqv8qffFTVuqfRX57uzqxsoQtTYinmHpyLh7padAD\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eipfs: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;QmST2Zqv8qffFTVuqfRX57uzqxsoQtTYinmHpyLh7padAD\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eipns: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;12D3KooWKvJ9Y4D5X4R3ajuc7tVtQWXZMG4iiMCFtay8frM66o4c\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e每次执行,ipfs地址不同,ipns地址不变.\n记住这里到ipns地址,下面会用到.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"3-域名配置\"\u003e3. 域名配置\u003c/h4\u003e\n\u003cp\u003e在\u003ccode\u003eCloudflare\u003c/code\u003e上添加解析:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e添加DNS TXT记录,名称为\u003ccode\u003e_dnslink\u003c/code\u003e，值为\u003ccode\u003ednslink=/ipns/12D3KooWKvJ9Y4D5X4R3ajuc7tVtQWXZMG4iiMCFtay8frM66o4c\u003c/code\u003e，将这里的\u003ccode\u003e12D3KooWKvJ9Y4D5X4R3ajuc7tVtQWXZMG4iiMCFtay8frM66o4c\u003c/code\u003e改为上一步日志里到ipns值。\u003c/li\u003e\n\u003cli\u003e添加DNS CNNANE记录,名称为\u003ccode\u003e你的域名\u003c/code\u003e，值为\u003ccode\u003egateway.ipfs.io\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-blog-to-ipfs/dns-record.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-blog-to-ipfs/dns-record.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"dns-record.png\" width=\"800\" height=\"76\" alt=\"DNS解析\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch4 id=\"4-开启相对路径\"\u003e4. 开启相对路径\u003c/h4\u003e\n\u003cp\u003e经\u003ca href=\"https://github.com/livid\"\u003eLivid大佬\u003c/a\u003e提醒，\u003ca href=\"https://zu1k.com/posts/tutorials/p2p/ipfs-easy-use/\"\u003e公共网关访问时存在相对路径问题\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e我用的\u003ccode\u003eHugo\u003c/code\u003e，配置文件里打开\u003ccode\u003erelativeURLs\u003c/code\u003e配置。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erelativeURLs: true\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e从年前开始想怎么做成自动化,到今天终于跑通搞定了.😁😁😁\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-blog-to-ipfs/20230222080123.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-blog-to-ipfs/20230222080123.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20230222080123.png\" width=\"800\" height=\"994\" alt=\"VPS主机运行情况\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e两天跑了14G流量,每月的流量资源包基本够用了.\u003c/p\u003e\n\u003cp\u003e参考资料：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://zu1k.com/posts/tutorials/p2p/ipfs-easy-use/\"\u003eIPFS 日用优化指南\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/UnifiedPush/documentation/blob/karmanyaahm-patch-3/config.toml\"\u003e参考配置\u003c/a\u003e\u003c/p\u003e\n","image":"https://liudon.com/posts/deploy-blog-to-ipfs/20230222122431.png","date_published":"2023-02-21T19:46:58+08:00","tags":["hugo","ipfs","github","cloudflare"]},{"title":"新冠疫情后的第一个春节","id":"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/","url":"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/","summary":"\u003cblockquote\u003e\n\u003cp\u003e下面的内容是由chatGPT润色生成的。\u003c/p\u003e\n\u003cp\u003eAI太强大了 😂\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e当我还是个孩子的时候，在看春节晚会时，总会有节目介绍那些不能回家过年的人。\u003c/p\u003e\n\u003cp\u003e但我从未想过，等我长大后，我也会成为其中的一员。\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003e下面的内容是由chatGPT润色生成的。\u003c/p\u003e\n\u003cp\u003eAI太强大了 😂\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e当我还是个孩子的时候，在看春节晚会时，总会有节目介绍那些不能回家过年的人。\u003c/p\u003e\n\u003cp\u003e但我从未想过，等我长大后，我也会成为其中的一员。\u003c/p\u003e\n\u003cp\u003e由于疫情的影响，我已经连续三年不能回家过年了。\u003c/p\u003e\n\u003cp\u003e每次我告诉父母我无法回家，他们总是表现得非常平静，但我不知道他们挂了电话后的心情会如何。\u003c/p\u003e\n\u003cp\u003e直到今年，我们全家都经历了一次感染，但这也使我们有了机会在这个特殊的春节回家过年。\u003c/p\u003e\n\u003cp\u003e提前请了假，带娃体验下老家的生活。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210359.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210359.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20230216210359.jpg\" width=\"1080\" height=\"810\" alt=\"回家\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e回家啦。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210413.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210413.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20230216210413.jpg\" width=\"800\" height=\"800\" alt=\"赶集\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e赶大集。\u003c/p\u003e\n\u003cp\u003e\n\n\n\u003c/p\u003e\n\u003cp\u003e烧火。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210418.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210418.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20230216210418.jpg\" width=\"800\" height=\"1200\" alt=\"放烟花\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e放烟花。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210424.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210424.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20230216210424.jpg\" width=\"800\" height=\"1067\" alt=\"抓鸟\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e抓鸟。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210436.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210436.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20230216210436.jpg\" width=\"800\" height=\"600\" alt=\"放孔明灯\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e放孔明灯。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210431.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/the-first-chinese-new-year-after-the-covid-19/20230216210431.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20230216210431.jpg\" width=\"800\" height=\"1067\" alt=\"蹭饭\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e邻居家蹭饭。\u003c/p\u003e\n","date_published":"2023-02-16T20:56:38+08:00","tags":[]},{"title":"第一次清理键盘","id":"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/","url":"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/","summary":"\u003cp\u003e19年生日的时候，媳妇送了一款flico的机械键盘。\u003c/p\u003e\n\u003cp\u003e这次搬家后，想着年前清理下键盘，实在是太脏了。\u003c/p\u003e\n\u003cp\u003e周五下班，带上键盘回家。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450523.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450523.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450523.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e","content_html":"\u003cp\u003e19年生日的时候，媳妇送了一款flico的机械键盘。\u003c/p\u003e\n\u003cp\u003e这次搬家后，想着年前清理下键盘，实在是太脏了。\u003c/p\u003e\n\u003cp\u003e周五下班，带上键盘回家。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450523.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450523.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450523.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e键盘全貌，上面好多油。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450514.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450514.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450514.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e开拆。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450505.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450505.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450505.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e手还是太慢，上工具吧。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450497.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450497.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450497.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e全部拆完。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450488.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450488.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450488.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e内部特写。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450480.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450480.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450480.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e清理出来的灰屑、头发，这键盘见证了我的发迹线变化\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450468.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450468.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450468.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e终于清理干净了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450456.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/cleaning-the-keyboard-for-the-first-time/202301161450456.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161450456.jpeg\" width=\"1080\" height=\"810\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e复原，又可以咔咔写代码了。\u003c/p\u003e\n","date_published":"2023-01-16T14:43:38+08:00","tags":["自己动手"]},{"title":"2022年终总结","id":"https://liudon.com/posts/review-2022/","url":"https://liudon.com/posts/review-2022/","summary":"\u003cp\u003e2022年已经过去1周多了，记录一下我的2022年。\u003c/p\u003e\n\u003ch4 id=\"疫情\"\u003e疫情\u003c/h4\u003e\n\u003cp\u003e2022年，是新冠疫情的第三年，也是切身感受到的一年。\u003c/p\u003e\n\u003cp\u003e3月22日晚，8点半和同事刚上13号线地铁。\u003c/p\u003e","content_html":"\u003cp\u003e2022年已经过去1周多了，记录一下我的2022年。\u003c/p\u003e\n\u003ch4 id=\"疫情\"\u003e疫情\u003c/h4\u003e\n\u003cp\u003e2022年，是新冠疫情的第三年，也是切身感受到的一年。\u003c/p\u003e\n\u003cp\u003e3月22日晚，8点半和同事刚上13号线地铁。\u003c/p\u003e\n\u003cp\u003e紧接着看到群里有人说，公司大厦因为疫情封控了，只进不出。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2022/%E5%A4%A7%E5%8E%A6%E5%B0%81%E6%8E%A7.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2022/%E5%A4%A7%E5%8E%A6%E5%B0%81%E6%8E%A7.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%a4%a7%e5%8e%a6%e5%b0%81%e6%8e%a7.jpg\" width=\"800\" height=\"1223\" alt=\"大厦封控\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e第一次感受弹窗3，居家隔离。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2022/%E5%BC%B9%E7%AA%973.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2022/%E5%BC%B9%E7%AA%973.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%bc%b9%e7%aa%973.jpg\" width=\"800\" height=\"1422\" alt=\"弹窗3\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2022/%E5%B1%85%E5%AE%B6%E9%9A%94%E7%A6%BB.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2022/%E5%B1%85%E5%AE%B6%E9%9A%94%E7%A6%BB.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%b1%85%e5%ae%b6%e9%9a%94%e7%a6%bb.jpg\" width=\"800\" height=\"1066\" alt=\"居家隔离\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2022/%E5%B1%85%E5%AE%B6%E8%A7%82%E5%AF%9F.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2022/%E5%B1%85%E5%AE%B6%E8%A7%82%E5%AF%9F.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%b1%85%e5%ae%b6%e8%a7%82%e5%af%9f.jpg\" width=\"800\" height=\"1422\" alt=\"居家观察\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e5月21日，开启居家办公。\u003c/p\u003e\n\u003cp\u003e6月5日，开始到岗工作。\u003c/p\u003e\n\u003cp\u003e11月17日，公司通知第二天居家办公。\u003c/p\u003e\n\u003cp\u003e11月21日，小区通知临时管控。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2022/%E5%B0%8F%E5%8C%BA%E5%B0%81%E6%8E%A7.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2022/%E5%B0%8F%E5%8C%BA%E5%B0%81%E6%8E%A7.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%b0%8f%e5%8c%ba%e5%b0%81%e6%8e%a7.jpg\" width=\"800\" height=\"1158\" alt=\"小区封控\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e12月10日，媳妇中招。\u003c/p\u003e\n\u003cp\u003e12月12日，自己中招。\u003c/p\u003e\n\u003cp\u003e12月18日，娃中招。\u003c/p\u003e\n\u003cp\u003e\n\n\n\u003c/p\u003e\n\u003cp\u003e12月20日，开始到岗工作，持续了近一个月的居家隔离生活终于结束。\u003c/p\u003e\n\u003cp\u003e老妈冒着北京疫情高峰感染的风险，过来帮我们带娃。\u003c/p\u003e\n\u003cp\u003e从1周一检，到3天一检，不知道健康宝有没有年终报告，告诉你今年做了多少次核酸，相信会是很棒的一个数字。\u003c/p\u003e\n\u003ch4 id=\"入学\"\u003e入学\u003c/h4\u003e\n\u003cp\u003e上半年赶着疫情的间隙，整理好了娃的入学资料。\u003c/p\u003e\n\u003cp\u003e经过一个月的焦虑等待后，最终被附近的学校录取，也确实感受到了离家近的好处。\u003c/p\u003e\n\u003cp\u003e详细经过见\u003ca href=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/\"\u003e记录2022年海淀幼升小\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"休假\"\u003e休假\u003c/h4\u003e\n\u003cp\u003e春节没有回家过年，上半年北京和老家交替出现疫情，最终在8月份休假回了趟家。\u003c/p\u003e\n\u003ch4 id=\"驾照\"\u003e驾照\u003c/h4\u003e\n\u003cp\u003e因为疫情，感觉还是得考个驾照，拖延了N年的事项提上了日程。\u003c/p\u003e\n\u003cp\u003e6月份报名，一直拖到10月份才过的科目一。\u003c/p\u003e\n\u003cp\u003e11月底开始摸车了，刚上2节课因为疫情封校了，现在学的都快忘光了。\u003c/p\u003e\n\u003ch4 id=\"搬家\"\u003e搬家\u003c/h4\u003e\n\u003cp\u003e年底公司通知搬家，又搬回了银科，兜兜转转，又回到了起点。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2022/20230221153216.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2022/20230221153216.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20230221153216.jpg\" width=\"800\" height=\"1067\" alt=\"又回银科\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch4 id=\"博客\"\u003e博客\u003c/h4\u003e\n\u003cp\u003e2022年，把博客又捡了回来，今年多更新吧。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/review-2022/202301161440442.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/review-2022/202301161440442.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"202301161440442.png\" width=\"1080\" height=\"636\" alt=\"\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e或许是上了年纪，2022年发现泪点变得很低，健康、家人才是最重要的。\u003c/p\u003e\n\u003cp\u003e新的一年，继续开源节流，做好防护，保护好家人。\u003c/p\u003e\n\u003cp\u003e最后，祝大家新年快乐！\u003c/p\u003e\n","date_published":"2023-01-12T07:21:20+08:00","tags":["年终总结"]},{"title":"去掉Cloudflare烦人的email-decode.min.js请求","id":"https://liudon.com/posts/remove-cloudflares-email-decode.min.js/","url":"https://liudon.com/posts/remove-cloudflares-email-decode.min.js/","summary":"\u003cp\u003e通过WebPageTest页面测试，发现一个\u003ccode\u003e/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js\u003c/code\u003e的文件请求，影响到了页面渲染。\u003c/p\u003e","content_html":"\u003cp\u003e通过WebPageTest页面测试，发现一个\u003ccode\u003e/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js\u003c/code\u003e的文件请求，影响到了页面渲染。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/remove-cloudflares-email-decode.min.js/webpagetest.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/remove-cloudflares-email-decode.min.js/webpagetest.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"webpagetest.png\" width=\"1080\" height=\"360\" alt=\"webpagetest测试结果\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e看路径像是Cloudflare的文件，搜了下主题代码，没找到相关文件。\u003c/p\u003e\n\u003cp\u003e经过一番搜索，原来这个是Cloudflare的\u003ccode\u003e电子邮件地址混淆技术\u003c/code\u003e功能。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/remove-cloudflares-email-decode.min.js/ScrapeShield.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/remove-cloudflares-email-decode.min.js/ScrapeShield.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"ScrapeShield.png\" width=\"1080\" height=\"456\" alt=\"Scrape Shield\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e关闭这个功能即可。\u003c/p\u003e\n","date_published":"2022-08-26T23:25:57+08:00","tags":["Cloudflare"]},{"title":"累计布局偏移修复方案改进 —— 自动生成图片宽高","id":"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/","url":"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/","summary":"\u003cp\u003e本站已不再采用本方案，新方案见\u003ca href=\"/posts/responsive-and-optimized-images-with-hugo/\"\u003e使用Hugo实现响应式和优化的图片\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"遗留的问题\"\u003e遗留的问题\u003c/h4\u003e\n\u003cp\u003e上一篇文章讲了我是如何解决博客累计布局偏移的问题，但是这个方案存在一个很大的问题。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e手动输入每张图片的宽高\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e这就要求每次插入图片后，需要手动查看图片宽高，修改插入代码，导致整个流程变得繁琐，无法自动化。\u003c/p\u003e","content_html":"\u003cp\u003e本站已不再采用本方案，新方案见\u003ca href=\"/posts/responsive-and-optimized-images-with-hugo/\"\u003e使用Hugo实现响应式和优化的图片\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"遗留的问题\"\u003e遗留的问题\u003c/h4\u003e\n\u003cp\u003e上一篇文章讲了我是如何解决博客累计布局偏移的问题，但是这个方案存在一个很大的问题。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e手动输入每张图片的宽高\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e这就要求每次插入图片后，需要手动查看图片宽高，修改插入代码，导致整个流程变得繁琐，无法自动化。\u003c/p\u003e\n\u003cp\u003e身为一名工程师，对于这样一个痛点，势必要优化掉。\u003c/p\u003e\n\u003ch4 id=\"思路\"\u003e思路\u003c/h4\u003e\n\u003cp\u003e发完上一篇文章后，我一直在想怎么能实现自动化插入图片宽高。\u003c/p\u003e\n\u003cp\u003e要插入的图片代码是类似这样的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u0026lt; figure src=\u0026#34;https://static.liudon.com/img/cover-code.png\u0026#34; alt=\u0026#34;cover.html code\u0026#34; width=\u0026#34;2020\u0026#34; height=\u0026#34;1468\u0026#34; \u0026gt;}}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e我使用了\u003ccode\u003epicgo\u003c/code\u003e插件，上传图片到腾讯云对象存储，然后复制\u003ccode\u003emarkdown\u003c/code\u003e图片代码插入文章。\u003c/p\u003e\n\u003cp\u003e能不能通过改造\u003ccode\u003epicgo\u003c/code\u003e插件，将上传后复制的代码，加上图片的宽高参数？\u003c/p\u003e\n\u003cp\u003e通过一番搜索，发现此方案不通，\u003ccode\u003epicgo\u003c/code\u003e确实支持自定义代码，但是变量仅支持\u003ccode\u003e文件名\u003c/code\u003e和\u003ccode\u003eurl\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/picgo-config.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/picgo-config.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"picgo-config.png\" width=\"981\" height=\"501\" alt=\"picgo config\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e此路不通，只好再想新的办法了。\u003c/p\u003e\n\u003cp\u003e对象存储的图片处理有接口，可以返回图片的宽高信息，详细说明见\u003ca href=\"https://cloud.tencent.com/document/product/460/6927\"\u003e获取图片基本信息\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e能不能在生成文件的时候，通过发起一个请求拿到图片宽高，然后写入html代码？\u003c/p\u003e\n\u003cp\u003e经过一番搜索，发现\u003ccode\u003ehugo\u003c/code\u003e支持请求url，详细说明见\u003ca href=\"https://gohugo.io/templates/data-templates/#get-remote-data\"\u003eGet Remote Data\u003c/a\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ $dataJ := getJSON \u0026#34;url\u0026#34; }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{ $dataC := getCSV \u0026#34;separator\u0026#34; \u0026#34;url\u0026#34; }}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e哈哈，柳暗花明又一村的感觉。\u003c/p\u003e\n\u003ch4 id=\"解决方案\"\u003e解决方案\u003c/h4\u003e\n\u003cp\u003e此方案基于对象存储获取图片宽高，然后写入图片解析模板。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e新增\u003ccode\u003ecss\u003c/code\u003e配置\u003c/p\u003e\n\u003cp\u003e新增如下配置，否则会导致图片变形。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eimg {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    width:\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    height:auto;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efigure {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    background\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecolor: \u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003ecode\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ebg);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e添加\u003ccode\u003erender-image.html\u003c/code\u003e文件\u003c/p\u003e\n\u003cp\u003e代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eitem :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e getJSON \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDestination \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;?imageInfo\u0026amp;t=\u0026#34;\u003c/span\u003e now\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUnix \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e通过对象存储接口获取图片宽高，因为我使用了\u003c/span\u003ecdn\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，所以增加随机数保证拿到最新的图片宽高参数\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eDestination :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDestination \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eText :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eText \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eTitle :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eTitle \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eitem }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Destination | safeURL }}/webp\u0026#34;\u003c/span\u003e width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .height }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Destination | safeURL }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $Text }}\u0026#34;\u003c/span\u003e {{ with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eTitle}} title\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e {{ end }} width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .height }}\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e添加\u003ccode\u003ecover.html\u003c/code\u003e文件\u003c/p\u003e\n\u003cp\u003e代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecxt}} {{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e Apply proper context from dict \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eimage (\u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$.\u003c/span\u003eisHidden)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealt :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ealt \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecaption \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e plainify) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003efigure \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;entry-cover\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default site\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresponsiveImages) \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e default true }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e site\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elinkFullImages (\u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$.\u003c/span\u003eIsHome)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResources\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eByType \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGetMatch (printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e*\u0026#34;\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eimage)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e i\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ee it is present \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e page bundle \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (path.Join .RelPermalink .Params.cover.image) | absURL }}\u0026#34;\u003c/span\u003e target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_blank\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            rel\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;noopener noreferrer\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esizes :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (slice \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;360\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;480\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;720\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1080\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1500\u0026#34;\u003c/span\u003e) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessableFormats :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (slice \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;jpg\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;jpeg\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;png\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;tif\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bmp\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gif\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e hugo\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsExtended \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessableFormats \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessableFormats \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e append \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;webp\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprod :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (hugo\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eIsProduction \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e (eq site\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eenv \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;production\u0026#34;\u003c/span\u003e)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessableFormats \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eMediaType\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSubType) (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresponsiveImages) (eq \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprod true)) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{- range $size := $sizes -}}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (ge \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esize) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        {{ printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e ((\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eResize (printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ex\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esize))\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePermalink) (printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ew ,\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esize) \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        {{ end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ePermalink }} {{printf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ew\u0026#34;\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eWidth)}}\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            sizes\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(min-width: 768px) 720px, 100vw\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $cover.Permalink }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $alt }}\u0026#34;\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $cover.Width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $cover.Height }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e }}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e Unprocessable image \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e responsive images disabled \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (path.Join .RelPermalink .Params.cover.image) | absURL }}\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $alt }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e }}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e For absolute urls \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e external links, no img processing here \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eitem :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e getJSON \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eimage \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;?imageInfo\u0026amp;t=\u0026#34;\u003c/span\u003e now\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUnix \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e通过对象存储接口获取图片宽高，因为我使用了\u003c/span\u003ecdn\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e，所以增加随机数保证拿到最新的图片宽高参数\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecoverUrl :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eimage \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eitem }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $coverUrl | absURL }}\u0026#34;\u003c/span\u003e target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_blank\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            rel\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;noopener noreferrer\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $coverUrl | absURL }}/webp\u0026#34;\u003c/span\u003e width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .height }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $alt }}\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $coverUrl | absURL }}\u0026#34;\u003c/span\u003e width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .width }}\u0026#34;\u003c/span\u003e height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .height }}\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003ea\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e  Display Caption  \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$.\u003c/span\u003eIsHome }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{ with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecaption }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ep\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e markdownify }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003ep\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003efigure\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e End image \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e End context \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e使用方式和原来不变，插入\u003ccode\u003emarkdown\u003c/code\u003e语法的图片代码即可。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e![picgo config](picgo-config.png)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这下又可以愉快地码字了。\u003c/p\u003e\n","image":"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/74TRx6aETydsBGa2IZ7R.png","date_published":"2022-08-24T12:37:22+08:00","tags":["博客优化","CLS","PagerMod","hugo"]},{"title":"优化博客的累计布局偏移(CLS)问题","id":"https://liudon.com/posts/fix-blog-cls/","url":"https://liudon.com/posts/fix-blog-cls/","summary":"\u003cp\u003e此文已过期，优化方案参考\u003ca href=\"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/\"\u003e累计布局偏移修复方案改进 —— 自动生成图片宽高\u003c/a\u003e.\u003c/p\u003e\n\u003ch4 id=\"问题表现\"\u003e问题表现\u003c/h4\u003e\n\u003cp\u003e7月份将博客部署由\u003ccode\u003eGithub\u003c/code\u003e迁移到\u003ccode\u003eCloudflare\u003c/code\u003e后，开始关注博客的性能问题。\u003c/p\u003e\n\u003cp\u003e偶然看到苏卡卡大佬的\u003ca href=\"https://blog.skk.moe/post/fix-blog-cls/\"\u003eCLS优化文章\u003c/a\u003e，拿自己博客也测试了下，发现也存在同样的问题。\u003c/p\u003e","content_html":"\u003cp\u003e此文已过期，优化方案参考\u003ca href=\"https://liudon.com/posts/hugo-auto-generate-image-width-and-height/\"\u003e累计布局偏移修复方案改进 —— 自动生成图片宽高\u003c/a\u003e.\u003c/p\u003e\n\u003ch4 id=\"问题表现\"\u003e问题表现\u003c/h4\u003e\n\u003cp\u003e7月份将博客部署由\u003ccode\u003eGithub\u003c/code\u003e迁移到\u003ccode\u003eCloudflare\u003c/code\u003e后，开始关注博客的性能问题。\u003c/p\u003e\n\u003cp\u003e偶然看到苏卡卡大佬的\u003ca href=\"https://blog.skk.moe/post/fix-blog-cls/\"\u003eCLS优化文章\u003c/a\u003e，拿自己博客也测试了下，发现也存在同样的问题。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/fix-blog-cls/lighthouse_result.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/fix-blog-cls/lighthouse_result.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"lighthouse_result.png\" width=\"1038\" height=\"1144\" alt=\"Lighthouse测试报告\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e根据苏卡卡大佬的文章，分析页面是由于文章封面的图片缺少宽高导致出现CLS问题。\u003c/p\u003e\n\u003cp\u003e为了解决这个问题，需要指定封面的宽高参数。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/fix-blog-cls/cover-code.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/fix-blog-cls/cover-code.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"cover-code.png\" width=\"1080\" height=\"785\" alt=\"cover.html code\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e根据\u003ccode\u003ePagerMod\u003c/code\u003e主题的\u003ccode\u003ecover.html\u003c/code\u003e文件代码，使用绝对地址的情况没有配置宽高参数。\u003c/p\u003e\n\u003ch4 id=\"解决方案\"\u003e解决方案\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e新增封面配置\u003c/p\u003e\n\u003cp\u003e文章封面配置新增\u003ccode\u003ewidth\u003c/code\u003e和\u003ccode\u003eheight\u003c/code\u003e属性。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecover:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    image: \u0026#34;https://static.liudon.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220725183817.jpg\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    width: 1620\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    height: 1080\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e自定义封面文件\u003c/p\u003e\n\u003cp\u003e添加自己的\u003ccode\u003ecover.html\u003c/code\u003e文件，核心代码如下，完整代码参考\u003ca href=\"https://github.com/Liudon/liudon.github.io/blob/code/layouts/partials/cover.html\"\u003e我的文件\u003c/a\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e }}{{\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e For absolute urls \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e external links, no img processing here \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eaddLink }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.image) | absURL }}\u0026#34;\u003c/span\u003e target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_blank\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            rel\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;noopener noreferrer\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.image) | absURL }}/webp\u0026#34;\u003c/span\u003e {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ewidth) }}width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.width) }}\u0026#34;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}} {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eheight) }}height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.height) }}\u0026#34;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ $alt }}\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.image) | absURL }}\u0026#34;\u003c/span\u003e {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ewidth) }}width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.width) }}\u0026#34;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}} {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eParams\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecover\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eheight) }}height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ (.Params.cover.height) }}\u0026#34;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003eimg\u003c/code\u003e标签新增\u003ccode\u003ewidth\u003c/code\u003e和\u003ccode\u003eheight\u003c/code\u003e属性，读取封面配置的\u003ccode\u003ewidth\u003c/code\u003e和\u003ccode\u003eheight\u003c/code\u003e属性值。\u003c/p\u003e\n\u003cp\u003e图片我放到了腾讯云对象存储上，通过图片处理支持了\u003ccode\u003ewebp\u003c/code\u003e格式图片。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/fix-blog-cls/cos-img-process.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/fix-blog-cls/cos-img-process.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"cos-img-process.png\" width=\"1080\" height=\"511\" alt=\"cos-img-process\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e新增\u003ccode\u003ecss\u003c/code\u003e配置\u003c/p\u003e\n\u003cp\u003e新增如下配置，否则会导致图片变形。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eimg {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    width:\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    height:auto;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efigure {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    background\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ecolor: \u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003ecode\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ebg);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"再进一步\"\u003e再进一步\u003c/h4\u003e\n\u003cp\u003e前面只解决了首页封面，文章页也会存在图片的情况，也会有类似的问题。\u003c/p\u003e\n\u003cp\u003e基于\u003ccode\u003emarkdown\u003c/code\u003e语法的图片代码，是不支持宽高参数的。\u003c/p\u003e\n\u003cp\u003e还好\u003ccode\u003ehugo\u003c/code\u003e支持shortcode，其中就有\u003ccode\u003efigure\u003c/code\u003e语法，支持配置宽高参数。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/fix-blog-cls/figure-code.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/fix-blog-cls/figure-code.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"figure-code.png\" width=\"1080\" height=\"714\" alt=\"figure.html code\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e我们使用\u003ccode\u003efigure\u003c/code\u003e语法插入图片，指定图片宽高。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003efigure\u003c/code\u003e解析模板我也进行了改进，类似\u003ccode\u003ecover.html\u003c/code\u003e模板，也通过对象存储图片处理支持了webp响应式图片，核心代码如下，完整代码参考\u003ca href=\"https://github.com/Liudon/liudon.github.io/blob/code/layouts/shortcodes/figure.html\"\u003e我的文件\u003c/a\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;link\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .Get \u0026#34;\u003c/span\u003elink\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; }}\u0026#34;\u003c/span\u003e{{ with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;target\u0026#34;\u003c/span\u003e }} target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{ end }}{{ with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rel\u0026#34;\u003c/span\u003e }} rel\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{ end }}\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003esource type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;image/webp\u0026#34;\u003c/span\u003e srcset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .Get \u0026#34;\u003c/span\u003esrc\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; }}/webp\u0026#34;\u003c/span\u003e {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;width\u0026#34;\u003c/span\u003e }} width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;height\u0026#34;\u003c/span\u003e }} height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eimg loading\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lazy\u0026#34;\u003c/span\u003e src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ .Get \u0026#34;\u003c/span\u003esrc\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; }}{{- if eq (.Get \u0026#34;\u003c/span\u003ealign\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;) \u0026#34;\u003c/span\u003ecenter\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; }}#center{{- end }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;alt\u0026#34;\u003c/span\u003e) (\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;caption\u0026#34;\u003c/span\u003e) }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         alt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ with .Get \u0026#34;\u003c/span\u003ealt\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; }}{{ . }}{{ else }}{{ .Get \u0026#34;\u003c/span\u003ecaption\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; | markdownify| plainify }}{{ end }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;width\u0026#34;\u003c/span\u003e }} width\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e         {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e with \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;height\u0026#34;\u003c/span\u003e }} height\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ . }}\u0026#34;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;!--\u003c/span\u003e Closing img tag \u003cspan style=\"color:#f92672\"\u003e--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003epicture\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {{\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eGet \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;link\u0026#34;\u003c/span\u003e }}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/\u003c/span\u003ea\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e{{ end \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e}}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e使用方式：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e{{\u0026lt; figure src=\u0026ldquo;cover-code.png\u0026rdquo; alt=\u0026ldquo;cover.html code\u0026rdquo; width=\u0026ldquo;2020\u0026rdquo; height=\u0026ldquo;1468\u0026rdquo; \u0026gt;}}\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/fix-blog-cls/gtmetrix-result.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/fix-blog-cls/gtmetrix-result.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"gtmetrix-result.png\" width=\"1080\" height=\"394\" alt=\"gtmetrix-result\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e至此累计布局偏移(CLS)问题解决了，同时也支持了响应式图片。\u003c/p\u003e\n","date_published":"2022-08-20T07:27:22+08:00","tags":["博客优化","CLS","PagerMod"]},{"title":"将博客部署到Cloudflare Pages","id":"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/","url":"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/","summary":"\u003cp\u003e目前博客是部署到了\u003ccode\u003eGithub Pages\u003c/code\u003e上，具体实现见\u003ca href=\"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/\"\u003e博客架构说明\u003c/a\u003e。\u003c/p\u003e\n\u003ch4 id=\"缘由\"\u003e缘由\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eGithub Pages\u003c/code\u003e部署有一个问题，就是不支持\u003ccode\u003eHSTS\u003c/code\u003e。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHTTP Strict Transport Security（通常简称为HSTS）是一个安全功能，它告诉浏览器只能通过 HTTPS 访问当前资源，而不是HTTP。\u003c/p\u003e","content_html":"\u003cp\u003e目前博客是部署到了\u003ccode\u003eGithub Pages\u003c/code\u003e上，具体实现见\u003ca href=\"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/\"\u003e博客架构说明\u003c/a\u003e。\u003c/p\u003e\n\u003ch4 id=\"缘由\"\u003e缘由\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eGithub Pages\u003c/code\u003e部署有一个问题，就是不支持\u003ccode\u003eHSTS\u003c/code\u003e。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHTTP Strict Transport Security（通常简称为HSTS）是一个安全功能，它告诉浏览器只能通过 HTTPS 访问当前资源，而不是HTTP。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729232638.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729232638.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220729232638.png\" width=\"1080\" height=\"146\" alt=\"20220729232638\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e虽然\u003ccode\u003eGithub Pages\u003c/code\u003e提供了\u003ccode\u003eEnforce HTTPS\u003c/code\u003e的选项，开启后\u003ccode\u003ehttp\u003c/code\u003e请求会301跳转到\u003ccode\u003ehttps \u003c/code\u003e请求。\u003c/p\u003e\n\u003cp\u003e但是因为返回包缺少\u003ccode\u003eStrict-Transport-Security\u003c/code\u003e的Header头，导致HSTS校验失败。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729234321.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729234321.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220729234321.png\" width=\"941\" height=\"389\" alt=\"20220729234321\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e为了彻底支持\u003ccode\u003eHSTS\u003c/code\u003e，决定切换到\u003ccode\u003eCloudflare Pages\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"部署\"\u003e部署\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eCloudflare Pages\u003c/code\u003e部署非常简单，授权\u003ccode\u003eGithub\u003c/code\u003e仓库权限，配置好分支即可，这里不多介绍。\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003eGithub Pages\u003c/code\u003e上，\u003ccode\u003ecode\u003c/code\u003e分支保存原始文件，\u003ccode\u003emaster\u003c/code\u003e分支保存\u003ccode\u003ehugo\u003c/code\u003e构建后的文件。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729234310.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729234310.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220729234310.png\" width=\"1080\" height=\"648\" alt=\"20220729234310\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eCloudflare Pages\u003c/code\u003e这里生成分支选择\u003ccode\u003emaster\u003c/code\u003e，同时禁用其他分支的自动构建。\u003c/p\u003e\n\u003cp\u003e这样提交代码后，\u003ccode\u003egithub actions\u003c/code\u003e构建文件提交到\u003ccode\u003emaster\u003c/code\u003e分支，然后触发\u003ccode\u003eCloudflare Pages\u003c/code\u003e部署。\u003c/p\u003e\n\u003cp\u003e这里为什么没有采用\u003ccode\u003eCloudflare Pages\u003c/code\u003e的自动构建呢？因为很慢，构建一次要3分钟左右。\u003c/p\u003e\n\u003cp\u003e采用拉取\u003ccode\u003emaster\u003c/code\u003e构建好的文件的话，只需要7秒左右。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729234651.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729234651.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220729234651.png\" width=\"1080\" height=\"368\" alt=\"20220729234651\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch4 id=\"补齐header头\"\u003e补齐Header头\u003c/h4\u003e\n\u003cp\u003e部署好后，\u003ccode\u003eCloudflare Pages\u003c/code\u003e的返回也是没有\u003ccode\u003eStrict-Transport-Security\u003c/code\u003eHeader头的。\u003c/p\u003e\n\u003cp\u003e这里需要通过自定义Header头实现，增加\u003ccode\u003e_headers\u003c/code\u003e文件，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  strict\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003etransport\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003esecurity: max\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eage\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e31536000\u003c/span\u003e; includeSubDomains; preload\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729234942.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/20220729234942.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220729234942.png\" width=\"971\" height=\"282\" alt=\"20220729234942\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e至此\u003ccode\u003eHSTS\u003c/code\u003e搞定。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Strict-Transport-Security\"\u003eHSTS资料\u003c/a\u003e\u003c/p\u003e\n","date_published":"2022-07-29T23:16:01+08:00","tags":["cloudflare pages","github pages","hugo","cloudflare"]},{"title":"奥林匹克公园向日葵之旅","id":"https://liudon.com/posts/olympic-park-sunflower-tour/","url":"https://liudon.com/posts/olympic-park-sunflower-tour/","summary":"\u003cp\u003e媳妇有事回老家了，这两天自己带娃。\u003c/p\u003e\n\u003cp\u003e小区群里有人说奥林匹克公园的向日葵开了，适合拍照。\u003c/p\u003e\n\u003cp\u003e正好周六多云，没有太阳，出门遛娃。\u003c/p\u003e\n\u003cp\u003e带上我好久不用的相机，省得发霉了。\u003c/p\u003e","content_html":"\u003cp\u003e媳妇有事回老家了，这两天自己带娃。\u003c/p\u003e\n\u003cp\u003e小区群里有人说奥林匹克公园的向日葵开了，适合拍照。\u003c/p\u003e\n\u003cp\u003e正好周六多云，没有太阳，出门遛娃。\u003c/p\u003e\n\u003cp\u003e带上我好久不用的相机，省得发霉了。\u003c/p\u003e\n\u003cp\u003e以往都是去的南园，第一次来北园。\u003c/p\u003e\n\u003cp\u003e西门进入，沿着路往右走，一会就到。\u003c/p\u003e\n\u003cp\u003e人很多，估计大家都因为之前疫情在家憋疯了。\u003c/p\u003e\n\u003cp\u003e到了没多久，太阳又出来了，超级晒。\u003c/p\u003e\n\u003cp\u003e提醒一下，看见向日葵园后，继续往前走，前面有观景台，更适合拍照。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/olympic-park-sunflower-tour/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220725183817.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/olympic-park-sunflower-tour/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220725183817.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%be%ae%e4%bf%a1%e5%9b%be%e7%89%87_20220725183817.jpg\" width=\"800\" height=\"533\" alt=\"向日葵\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/olympic-park-sunflower-tour/IMG_3492.JPG_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/olympic-park-sunflower-tour/IMG_3492.JPG_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG_3492.JPG\" width=\"1080\" height=\"720\" alt=\"向日葵\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/olympic-park-sunflower-tour/IMG_3556.JPG_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/olympic-park-sunflower-tour/IMG_3556.JPG_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG_3556.JPG\" width=\"1080\" height=\"720\" alt=\"荷花\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\n\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/olympic-park-sunflower-tour/IMG_3549.JPG_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/olympic-park-sunflower-tour/IMG_3549.JPG_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG_3549.JPG\" width=\"1080\" height=\"720\" alt=\"荷叶上的蜻蜓\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","image":"https://liudon.com/posts/olympic-park-sunflower-tour/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220725183817.jpg","date_published":"2022-07-21T20:40:20+08:00","tags":["带着相机晒太阳","遛娃"]},{"title":"记第二次洗牙","id":"https://liudon.com/posts/%E8%AE%B0%E7%AC%AC%E4%BA%8C%E6%AC%A1%E6%B4%97%E7%89%99/","url":"https://liudon.com/posts/%E8%AE%B0%E7%AC%AC%E4%BA%8C%E6%AC%A1%E6%B4%97%E7%89%99/","summary":"\u003cp\u003e最近刷牙的时候，牙龈总是出血。\u003c/p\u003e\n\u003cp\u003e距离上一次洗牙，已经有好几年了，感觉又该去洗一下牙了。\u003c/p\u003e\n\u003cp\u003e上次跟媳妇两个人，在小区外面的私人诊所洗的，俩人花了1000多块钱。\u003c/p\u003e","content_html":"\u003cp\u003e最近刷牙的时候，牙龈总是出血。\u003c/p\u003e\n\u003cp\u003e距离上一次洗牙，已经有好几年了，感觉又该去洗一下牙了。\u003c/p\u003e\n\u003cp\u003e上次跟媳妇两个人，在小区外面的私人诊所洗的，俩人花了1000多块钱。\u003c/p\u003e\n\u003cp\u003e这次决定去医院看看，提前挂了号。\u003c/p\u003e\n\u003cp\u003e医生看过后，说得洗牙，不过当天只能先做洗牙前的检查，洗牙得预约。\u003c/p\u003e\n\u003cp\u003e开单子抽血检查，完事回家。\u003c/p\u003e\n\u003cp\u003e到了预约的日子，约的是4点，3点左右就到医院了。\u003c/p\u003e\n\u003cp\u003e15:57轮到我，进去一共20分钟完事。\u003c/p\u003e\n\u003cp\u003e我以为还有别的事项，结果医生说好了。\u003c/p\u003e\n\u003cp\u003e我说我感觉牙里卡着个东西，医生又拿起装备给我洗了一遍。\u003c/p\u003e\n\u003cp\u003e上次洗牙花了快1个小时，这也太快了。\u003c/p\u003e\n\u003cp\u003e洗牙费用380元，可以走医保报销。\u003c/p\u003e\n\u003cp\u003e以往都说医院洗牙贵，没成想外面私人的要更贵。\u003c/p\u003e\n","date_published":"2022-06-21T21:58:49+08:00","tags":[]},{"title":"记录2022年海淀幼升小","id":"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/","url":"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/","summary":"\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220525202612.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220525202612.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220525202612.png\" width=\"1080\" height=\"1262\" alt=\"20220525202612\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e18年的热点新闻，纳税千万孩子无法在北京上学。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e一直听说外地人在北京上学难，今年娃到了上小学的年纪，也算真实的体验了一把上学的难。\u003c/p\u003e","content_html":"\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220525202612.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220525202612.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220525202612.png\" width=\"1080\" height=\"1262\" alt=\"20220525202612\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e18年的热点新闻，纳税千万孩子无法在北京上学。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e一直听说外地人在北京上学难，今年娃到了上小学的年纪，也算真实的体验了一把上学的难。\u003c/p\u003e\n\u003cp\u003e提前在网上搜了一番资料，都是一些机构整理的信息。\u003c/p\u003e\n\u003cp\u003e没有找到具体分享的记录，自己整理了下，希望能帮助到其他人。\u003c/p\u003e\n\u003ch3 id=\"1-信息采集\"\u003e1. 信息采集\u003c/h3\u003e\n\u003cp\u003e5月5日，采集系统开放。\u003c/p\u003e\n\u003cp\u003e当天下午录入相关信息，提交网上审核。\u003c/p\u003e\n\u003ch3 id=\"2-网上审核\"\u003e2. 网上审核\u003c/h3\u003e\n\u003cp\u003e信息提交后，就开始了漫长的审核时间。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5月06日 户口信息审核通过\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5月14日 居住证审核通过\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5月16日 居住证明审核通过\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5月19日 工作证明审核通过\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220527202411.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220527202411.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220527202411.png\" width=\"1080\" height=\"683\" alt=\"20220527202411\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch3 id=\"3-线下审核\"\u003e3. 线下审核\u003c/h3\u003e\n\u003cp\u003e网上审核通过后，打印入学申请表，预约线下审核时间。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220527202458.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220527202458.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220527202458.png\" width=\"1080\" height=\"333\" alt=\"20220527202458\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这里还有一个插曲，本来以为线下审核是在社区居委会。\u003c/p\u003e\n\u003cp\u003e周六的时候，在小学入学群里聊天，有人说是在学区审核。\u003c/p\u003e\n\u003cp\u003e后来交流一番后，发现是自己理解错了。\u003c/p\u003e\n\u003cp\u003e这里是要先去社区审核盖章，然后再到学区交资料走线下审核。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5月22日 社区居委会审核盖章\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5月25日 到街道递交审核材料\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220525204053.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220525204053.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220525204053.png\" width=\"922\" height=\"1182\" alt=\"街道审核\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e如果你是外地集体户口，需要准备集体户口首页（复印件需要加盖公章）。\u003c/li\u003e\n\u003cli\u003e工作证明还需要提供满足时间要求的社保缴费记录。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"4-审核通过\"\u003e4. 审核通过\u003c/h3\u003e\n\u003cp\u003e5月27日，审核通过后，打印信息采集表。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220527202545.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220527202545.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220527202545.png\" width=\"868\" height=\"488\" alt=\"20220527202545\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch3 id=\"5-学校登记\"\u003e5. 学校登记\u003c/h3\u003e\n\u003cp\u003e6月1日对口学校发布入学登记通知书。\u003c/p\u003e\n\u003cp\u003e按通知书准备资料，到登记时间去学校交资料。\u003c/p\u003e\n\u003cp\u003e今年遇到疫情，改为线上邮件发送资料登记了。\u003c/p\u003e\n\u003ch3 id=\"6-填报志愿\"\u003e6. 填报志愿\u003c/h3\u003e\n\u003cp\u003e6月23日，海淀教育发文\u003ca href=\"https://mp.weixin.qq.com/s/UFoFysrhG2HkzREBpDVkuQ\"\u003e1911后填报志愿通知\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220629215840.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220629215840.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220629215840.png\" width=\"766\" height=\"1290\" alt=\"20220629215840\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e第一志愿锁定，其他志愿自己选择填报。\u003c/p\u003e\n\u003cp\u003e6月25日锁定，不允许再修改。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e网上消息，第一志愿锁定，说明有1911后名额，有机会选中。\u003c/p\u003e\n\u003cp\u003e租房的不需要填报志愿，等待派位。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"7-查看结果\"\u003e7. 查看结果\u003c/h3\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220629220638.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220629220638.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220629220638.png\" width=\"310\" height=\"298\" alt=\"20220629220638\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e6月29日15点，系统开放结果查询。\u003c/p\u003e\n\u003cp\u003e第一志愿录取，一直担心的调剂没有发生。\u003c/p\u003e\n\u003cp\u003e7月10日，收到教委短信，系统查询录取通知书。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220710085749.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220710085749.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220710085749.png\" width=\"1080\" height=\"282\" alt=\"20220710085749\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220710084342.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%AE%B0%E5%BD%952022%E5%B9%B4%E6%B5%B7%E6%B7%80%E5%B9%BC%E5%8D%87%E5%B0%8F/20220710084342.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220710084342.png\" width=\"1080\" height=\"449\" alt=\"20220710084342\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e历时1个多月的幼升小总算落地了。\u003c/p\u003e\n","date_published":"2022-05-25T20:10:01+08:00","tags":["幼升小","非京籍","北京幼升小"]},{"title":"Golang解析json的一个问题","id":"https://liudon.com/posts/golang%E8%A7%A3%E6%9E%90json%E7%9A%84%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98/","url":"https://liudon.com/posts/golang%E8%A7%A3%E6%9E%90json%E7%9A%84%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98/","summary":"\u003cp\u003e业务模块从\u003ccode\u003ephp\u003c/code\u003e迁移到\u003ccode\u003egolang\u003c/code\u003e下了，最近遇到一个golang下json解析的问题：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e请求接口，按返回包字段判断请求成功与否。\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e伪代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;encoding/json\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eCode\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e    \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;code\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eMsg\u003c/span\u003e  \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;msg\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 场景1，返回包符合接口要求\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`{\u0026#34;code\u0026#34;:100,\u0026#34;msg\u0026#34;:\u0026#34;failed\u0026#34;}`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnmarshal\u003c/span\u003e([]byte(\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;res=%+v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 解析正确，符合预期\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// res={Code:100 Msg:failed}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 场景2，返回包不符合接口要求，缺少相关字段\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e`{\u0026#34;retCode\u0026#34;:100,\u0026#34;retMsg\u0026#34;:\u0026#34;failed\u0026#34;}`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnmarshal\u003c/span\u003e([]byte(\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;res=%+v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 解析错误，不符合预期\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// res={Code:0 Msg:}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里由于接口地址配置错误，导致请求到其他接口，返回包不符合协议要求。\u003c/p\u003e","content_html":"\u003cp\u003e业务模块从\u003ccode\u003ephp\u003c/code\u003e迁移到\u003ccode\u003egolang\u003c/code\u003e下了，最近遇到一个golang下json解析的问题：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e请求接口，按返回包字段判断请求成功与否。\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e伪代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;encoding/json\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eCode\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e    \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;code\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eMsg\u003c/span\u003e  \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;msg\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 场景1，返回包符合接口要求\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`{\u0026#34;code\u0026#34;:100,\u0026#34;msg\u0026#34;:\u0026#34;failed\u0026#34;}`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnmarshal\u003c/span\u003e([]byte(\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;res=%+v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 解析正确，符合预期\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// res={Code:100 Msg:failed}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 场景2，返回包不符合接口要求，缺少相关字段\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e`{\u0026#34;retCode\u0026#34;:100,\u0026#34;retMsg\u0026#34;:\u0026#34;failed\u0026#34;}`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnmarshal\u003c/span\u003e([]byte(\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;res=%+v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 解析错误，不符合预期\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// res={Code:0 Msg:}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里由于接口地址配置错误，导致请求到其他接口，返回包不符合协议要求。\u003c/p\u003e\n\u003cp\u003e缺少\u003ccode\u003ecode\u003c/code\u003e字段，\u003ccode\u003eUnmarshal\u003c/code\u003e解析后，按默认值处理，所以\u003ccode\u003ecode\u003c/code\u003e为0，导致验证出错。\u003c/p\u003e\n\u003cp\u003e修正方案：\u003c/p\u003e\n\u003cp\u003e将\u003ccode\u003eCode\u003c/code\u003e字段定义为引用类型，通过判断地址是否为\u003ccode\u003enil\u003c/code\u003e来区分缺少字段的情况。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;encoding/json\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eCode\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e   \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;code\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eMsg\u003c/span\u003e  \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;msg\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 返回包符合接口要求\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`{\u0026#34;code\u0026#34;:100,\u0026#34;msg\u0026#34;:\u0026#34;failed\u0026#34;}`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnmarshal\u003c/span\u003e([]byte(\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;res=%+v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 解析正确，符合预期\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// res={Code:100 Msg:failed}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCode\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCode\u003c/span\u003e \u0026gt; \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;request failed\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 返回包不符合接口要求，缺少相关字段\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e`{\u0026#34;id\u0026#34;:1}`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnmarshal\u003c/span\u003e([]byte(\u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;res=%+v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 解析错误，不符合预期\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// res={Code:0 Msg:}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCode\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eres1\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCode\u003c/span\u003e \u0026gt; \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;request failed\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e参考资料：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.calhoun.io/how-to-determine-if-a-json-key-has-been-set-to-null-or-not-provided/\"\u003ehow-to-determine-if-a-json-key-has-been-set-to-null-or-not-provided\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://apoorv.blog/json-key-not-set-null-golang/\"\u003ejson-key-not-set-null-golang\u003c/a\u003e\u003c/p\u003e\n","date_published":"2022-05-20T21:18:23+08:00","tags":["golang"]},{"title":"疫情下的生活","id":"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E7%94%9F%E6%B4%BB/","url":"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E7%94%9F%E6%B4%BB/","summary":"\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E7%94%9F%E6%B4%BB/20220520-192500@2x.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E7%94%9F%E6%B4%BB/20220520-192500@2x.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220520-192500@2x.png\" width=\"1080\" height=\"692\" alt=\"20220520-192500@2x\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e不知不觉，北京这一波疫情已经一个月了，目前还是每天50例左右新增。\u003c/p\u003e\n\u003cp\u003e昨天看新闻，基本没有社会面新增了，感觉要解封了。\u003c/p\u003e\n\u003cp\u003e没想到今天直接被打脸，封控升级了。\u003c/p\u003e","content_html":"\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E7%94%9F%E6%B4%BB/20220520-192500@2x.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E7%94%9F%E6%B4%BB/20220520-192500@2x.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220520-192500@2x.png\" width=\"1080\" height=\"692\" alt=\"20220520-192500@2x\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e不知不觉，北京这一波疫情已经一个月了，目前还是每天50例左右新增。\u003c/p\u003e\n\u003cp\u003e昨天看新闻，基本没有社会面新增了，感觉要解封了。\u003c/p\u003e\n\u003cp\u003e没想到今天直接被打脸，封控升级了。\u003c/p\u003e\n\u003cp\u003e居家办公已经快两周了，也不知道这种日子还要多久。\u003c/p\u003e\n\u003cp\u003e在家使用Mac(13寸 m1)办公，屏幕太小，两周下来感觉眼睛要瞎了。\u003c/p\u003e\n\u003cp\u003e媳妇帮我想了个办法，投屏到电视上。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E7%94%9F%E6%B4%BB/20220520194127.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E7%94%9F%E6%B4%BB/20220520194127.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"20220520194127.png\" width=\"912\" height=\"1202\" alt=\"20220520194127\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e居家不出门，实在没动力收拾，现在胡子拉碴，一周可能收拾一次。\u003c/p\u003e\n\u003cp\u003e不知道这波还要多久。\u003c/p\u003e\n","date_published":"2022-05-20T19:17:57+08:00","tags":["疫情","北京"]},{"title":"整理下博客的一些调整","id":"https://liudon.com/posts/%E6%95%B4%E7%90%86%E4%B8%8B%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E8%B0%83%E6%95%B4/","url":"https://liudon.com/posts/%E6%95%B4%E7%90%86%E4%B8%8B%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E8%B0%83%E6%95%B4/","summary":"\u003cp\u003e新域名上线一段时间了，通过\u003ccode\u003eGoogle Search Console\u003c/code\u003e发现了一些问题，整理下最近进行的一些调整。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e更新主题版本，展示文章tag标签\n通过对比主题作者的网站，发现使用的不是最新代码。\u003c/p\u003e","content_html":"\u003cp\u003e新域名上线一段时间了，通过\u003ccode\u003eGoogle Search Console\u003c/code\u003e发现了一些问题，整理下最近进行的一些调整。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e更新主题版本，展示文章tag标签\n通过对比主题作者的网站，发现使用的不是最新代码。\u003c/p\u003e\n\u003cp\u003e通过调整\u003ccode\u003eGithub Actions\u003c/code\u003e命令解决：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- name: Checkout repository\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uses: actions/checkout@v2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - name: Checkout submodules\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    run: git submodule update --init --recursive --remote\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e修正404页面不生效的问题\n主题是自带了404.html文件的，但是部署后没有生成对应文件。\u003c/p\u003e\n\u003cp\u003e修改404.html文件内容后解决，具体原因没有深究，感觉是文件内容不是完整html导致。\u003c/p\u003e\n\u003cp\u003e可参考\u003ca href=\"https://github.com/Liudon/liudon.github.io/blob/code/layouts/404.html\"\u003e文件代码\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e两个域名导致的页面权重问题\n发现有些页面\u003ccode\u003eliudon.xyz\u003c/code\u003e收录后，\u003ccode\u003eliudon.com\u003c/code\u003e就不再收录。\u003c/p\u003e\n\u003cp\u003e为了规避这种收录问题，将\u003ccode\u003eliudon.xyz\u003c/code\u003e直接301到了\u003ccode\u003eliudon.com\u003c/code\u003e上。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e目前已调整完毕，观察后续收录情况。\u003c/p\u003e\n","date_published":"2022-05-13T18:20:52+08:00","tags":["博客","收录"]},{"title":"疫情下的五一假期","id":"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E4%BA%94%E4%B8%80%E5%81%87%E6%9C%9F/","url":"https://liudon.com/posts/%E7%96%AB%E6%83%85%E4%B8%8B%E7%9A%84%E4%BA%94%E4%B8%80%E5%81%87%E6%9C%9F/","summary":"\u003cp\u003e五一假期前一周，北京疫情又起，说是已经隐蔽传播一周了。\u003c/p\u003e\n\u003cp\u003e当天晚上大家就开始屯货了，晚上看着APP里可买的东西一点点没了。\u003c/p\u003e\n\u003cp\u003e说实话，出现几粒确诊没有慌，这么抢购搞的有点心慌了，也下单买了点东西。\u003c/p\u003e","content_html":"\u003cp\u003e五一假期前一周，北京疫情又起，说是已经隐蔽传播一周了。\u003c/p\u003e\n\u003cp\u003e当天晚上大家就开始屯货了，晚上看着APP里可买的东西一点点没了。\u003c/p\u003e\n\u003cp\u003e说实话，出现几粒确诊没有慌，这么抢购搞的有点心慌了，也下单买了点东西。\u003c/p\u003e\n\u003cp\u003e毕竟老话说的好，手中有粮，心里不慌。\u003c/p\u003e\n\u003cp\u003e第二天出去做核酸，特意去了趟超市，想着再买点肉，结果超市也是各种采购，东西都没了，空手而归。\u003c/p\u003e\n\u003cp\u003e工作上五一前有两个大版本的功能要发布，提前1周需求才提，节前这一周忙的要死，还赶上了疫情，好在赶在发布截止日总算发出去了。\u003c/p\u003e\n\u003cp\u003e就五一当天带娃去了家旁边的公园遛了下，这次轮滑滑的不错，一直玩到晚上7点才回家。\u003c/p\u003e\n\u003cp\u003e夏天到了，北京的杨絮、柳絮各种满天飞，出门真是受罪，其余时间都在家呆着了，偶尔下楼在小区玩会。\u003c/p\u003e\n\u003cp\u003e这个假期基本上每天核酸，感觉以后要常态化核酸了。\u003c/p\u003e\n\u003cp\u003e老家在假期里突然也疫情又起，县城整个封控了，不过老爸还是回到家了，过程稍微费了点劲。\u003c/p\u003e\n\u003cp\u003e突然发现今年的疫情貌似就没消停过，去年五一假期的时候在老家烧烤，今年还不知道什么时候能回家。\u003c/p\u003e\n\u003cp\u003e这疫情什么时候是个头啊……\u003c/p\u003e\n","date_published":"2022-05-05T20:22:23+08:00","tags":["疫情"]},{"title":"自己动手，更换thinkpad x1硬盘","id":"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/","url":"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/","summary":"\u003cp\u003e电脑突然没法用了，提示\u0026quot;A disk read error occurred\u0026quot;的错误。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/491650584526_.pic.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/491650584526_.pic.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"491650584526_.pic.jpg\" width=\"1080\" height=\"810\" alt=\"491650584526_.pic\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e多次重启也不行，感觉是硬盘挂了。\u003c/p\u003e\n\u003cp\u003e机器去年过保了，之前有过在售后维护的经历，费用不低，这次决定自己动手。\u003c/p\u003e","content_html":"\u003cp\u003e电脑突然没法用了，提示\u0026quot;A disk read error occurred\u0026quot;的错误。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/491650584526_.pic.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/491650584526_.pic.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"491650584526_.pic.jpg\" width=\"1080\" height=\"810\" alt=\"491650584526_.pic\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e多次重启也不行，感觉是硬盘挂了。\u003c/p\u003e\n\u003cp\u003e机器去年过保了，之前有过在售后维护的经历，费用不低，这次决定自己动手。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/WechatIMG64.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/WechatIMG64.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG64.jpeg\" width=\"1080\" height=\"1249\" alt=\"WechatIMG64\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e一共就5个螺丝，打开后盖。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/621650757850_.pic.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/621650757850_.pic.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"621650757850_.pic.jpg\" width=\"1080\" height=\"1250\" alt=\"621650757850_.pic\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e可以看到电池旁边的螺丝，拧下取出电池。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/631650757850_.pic.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/631650757850_.pic.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"631650757850_.pic.jpg\" width=\"1080\" height=\"1439\" alt=\"631650757850_.pic\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e拧开硬盘上的固定螺丝，取出硬盘。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/541650584531_.pic.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/541650584531_.pic.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"541650584531_.pic.jpg\" width=\"1080\" height=\"1441\" alt=\"541650584531_.pic\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e印象里硬盘还是那种又大又厚的样子，没想到现在都这么小一块了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/WechatIMG55.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/WechatIMG55.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG55.jpeg\" width=\"1080\" height=\"1441\" alt=\"WechatIMG55\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e我在京东买的\u003ca href=\"https://u.jd.com/Zdch2qO\"\u003e三星970 EVO Plus\u003c/a\u003e这款，顺利换上。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/611650757849_.pic.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%9B%B4%E6%8D%A2thinkpad-x1%E7%A1%AC%E7%9B%98/611650757849_.pic.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"611650757849_.pic.jpg\" width=\"1080\" height=\"1441\" alt=\"611650757849_.pic\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e重装系统，搞定，省了一笔，好开心。\u003c/p\u003e\n","date_published":"2022-04-22T08:04:18+08:00","tags":["thinkpad","SSD","硬盘","三星"]},{"title":"二刷百望山","id":"https://liudon.com/posts/%E4%BA%8C%E5%88%B7%E7%99%BE%E6%9C%9B%E5%B1%B1/","url":"https://liudon.com/posts/%E4%BA%8C%E5%88%B7%E7%99%BE%E6%9C%9B%E5%B1%B1/","summary":"\u003cp\u003e又是周末，娃约了小伙伴一起爬山。\u003c/p\u003e\n\u003cp\u003e百望山，二刷走起。\u003c/p\u003e\n\u003cp\u003e约好了9点半门口见面，早上睁眼8点了，赶紧起床洗漱吃饭。\u003c/p\u003e\n\u003cp\u003e出门晚了，还打不到车，快10点才到。\u003c/p\u003e\n\u003cp\u003e小伙伴和人爸爸已经先爬上去了，带着娃一路小跑，20分钟从大门爬到山上。\u003c/p\u003e","content_html":"\u003cp\u003e又是周末，娃约了小伙伴一起爬山。\u003c/p\u003e\n\u003cp\u003e百望山，二刷走起。\u003c/p\u003e\n\u003cp\u003e约好了9点半门口见面，早上睁眼8点了，赶紧起床洗漱吃饭。\u003c/p\u003e\n\u003cp\u003e出门晚了，还打不到车，快10点才到。\u003c/p\u003e\n\u003cp\u003e小伙伴和人爸爸已经先爬上去了，带着娃一路小跑，20分钟从大门爬到山上。\u003c/p\u003e\n\u003cp\u003e继续赶路爬楼梯，总算登上了观景台，俩小朋友终于见面了，一人奖励一个冰激凌。\u003c/p\u003e\n\u003cp\u003e这次来，山上明显绿了，花开的更多了，人比上次少多了。\u003c/p\u003e\n\u003cp\u003e下山后，又一起吃了个饭，自助吃的有点撑。\u003c/p\u003e\n\u003cp\u003e今天天气真好，视野相当不错，就是太晒了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E4%BA%8C%E5%88%B7%E7%99%BE%E6%9C%9B%E5%B1%B1/WechatIMG48.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E4%BA%8C%E5%88%B7%E7%99%BE%E6%9C%9B%E5%B1%B1/WechatIMG48.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG48.jpeg\" width=\"1080\" height=\"810\" alt=\"俯瞰北京\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E4%BA%8C%E5%88%B7%E7%99%BE%E6%9C%9B%E5%B1%B1/WechatIMG47.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E4%BA%8C%E5%88%B7%E7%99%BE%E6%9C%9B%E5%B1%B1/WechatIMG47.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG47.jpeg\" width=\"1080\" height=\"1441\" alt=\"不知名的树\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E4%BA%8C%E5%88%B7%E7%99%BE%E6%9C%9B%E5%B1%B1/WechatIMG46.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E4%BA%8C%E5%88%B7%E7%99%BE%E6%9C%9B%E5%B1%B1/WechatIMG46.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG46.jpeg\" width=\"1080\" height=\"810\" alt=\"山顶\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2022-04-17T22:57:41+08:00","tags":["爬山","遛娃"]},{"title":"带娃游颐和园","id":"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/","url":"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/","summary":"\u003cp\u003e上周的北海之行，本来是想划船的，可惜人太多没有划成，答应娃这周末带她去划船。\u003c/p\u003e\n\u003cp\u003e周六7点准时起床，得早点去省得人多排队。\u003c/p\u003e\n\u003cp\u003e8点半吃完饭洗漱完出发，特意带娃坐了一趟双层公交车 —— 二楼第一排观光区。\u003c/p\u003e","content_html":"\u003cp\u003e上周的北海之行，本来是想划船的，可惜人太多没有划成，答应娃这周末带她去划船。\u003c/p\u003e\n\u003cp\u003e周六7点准时起床，得早点去省得人多排队。\u003c/p\u003e\n\u003cp\u003e8点半吃完饭洗漱完出发，特意带娃坐了一趟双层公交车 —— 二楼第一排观光区。\u003c/p\u003e\n\u003cp\u003e路上不堵，40多分钟到站。\u003c/p\u003e\n\u003cp\u003e进园先去码头排队，人不太多，等了有十几分钟，终于轮到了。\u003c/p\u003e\n\u003cp\u003e总算开上了船，不过天气不太好，灰蒙蒙的。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG40.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG40.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG40.jpeg\" width=\"1080\" height=\"720\" alt=\"终于坐上了船\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e水上荡了1个小时，下船向佛香阁进发。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG41.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG41.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG41.jpeg\" width=\"1080\" height=\"1620\" alt=\"佛香阁\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e一路向上，终于登顶，园内风景一览无余。\u003c/p\u003e\n\u003cp\u003e下来后，又去逛了十七孔桥，逛了下湖心小岛。\u003c/p\u003e\n\u003cp\u003e回家又特意坐的双层公交，第一排观光区，哈哈。\u003c/p\u003e\n\u003cp\u003e一天下来1w多步，娃估计得更多，到家直接累摊。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG42.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG42.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG42.jpeg\" width=\"1080\" height=\"720\" alt=\"这是鸳鸯吧\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG43.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG43.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG43.jpeg\" width=\"1080\" height=\"1620\" alt=\"佛香阁\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG44.jpeg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%B8%A6%E5%A8%83%E6%B8%B8%E9%A2%90%E5%92%8C%E5%9B%AD/WechatIMG44.jpeg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WechatIMG44.jpeg\" width=\"1080\" height=\"1620\" alt=\"十七孔桥\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2022-04-11T00:37:55+08:00","tags":[]},{"title":"博客架构说明","id":"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/","url":"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/","summary":"\u003cp\u003e在拿到\u003ccode\u003eliudon.com\u003c/code\u003e域名前，手中已有两个域名：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eliudon.org\u003c/li\u003e\n\u003cli\u003eliudon.xyz\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%8d%9a%e5%ae%a2%e6%9e%b6%e6%9e%84.png\" width=\"653\" height=\"206\" alt=\"两套域名说明\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eliudon.org\u003c/code\u003e已经不再更新，仅作归档使用。\n\u003ccode\u003eliudon.xyz\u003c/code\u003e当时是静态博客流行，尝鲜使用。\u003c/p\u003e","content_html":"\u003cp\u003e在拿到\u003ccode\u003eliudon.com\u003c/code\u003e域名前，手中已有两个域名：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eliudon.org\u003c/li\u003e\n\u003cli\u003eliudon.xyz\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%8d%9a%e5%ae%a2%e6%9e%b6%e6%9e%84.png\" width=\"653\" height=\"206\" alt=\"两套域名说明\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eliudon.org\u003c/code\u003e已经不再更新，仅作归档使用。\n\u003ccode\u003eliudon.xyz\u003c/code\u003e当时是静态博客流行，尝鲜使用。\u003c/p\u003e\n\u003cp\u003e拿到\u003ccode\u003eliudon.com\u003c/code\u003e域名后，怎么部署博客成了个问题。\u003c/p\u003e\n\u003cp\u003e因为\u003ccode\u003egithub pages\u003c/code\u003e只能绑定一个自定义域名，当然可以通过创建另外一个项目，实现两套域名，但是同一个博客两个项目总感觉不太优雅。\u003c/p\u003e\n\u003cp\u003e经过一番资料查找，终于有了下面这套方案。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/%E5%8D%9A%E5%AE%A2%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E/%E5%8D%9A%E5%AE%A2%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"%e5%8d%9a%e5%ae%a2%e6%9e%84%e5%bb%ba%e6%b5%81%e7%a8%8b.png\" width=\"1037\" height=\"260\" alt=\"博客构建流程\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e通过\u003ccode\u003egithub actions\u003c/code\u003e 和 \u003ccode\u003enetlify\u003c/code\u003e 部署了两套自动化部署方案：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egithub actions\u003c/code\u003e部署到\u003ccode\u003egithub pages\u003c/code\u003e，绑定自定义域名\u003ccode\u003eliudon.com\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enetlify\u003c/code\u003e部署到\u003ccode\u003eipfs\u003c/code\u003e，通过\u003ccode\u003ecloudfare ipfs gateway\u003c/code\u003e解析到\u003ccode\u003eipfs\u003c/code\u003e资源，绑定自定义域名\u003ccode\u003eliudon.xyz\u003c/code\u003e。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e这里要说明一下，\u003ccode\u003eipfs\u003c/code\u003e目前访问延迟较大，这里仅作尝鲜使用。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehugo\u003c/code\u003e的\u003ccode\u003econfig.toml\u003c/code\u003e定义了网站域名，这里为了区分两套域名，在\u003ccode\u003enetlify\u003c/code\u003e部署时，对配置文件做了修改，保证两套域名访问各自页面，具体可参考\u003ca href=\"https://github.com/Liudon/liudon.github.io/blob/code/netlify.toml\"\u003egithub文件内容\u003c/a\u003e。\u003c/p\u003e\n","date_published":"2022-04-10T20:41:57+08:00","tags":[]},{"title":"难得的清明假期","id":"https://liudon.com/posts/%E9%9A%BE%E5%BE%97%E7%9A%84%E6%B8%85%E6%98%8E%E5%81%87%E6%9C%9F/","url":"https://liudon.com/posts/%E9%9A%BE%E5%BE%97%E7%9A%84%E6%B8%85%E6%98%8E%E5%81%87%E6%9C%9F/","summary":"\u003cp\u003e前面有写到，被隔离了一周，好在赶在假期开始前解除了隔离。\u003c/p\u003e\n\u003cp\u003e趁着这次难得的假期，外出放松一下。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e爬百望山。\u003c/p\u003e\n\u003cp\u003e娃是第一次爬山，百望山不高，适合带娃体验爬山，我也从13、14年之后没再爬过山了。\u003c/p\u003e","content_html":"\u003cp\u003e前面有写到，被隔离了一周，好在赶在假期开始前解除了隔离。\u003c/p\u003e\n\u003cp\u003e趁着这次难得的假期，外出放松一下。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e爬百望山。\u003c/p\u003e\n\u003cp\u003e娃是第一次爬山，百望山不高，适合带娃体验爬山，我也从13、14年之后没再爬过山了。\u003c/p\u003e\n\u003cp\u003e进园后，选择大路往上爬，中间走了一段山间台阶路。\u003c/p\u003e\n\u003cp\u003e一路走走停停，补充能量，估计有半个小时，我们就登顶了。\u003c/p\u003e\n\u003cp\u003e山上风有点大，视野不错，可以直接看到互联网的核心公司。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e游北海公园\u003c/p\u003e\n\u003cp\u003e本来是想着去公园划船，结果到了之后发现排队的人太多了，于是放弃，改为游白塔。\u003c/p\u003e\n\u003cp\u003e我们是从北门进的园，然后一路向西去码头打算划船，绕着园子继续往南走。\u003c/p\u003e\n\u003cp\u003e一路走到了南门，心想这出去了还咋去白塔，难道要再走回去？\u003c/p\u003e\n\u003cp\u003e问了门口保安，说是可以出去往东走，从南门再进去。\u003c/p\u003e\n\u003cp\u003e进去后，要爬好几层楼梯才能上到白塔平台，一览园内风景。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/%E9%9A%BE%E5%BE%97%E7%9A%84%E6%B8%85%E6%98%8E%E5%81%87%E6%9C%9F/IMG39.png_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/%E9%9A%BE%E5%BE%97%E7%9A%84%E6%B8%85%E6%98%8E%E5%81%87%E6%9C%9F/IMG39.png_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"IMG39.png\" width=\"1080\" height=\"810\" alt=\"北海白塔\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e希望疫情尽快散去，恢复到正常的生活。\u003c/p\u003e\n","date_published":"2022-04-06T08:06:19+08:00","tags":[]},{"title":"十一年的等待，终于拿到了liudon.com域名","id":"https://liudon.com/posts/%E5%8D%81%E4%B8%80%E5%B9%B4%E7%9A%84%E7%AD%89%E5%BE%85%E7%BB%88%E4%BA%8E%E6%8B%BF%E5%88%B0%E4%BA%86liudon.com%E5%9F%9F%E5%90%8D/","url":"https://liudon.com/posts/%E5%8D%81%E4%B8%80%E5%B9%B4%E7%9A%84%E7%AD%89%E5%BE%85%E7%BB%88%E4%BA%8E%E6%8B%BF%E5%88%B0%E4%BA%86liudon.com%E5%9F%9F%E5%90%8D/","summary":"\u003cp\u003e在\u003ca href=\"https://liudon.com/about\"\u003e关于\u003c/a\u003e部分，有写域名的来历。\u003c/p\u003e\n\u003cp\u003e当时\u003ccode\u003eliudon.com\u003c/code\u003e已经被注册，所以只好注册了\u003ccode\u003eliudon.org\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e2011年注册的\u003ccode\u003eliudon.org\u003c/code\u003e，最早用\u003ccode\u003ewordpress\u003c/code\u003e搭建了博客。\u003c/p\u003e","content_html":"\u003cp\u003e在\u003ca href=\"https://liudon.com/about\"\u003e关于\u003c/a\u003e部分，有写域名的来历。\u003c/p\u003e\n\u003cp\u003e当时\u003ccode\u003eliudon.com\u003c/code\u003e已经被注册，所以只好注册了\u003ccode\u003eliudon.org\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e2011年注册的\u003ccode\u003eliudon.org\u003c/code\u003e，最早用\u003ccode\u003ewordpress\u003c/code\u003e搭建了博客。\u003c/p\u003e\n\u003cp\u003e这是当时的第一篇文章，\u003ca href=\"https://liudon.org/1.html\"\u003eHello world\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e从2011年，到2019年，中间断断续续的在更新着，博客程序也从\u003ccode\u003ewordpress\u003c/code\u003e转到了\u003ccode\u003etypecho\u003c/code\u003e，再后来开始流行静态页博客，又转到了hugo下。\u003c/p\u003e\n\u003cp\u003e在这中间，一直想要拿到\u003ccode\u003eliudon.com\u003c/code\u003e域名。\u003c/p\u003e\n\u003cp\u003e看网站内容，应该是个德国乐队的网站，这里能看到网站\u003ca href=\"http://web.archive.org/web/20210621212816/http://www.liudon.com/\"\u003e最后的信息\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e3月10日的时候，偶然看到群里有在说域名，于是又搜索了一番，发现域名上了阿里云域名拍卖，购买的时候提示卖家已下家。\u003c/p\u003e\n\u003cp\u003e到国外域名商上查了一下，\u003ccode\u003egodaddy\u003c/code\u003e提供代购，\u003ccode\u003ename\u003c/code\u003e提示为高级域名，可以购买。\u003c/p\u003e\n\u003cp\u003e看\u003ccode\u003earchive.org\u003c/code\u003e上的信息，2021年11月的时候服务不可用了，不知道发生了什么。\u003c/p\u003e\n\u003cp\u003e机不可失，时不再来，立马下单。\u003c/p\u003e\n\u003cp\u003e接下来就是漫长的等待了，系统显示需要5-10个工作日才能完成交易。\u003c/p\u003e\n\u003cp\u003e同时我发现他们服务条款写着，高级域名不支持退款，whois信息一直不变，担心打水漂。\u003c/p\u003e\n\u003cp\u003e期间有一天晚上11点联系客户，说是已经在加快处理。\u003c/p\u003e\n\u003cp\u003e过了10天后，交易还没完成，有点放弃了。\u003c/p\u003e\n\u003cp\u003e3月24日晚上，再次查whois，发现信息有变，登录name，发现订单已完成。\u003c/p\u003e\n\u003cp\u003e现在这个域名终于属于我了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eliudon.org 老站，备份，不再更新\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eliudon.com -\u0026gt; github pages\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eliudon.xyz -\u0026gt; netfily -\u0026gt; ipfs\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date_published":"2022-04-01T01:24:05+08:00","tags":[]},{"title":"被隔离的一周","id":"https://liudon.com/posts/%E8%A2%AB%E9%9A%94%E7%A6%BB%E7%9A%84%E4%B8%80%E5%91%A8/","url":"https://liudon.com/posts/%E8%A2%AB%E9%9A%94%E7%A6%BB%E7%9A%84%E4%B8%80%E5%91%A8/","summary":"\u003cp\u003e从没有想过疫情会离自己这么近，记录一下。\u003c/p\u003e\n\u003cp\u003e周一的时候说是有确诊同学来过公司，下午组织全员核酸，做完核酸立马回家。\u003c/p\u003e\n\u003cp\u003e周二早上全员核酸阴性，继续到公司上班。\u003c/p\u003e","content_html":"\u003cp\u003e从没有想过疫情会离自己这么近，记录一下。\u003c/p\u003e\n\u003cp\u003e周一的时候说是有确诊同学来过公司，下午组织全员核酸，做完核酸立马回家。\u003c/p\u003e\n\u003cp\u003e周二早上全员核酸阴性，继续到公司上班。\u003c/p\u003e\n\u003cp\u003e晚上8点10分刚和同事上地铁，部门群里有人说我们楼有人确诊，过了10分钟，说是大楼管控了，不让出楼了。\u003c/p\u003e\n\u003cp\u003e封在楼里的同学统一做核酸，结果出来后才能回家，好多人在公司过了夜。\u003c/p\u003e\n\u003cp\u003e周三到公司集体核酸，做完继续居家办公，今天开始公安局、社区开始联系确认信息，公司要求所有人员居家办公，社区反馈需要居家隔离。\u003c/p\u003e\n\u003cp\u003e头几天还说对门上封条了，没成想这次轮到自己了。\u003c/p\u003e\n\u003cp\u003e到03/31日，隔离解除，健康宝恢复正常。\u003c/p\u003e\n\u003cp\u003e第一次体验到健康宝显示弹窗，然后又显示居家隔离。\u003c/p\u003e\n\u003cp\u003e第一次体验到被贴封条上门磁。\u003c/p\u003e\n\u003cp\u003e第一次体验到鼻拭子，尤其解封前最后一次核酸，双鼻孔。\u003c/p\u003e\n","date_published":"2022-04-01T01:20:39+08:00","tags":["疫情"]},{"title":"mysql中字符串和整型自动转换的问题","id":"https://liudon.com/posts/strings-and-numbers-in-mysql/","url":"https://liudon.com/posts/strings-and-numbers-in-mysql/","summary":"\u003cp\u003e表结构如下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edesc info;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e+-------+-----------------+------+-----+---------+----------------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Field \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Type            \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Null \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Key \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Default \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Extra          \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e+-------+-----------------+------+-----+---------+----------------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e id    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e) unsigned \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e NO   \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e PRI \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e NULL    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e auto_increment \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e name  \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e varchar(\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e)     \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e YES  \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e     \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e NULL    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e                \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e+-------+-----------------+------+-----+---------+----------------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e rows \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e set (\u003cspan style=\"color:#ae81ff\"\u003e0.00\u003c/span\u003e sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行sql.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003einsert into info values (\u0026#39;\u0026#39;, \u0026#39;xxx\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003einsert into info values (\u0026#39;\u0026#39;, \u0026#39;yyy\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查询记录.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eselect * from info;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| id | name |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|  1 | xxx  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|  2 | yyy  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2 rows in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行下面sql.\u003c/p\u003e","content_html":"\u003cp\u003e表结构如下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edesc info;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e+-------+-----------------+------+-----+---------+----------------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Field \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Type            \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Null \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Key \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Default \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e Extra          \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e+-------+-----------------+------+-----+---------+----------------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e id    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e) unsigned \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e NO   \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e PRI \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e NULL    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e auto_increment \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e name  \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e varchar(\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e)     \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e YES  \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e     \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e NULL    \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e                \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e+-------+-----------------+------+-----+---------+----------------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e rows \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e set (\u003cspan style=\"color:#ae81ff\"\u003e0.00\u003c/span\u003e sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行sql.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003einsert into info values (\u0026#39;\u0026#39;, \u0026#39;xxx\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003einsert into info values (\u0026#39;\u0026#39;, \u0026#39;yyy\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查询记录.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eselect * from info;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| id | name |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|  1 | xxx  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|  2 | yyy  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2 rows in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行下面sql.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eselect * from info where id = 1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eselect * from info where id = \u0026#39;1aaaa\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e你先想想结果会是什么。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eselect * from info where id = 1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| id | name |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|  1 | xxx  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e1 row in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eselect * from info where id = \u0026#39;1aaaa\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| id | name |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|  1 | xxx  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----+------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e1 row in set, 1 warning (0.01 sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e两个sql都查到了id = 1的记录，唯一的区别在于第二个sql有一个warning错误。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow warnings;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+---------+------+-------------------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| Level   | Code | Message                                   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+---------+------+-------------------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| Warning | 1292 | Truncated incorrect DOUBLE value: \u0026#39;1aaaa\u0026#39; |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+---------+------+-------------------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e1 row in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003emysql在查询时，会根据字段类型进行转换，这里\u003ccode\u003e1aaaa\u003c/code\u003e被转为了\u003ccode\u003e1\u003c/code\u003e。\u003c/p\u003e\n","date_published":"2020-12-14T18:47:29+08:00","tags":["mysql"]},{"title":"一次惊心动魄的Mysql更新操作","id":"https://liudon.com/posts/%E4%B8%80%E6%AC%A1%E6%83%8A%E5%BF%83%E5%8A%A8%E9%AD%84%E7%9A%84mysql%E6%9B%B4%E6%96%B0%E6%93%8D%E4%BD%9C/","url":"https://liudon.com/posts/%E4%B8%80%E6%AC%A1%E6%83%8A%E5%BF%83%E5%8A%A8%E9%AD%84%E7%9A%84mysql%E6%9B%B4%E6%96%B0%E6%93%8D%E4%BD%9C/","summary":"\u003ch4 id=\"问题描述\"\u003e问题描述\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# 表结构\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMySQL \u0026gt; desc user_packages;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----------------+---------------------+------+-----+---------------------+----------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| Field          | Type                | Null | Key | Default             | Extra          |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----------------+---------------------+------+-----+---------------------+----------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_id          | bigint(20) unsigned | NO   | PRI | NULL                | auto_increment |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| start_date     | date                | NO   |     | NULL                |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| end_date       | date                | NO   |     | NULL                |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_created     | datetime            | NO   | MUL | 0000-00-00 00:00:00 |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_updated     | datetime            | NO   |     | 0000-00-00 00:00:00 |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----------------+---------------------+------+-----+---------------------+----------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5 rows in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMySQL \u0026gt; select * from user_packages limit 5;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_id | start_date | end_date   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   185 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   186 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   187 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   188 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   189 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5 rows in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"操作过程\"\u003e操作过程\u003c/h4\u003e\n\u003cp\u003e需要更新某条记录的\u003ccode\u003eend_date\u003c/code\u003e字段，执行sql如下：\u003c/p\u003e","content_html":"\u003ch4 id=\"问题描述\"\u003e问题描述\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# 表结构\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMySQL \u0026gt; desc user_packages;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----------------+---------------------+------+-----+---------------------+----------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| Field          | Type                | Null | Key | Default             | Extra          |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----------------+---------------------+------+-----+---------------------+----------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_id          | bigint(20) unsigned | NO   | PRI | NULL                | auto_increment |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| start_date     | date                | NO   |     | NULL                |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| end_date       | date                | NO   |     | NULL                |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_created     | datetime            | NO   | MUL | 0000-00-00 00:00:00 |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_updated     | datetime            | NO   |     | 0000-00-00 00:00:00 |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+----------------+---------------------+------+-----+---------------------+----------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5 rows in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMySQL \u0026gt; select * from user_packages limit 5;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_id | start_date | end_date   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   185 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   186 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   187 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   188 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   189 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e5 rows in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"操作过程\"\u003e操作过程\u003c/h4\u003e\n\u003cp\u003e需要更新某条记录的\u003ccode\u003eend_date\u003c/code\u003e字段，执行sql如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMySQL \u0026gt; update user_packages set end_date = \u0026#39;2020-06-06\u0026#39; and up_id = 189 limit 1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eQuery OK, 1 row affected, 1 warning (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRows matched: 1  Changed: 1  Warnings: 1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行完，发现sql写错了！！！！\u003c/p\u003e\n\u003cp\u003e正确的sql应该是：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eupdate user_packages set end_date = \u0026#39;2020-06-06\u0026#39; where up_id = 189 limit 1;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e误把\u003ccode\u003ewhere\u003c/code\u003e写成了\u003ccode\u003eand\u003c/code\u003e，还好指定了\u003ccode\u003elimit = 1\u003c/code\u003e，只操作了一条记录。\u003c/p\u003e\n\u003ch4 id=\"回滚\"\u003e回滚\u003c/h4\u003e\n\u003cp\u003e回滚的前提，要先找到更新的那条记录。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eup_id\u003c/code\u003e为表的主键，更新前表里已经有这条记录了，主键不能重复，感觉语句应该没有执行成功。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMySQL \u0026gt; select * from user_packages where up_id = 189;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_id | start_date | end_date   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   189 | 2018-04-01 | 2018-06-30 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e1 rows in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行查询语句，表里确实也只有这一条\u003ccode\u003eup_id=189\u003c/code\u003e的记录。\u003c/p\u003e\n\u003cp\u003e感觉这个\u003ccode\u003eupdate\u003c/code\u003e语句应该没执行成功，但是没执行成功应该报错的呀。\u003c/p\u003e\n\u003cp\u003e这个时候把希望放到了语句结果里的\u003ccode\u003eWarnings: 1\u003c/code\u003e，是不是没执行成功呢。\u003c/p\u003e\n\u003cp\u003e因为紧接着又执行了其他语句，所以也无法通过\u003ccode\u003eshow warnings\u003c/code\u003e查看具体的错误信息了。\u003c/p\u003e\n\u003cp\u003e那么这条语句到底执行成功了吗？如果执行成功，那么修改的是哪条记录呢？\u003c/p\u003e\n\u003cp\u003e这里通过一番查找，终于定位到了记录。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eAND\u003c/code\u003e分隔符，在mysql语句里优先级最高。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eupdate user_packages set end_date = \u0026#39;2020-06-06\u0026#39; and up_id = 189 limit 1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e等效为\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eupdate user_packages set end_date = (\u0026#39;2020-06-06\u0026#39; and up_id = 189) limit 1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e即\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eupdate user_packages set end_date = 0 limit 1;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e因为\u003ccode\u003eend_date\u003c/code\u003e字段为\u003ccode\u003edate\u003c/code\u003e类型，所以写入表后的记录为\u003ccode\u003e0000-00-00\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMySQL \u0026gt; select * from user_packages where end_date = \u0026#39;0000-00-00\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| up_id | start_date | end_date   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|   185 | 2018-04-01 | 0000-00-00 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+-------+------------+------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e1 rows in set (0.00 sec)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e好在这次只更新了一条记录，否则后果无法想象。\u003c/p\u003e\n\u003cp\u003e切记不要在现网直接操作DB。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e相关资料：\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://wing324.github.io/2016/08/25/%E4%B8%80%E4%B8%AA%E6%88%91%E8%AE%A4%E4%B8%BA%E6%98%AFbug%E7%9A%84UPDATE%E8%AF%AD%E5%8F%A5/\"\u003e一个我认为是bug的UPDATE语句\u003c/a\u003e\u003c/p\u003e\n","date_published":"2020-05-19T17:16:53+08:00","tags":["mysql"]},{"title":"如何在北京公积金网站上修改婚姻状况","id":"https://liudon.com/posts/how-to-modify-marital-status/","url":"https://liudon.com/posts/how-to-modify-marital-status/","summary":"\u003cblockquote\u003e\n\u003cp\u003e关于取消住房公积金提取业务纸质申请表及部分业务网上办结的公告\u003c/p\u003e\n\u003cp\u003e时间：2020年01月08日\u003c/p\u003e\n\u003cp\u003e来源：http://gjj.beijing.gov.cn/web/zwgk/_300583/zxzysx/675803/index.html\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003e关于取消住房公积金提取业务纸质申请表及部分业务网上办结的公告\u003c/p\u003e\n\u003cp\u003e时间：2020年01月08日\u003c/p\u003e\n\u003cp\u003e来源：http://gjj.beijing.gov.cn/web/zwgk/_300583/zxzysx/675803/index.html\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e1月8日，北京公积金中心发文，从1月10日开始可以网上办理公积金提取了。\u003c/p\u003e\n\u003cp\u003e这里单独讲一下外地领证的情况下，如何修改婚姻状况。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e进入提取页面，默认显示为未说明的婚姻状况。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/f7HvbKlitaOm1T2.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/f7HvbKlitaOm1T2.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"f7HvbKlitaOm1T2.jpg\" width=\"1080\" height=\"127\" alt=\"QQ截图20200117170836.jpg\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e点击婚姻状况，选择已婚。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/VYnKduoHTtzDw4f.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/VYnKduoHTtzDw4f.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"VYnKduoHTtzDw4f.jpg\" width=\"1080\" height=\"154\" alt=\"QQ截图20200117170917.jpg\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e可以看到婚姻状态相关的输入框都为灰色，不可修改。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e点击婚姻信息修改按钮，会弹出一个民政校验的弹窗，因为我是外地领证，这里查不到信息。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/WpV28uBMvjyzPJN.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/WpV28uBMvjyzPJN.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"WpV28uBMvjyzPJN.jpg\" width=\"1080\" height=\"363\" alt=\"QQ截图20200117171149.jpg\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e注意图片右下角还是只有一个婚姻信息修改按钮。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e点击弹窗里的确认按钮。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/kMhnwRzgtrNOFAI.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/kMhnwRzgtrNOFAI.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"kMhnwRzgtrNOFAI.jpg\" width=\"1080\" height=\"158\" alt=\"QQ截图20200117171236.jpg\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e这下婚姻状况相关的输入框都可以填写了。\u003c/p\u003e\n\u003cp\u003e另外图片右下角里多了一个上传结婚证按钮。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e填写完信息后，点击上传结婚证按钮。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/fohyvH3iGaTtm1n.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/how-to-modify-marital-status/fohyvH3iGaTtm1n.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"fohyvH3iGaTtm1n.jpg\" width=\"1080\" height=\"541\" alt=\"QQ截图20200117171252.jpg\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e按说明上传两张结婚证照片，点击确认即可。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e其余的按\u003ca href=\"http://gjj.beijing.gov.cn/web/bsznx/386727/386730/386732/index.html\"\u003e公积金官网文档\u003c/a\u003e操作，最后提交即可。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e关于提取时间，我是前一天中午申请，第二天下午就到账了，效率还是很棒的。\u003c/p\u003e\n","date_published":"2020-01-17T17:14:32+08:00","tags":["公积金"]},{"title":"PHP7.2编译安装后没有php.ini文件的问题","id":"https://liudon.com/posts/php7.2%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E5%90%8E%E6%B2%A1%E6%9C%89php.ini%E6%96%87%E4%BB%B6/","url":"https://liudon.com/posts/php7.2%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E5%90%8E%E6%B2%A1%E6%9C%89php.ini%E6%96%87%E4%BB%B6/","summary":"\u003cp\u003e下载PHP7.2源码，编译安装。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]# php -v\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePHP 7.2.25 (cli) (built: Nov 26 2019 19:33:23) ( NTS )\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCopyright (c) 1997-2018 The PHP Group\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e安装Swoole。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ephpize \u0026amp;\u0026amp; \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./configure \u0026amp;\u0026amp; \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake \u0026amp;\u0026amp; make install\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e安装完，准备修改\u003ccode\u003ephp.ini\u003c/code\u003e文件，结果没找到。\u003c/p\u003e","content_html":"\u003cp\u003e下载PHP7.2源码，编译安装。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]# php -v\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePHP 7.2.25 (cli) (built: Nov 26 2019 19:33:23) ( NTS )\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCopyright (c) 1997-2018 The PHP Group\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e安装Swoole。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ephpize \u0026amp;\u0026amp; \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./configure \u0026amp;\u0026amp; \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake \u0026amp;\u0026amp; make install\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e安装完，准备修改\u003ccode\u003ephp.ini\u003c/code\u003e文件，结果没找到。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]# ll /usr/local/services/php/etc/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etotal 88\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- 1 root root  1364 Nov 26 19:34 pear.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- 1 root root  4508 Nov 26 19:34 php-fpm.conf.default\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edrwxr-xr-x 2 root root  4096 Nov 26 19:34 php-fpm.d\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]# php -i | grep \u0026#34;Loaded Confi\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLoaded Configuration File =\u0026gt; (none)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这是什么鬼，居然没有\u003ccode\u003ephp.ini\u003c/code\u003e文件。\u003c/p\u003e\n\u003cp\u003e原来PHP源码里提供了两个\u003ccode\u003ephp.ini\u003c/code\u003e文件，你需要按需拷贝到你的PHP的目录下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]# ll ../php-7.2.25 | grep ini\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-rw-r--  1 root root   71232 Nov 20 23:11 php.ini-development\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-rw-r--  1 root root   71413 Nov 20 23:11 php.ini-production\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e拷贝后。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]# php -i | grep \u0026#34;Loaded Confi\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLoaded Configuration File =\u0026gt; /usr/local/services/php/etc/php.ini\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_73_135_centos ~/swoole-src-4.4.12]#\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date_published":"2019-11-26T19:56:18+08:00","tags":["php"]},{"title":"检测网站支持的SSL/TLS协议版本","id":"https://liudon.com/posts/how-to-check-what-ssl-tls-versions-are-available-for-a-website/","url":"https://liudon.com/posts/how-to-check-what-ssl-tls-versions-are-available-for-a-website/","summary":"\u003cblockquote\u003e\n\u003cp\u003eChrome 72及以上版本不支持TLS 1.0和TLS 1.1，访问TLS 1.0或1.1证书的站点会告警，但不阻止用户访问站点。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e为了解决Chrome的这个问题，今天升级了下Nginx的TLS协议版本，这里记录一下如何检测支持的协议版本。\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003eChrome 72及以上版本不支持TLS 1.0和TLS 1.1，访问TLS 1.0或1.1证书的站点会告警，但不阻止用户访问站点。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e为了解决Chrome的这个问题，今天升级了下Nginx的TLS协议版本，这里记录一下如何检测支持的协议版本。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e检测是否支持TLSv1\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl s_client -connect [ip or 域名]:443 -tls1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e检测是否支持TLSv1.1\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl s_client -connect [ip or 域名]:443 -tls1_1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e检测是否支持TLSv1.2\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl s_client -connect [ip or 域名]:443 -tls1_2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e参考资料：\u003ca href=\"https://support.plesk.com/hc/en-us/articles/115004991834-How-to-check-what-SSL-TLS-versions-are-available-for-a-website-\"\u003eHow to check what SSL/TLS versions are available for a website?\u003c/a\u003e\u003c/p\u003e\n","date_published":"2019-11-14T14:48:08+08:00","tags":["nginx","ssl"]},{"title":"记一次难忘的手术经历","id":"https://liudon.com/posts/an-unforgettable-surgical-experience/","url":"https://liudon.com/posts/an-unforgettable-surgical-experience/","summary":"有痔青年的手术经历","content_html":"\u003cp\u003e俗话说的好，十人九痔。这九个人里就有我一个。 😂\u003c/p\u003e\n\u003cp\u003e去年因为痔疮去过一趟医院，医生当时建议手术。\u003c/p\u003e\n\u003cp\u003e后来用了点药，没啥症状了，就不放在心上了。\u003c/p\u003e\n\u003cp\u003e结果前两天公司团建吃了点辣，痔疮又犯了，大便拉不出来，憋的难受。\u003c/p\u003e\n\u003cp\u003e第二天赶紧上医院检查，先上开塞露通便，通完舒服多了。\u003c/p\u003e\n\u003cp\u003e医生检查完，让住院手术，这次狠了狠心，手术做掉，一了百了。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e10/15住院\u003c/li\u003e\n\u003cli\u003e10/16手术\u003c/li\u003e\n\u003cli\u003e10/22出院\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e上一次手术是在10年前了，全麻，什么都不知道。\u003c/p\u003e\n\u003cp\u003e这次是局麻，上手术台后，医生往腰上打了一针，很疼。\u003c/p\u003e\n\u003cp\u003e过了10分钟左右，肛门已经使不上劲了，开始手术。\u003c/p\u003e\n\u003cp\u003e过程一直感觉有往里打气，东西插进去。\u003c/p\u003e\n\u003cp\u003e医生说有用镇静，后来越来越困，感觉要晕过去，不过还是撑着没睡。\u003c/p\u003e\n\u003cp\u003e出来后，整个下午下半身都是麻的，没啥精神，事后就记得媳妇坐在我对面。\u003c/p\u003e\n\u003cp\u003e术后6个小时内要小便，不然就得插尿管。\u003c/p\u003e\n\u003cp\u003e第二天开始喝流食，然后就是每天医生给换药。\u003c/p\u003e\n\u003cp\u003e第三天开始大便，伤口那个痛啊。 😭😭😭\u003c/p\u003e\n\u003cp\u003e后来学会在热水里泡着拉，感觉舒服了点。\u003c/p\u003e\n\u003cp\u003e每天都要担心大便，担心不拉，或者担心拉的太多。\u003c/p\u003e\n\u003cp\u003e出院后第二天，早上大便一盆血，以为是大出血，把媳妇叫回来直奔医院。\u003c/p\u003e\n\u003cp\u003e到医院病房，主治医生不在，找了个其他医生给检查，说是有点出血。\u003c/p\u003e\n\u003cp\u003e检查的时候塞了个肛门镜，这玩意实在是痛苦。\u003c/p\u003e\n\u003cp\u003e然后说病房没工具，上门诊处理吧。然后我就拖着身子，走到门诊。\u003c/p\u003e\n\u003cp\u003e主治医生说没啥大事，其实可以不处理，不过你也是来医院了，还是处理一下吧。\u003c/p\u003e\n\u003cp\u003e处理的时候，又塞了个肛门镜，然后往屁眼上打了三针封闭，想死的心都有了。\u003c/p\u003e\n\u003cp\u003e回家后，继续卧床休息，每天换药。\u003c/p\u003e\n\u003cp\u003e朋友们，请一定要好好对你的🌻。\u003c/p\u003e\n","date_published":"2019-10-28T19:03:31+08:00","tags":[]},{"title":"十一假期经历","id":"https://liudon.com/posts/chinese-national-day/","url":"https://liudon.com/posts/chinese-national-day/","summary":"\u003cp\u003e今年的十一火车票非常难抢，12306的候补订单，一直等到时间截止也没订上票。\u003c/p\u003e\n\u003cp\u003e只好请了2天假，提前回家了，给自己也放个假休息一下。\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e回家的几个经历：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e家里的老洗衣机光荣退休了，年龄比我都要大，爸妈舍不得换一直用着。\u003c/p\u003e","content_html":"\u003cp\u003e今年的十一火车票非常难抢，12306的候补订单，一直等到时间截止也没订上票。\u003c/p\u003e\n\u003cp\u003e只好请了2天假，提前回家了，给自己也放个假休息一下。\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e回家的几个经历：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e家里的老洗衣机光荣退休了，年龄比我都要大，爸妈舍不得换一直用着。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/chinese-national-day/SkRx5uFwQ8Cliyq.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/chinese-national-day/SkRx5uFwQ8Cliyq.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"SkRx5uFwQ8Cliyq.jpg\" width=\"1080\" height=\"810\" alt=\"64F68D7789A8D877A41E6D694ABE5444.png\" title=\"服役了30年的洗衣机\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e村里今年也要通天然气了，各家各户都要拆煤炉，装壁挂炉，希望天然气供应不出问题。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e全家一起去了趟家门口的园博园，希望以后可以走的更远一些。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/chinese-national-day/wfUv5Kb1LGEdNHc.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/chinese-national-day/wfUv5Kb1LGEdNHc.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"wfUv5Kb1LGEdNHc.jpg\" width=\"1080\" height=\"1440\" alt=\"F69E19D28B34C163878F2A6E1A43E039.png\" title=\"园博园\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e娃确实是长大了，有了自己的想法，有自己的脾气了。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e背景：晚上开着灯，要睡觉了。\u003c/p\u003e\n\u003cp\u003e我：睡觉吧。\u003c/p\u003e\n\u003cp\u003e娃：爸爸，你说开着灯能睡觉吗？\u003c/p\u003e\n\u003cp\u003e我：不能吧\u0026hellip;（不知道她为啥问这个问题）\u003c/p\u003e\n\u003cp\u003e娃：那你开着灯让我睡觉，我怎么睡呀！\u003c/p\u003e\n\u003cp\u003e我：原来你在这里等着我呢啊\u0026hellip;\u003c/p\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003cp\u003e接下来，就努力工作吧。\u003c/p\u003e\n","date_published":"2019-10-08T13:13:36+08:00","tags":[]},{"title":"Swoft 框架运行分析（五） —— ConsoleProcessor模块分析","id":"https://liudon.com/posts/swoft-console-processor-analysis/","url":"https://liudon.com/posts/swoft-console-processor-analysis/","summary":"\u003cblockquote\u003e\n\u003cp\u003e这里以Swoft启动http server为例。\u003c/p\u003e\n\u003cp\u003ephp bin/swoft http:start\u003c/p\u003e\n\u003cp\u003e执行上述命令，启动http server。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e在前面第一篇文章的时候，提到了如何启动http服务。\u003c/p\u003e\n\u003cp\u003e今天我们就来看一下http服务是如何启动的，具体实现就在\u003ccode\u003eConsoleProcess\u003c/code\u003e这个模块。\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003e这里以Swoft启动http server为例。\u003c/p\u003e\n\u003cp\u003ephp bin/swoft http:start\u003c/p\u003e\n\u003cp\u003e执行上述命令，启动http server。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e在前面第一篇文章的时候，提到了如何启动http服务。\u003c/p\u003e\n\u003cp\u003e今天我们就来看一下http服务是如何启动的，具体实现就在\u003ccode\u003eConsoleProcess\u003c/code\u003e这个模块。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Handle console\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function handle(): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeConsole()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e Router \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e bean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cliRouter\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Register console routes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CommandRegister::register(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Console command route registered (group \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e, command \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e)\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egroupCount(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ecount()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    );\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Run console application\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    bean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cliApp\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003erun();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eafterConsole();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里调用了\u003ccode\u003ebean\u003c/code\u003e方法获取\u003ccode\u003eBean\u003c/code\u003e实例，定义见\u003ccode\u003eswoft-component-2.0.5\\src\\bean\\src\\Helper\\Functions.php\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eif (!function_exists(\u0026#39;bean\u0026#39;)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     * Get bean by name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     * @param string $name Bean name Or alias Or class name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     * @return object|string|mixed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    function bean(string $name)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (BeanFactory::isSingleton(\u0026#39;config\u0026#39;)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            return BeanFactory::getBean($name);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return sprintf(\u0026#39;${%s}\u0026#39;, $name);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里调用了\u003ccode\u003eBeanFactory\u003c/code\u003e的\u003ccode\u003egetBean\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Get object by name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $name Bean name Or alias Or class name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return object|mixed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function getBean(string $name)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return Container::getInstance()-\u0026gt;get($name);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e最终调用的是\u003ccode\u003eSwoft\\Bean\\Container\u003c/code\u003e下的\u003ccode\u003eget\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Finds an entry of the container by its identifier \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e returns it\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid Bean name Or alias Or \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e When \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e name will \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e all of instance \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e object\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows InvalidArgumentException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function get(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e It is singleton\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esingletonPool[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esingletonPool[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Prototype by clone\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprototypePool[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e clone \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprototypePool[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Alias name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealiasId \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ealiases[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid] \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e??\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealiasId) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eget(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealiasId);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Class name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassNames \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassNames[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid] \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassNames) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e end(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassNames);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eget(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Interface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (interface_exists(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e InterfaceRegister::getInterfaceInjectBean(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eget(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Not defined\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eisset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eobjectDefinitions[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new InvalidArgumentException(sprintf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;The bean of \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e is not defined\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e ObjectDefinition \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eobjectDefinitions[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Prototype\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esafeNewBean(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetName());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e获取对应的\u003ccode\u003eObjectDefinition\u003c/code\u003e实例，然后调用\u003ccode\u003esafeNewBean\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Secure creation of beans\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $beanName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return object|mixed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function safeNewBean(string $beanName, string $id = \u0026#39;\u0026#39;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    try {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return $this-\u0026gt;newBean($beanName, $id);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } catch (Throwable $e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new InvalidArgumentException($e-\u0026gt;getMessage(), 500, $e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里又调用了\u003ccode\u003enewBean\u003c/code\u003e方法，在上一篇文章里我们已经讲过这个方法，这里会返回实例化后的\u003ccode\u003eBean\u003c/code\u003e类。\u003c/p\u003e\n\u003cp\u003e那\u003ccode\u003ecliRouter\u003c/code\u003e对应的类是说明呢？这个定义在\u003ccode\u003eswoft-component-2.0.5\\src\\console\\src\\AutoLoader.php\u003c/code\u003e里。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * {@inheritDoc}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function beans(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;cliApp\u0026#39;    =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;class\u0026#39;   =\u0026gt; Application::class,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;version\u0026#39; =\u0026gt; \u0026#39;2.0.0\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;cliRouter\u0026#39; =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;class\u0026#39; =\u0026gt; Router::class,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;cliDispatcher\u0026#39; =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;class\u0026#39; =\u0026gt; ConsoleDispatcher::class,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e所以\u003ccode\u003e$router = bean('cliRouter')\u003c/code\u003e，返回的是一个\u003ccode\u003eSwoft\\Console\\Router\\Router\u003c/code\u003e类。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003eConsoleProcessor\u003c/code\u003e类，接着看代码。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCommandRegister::register($router);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e调用了\u003ccode\u003eCommandRegister\u003c/code\u003e类的\u003ccode\u003eregister\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param Router $router\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function register(Router $router): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $maxLen  = 12;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $groups  = [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $docOpts = [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;allow\u0026#39; =\u0026gt; [\u0026#39;example\u0026#39;]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $defInfo = [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;example\u0026#39;     =\u0026gt; \u0026#39;\u0026#39;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;description\u0026#39; =\u0026gt; \u0026#39;No description message\u0026#39;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (self::$commands as $class =\u0026gt; $mapping) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $names = [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $group = $mapping[\u0026#39;group\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        // Set ID aliases\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $router-\u0026gt;setIdAliases($mapping[\u0026#39;idAliases\u0026#39;]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        // Set group name aliases\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $router-\u0026gt;setGroupAliases($group, $mapping[\u0026#39;aliases\u0026#39;]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $refInfo = Swoft::getReflection($class);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $mhdInfo = $refInfo[\u0026#39;methods\u0026#39;] ?? [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $grpOpts = $mapping[\u0026#39;options\u0026#39;] ?? [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        foreach ($mapping[\u0026#39;commands\u0026#39;] as $method =\u0026gt; $route) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            // $method = $route[\u0026#39;method\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $cmdDesc = $route[\u0026#39;desc\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $command = $route[\u0026#39;command\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $idLen = strlen($group . $command);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            if ($idLen \u0026gt; $maxLen) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                $maxLen = $idLen;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $cmdExam = \u0026#39;\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            if (!empty($mhdInfo[$method][\u0026#39;comments\u0026#39;])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                $tagInfo = DocBlock::getTags($mhdInfo[$method][\u0026#39;comments\u0026#39;], $docOpts, $defInfo);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                $cmdDesc = $cmdDesc ?: Str::firstLine($tagInfo[\u0026#39;description\u0026#39;]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                $cmdExam = $tagInfo[\u0026#39;example\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $route[\u0026#39;group\u0026#39;]   = $group;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $route[\u0026#39;desc\u0026#39;]    = ucfirst($cmdDesc);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $route[\u0026#39;example\u0026#39;] = $cmdExam;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $route[\u0026#39;options\u0026#39;] = self::mergeOptions($grpOpts, $route[\u0026#39;options\u0026#39;]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            // Append group option\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $route[\u0026#39;enabled\u0026#39;]   = $mapping[\u0026#39;enabled\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $route[\u0026#39;coroutine\u0026#39;] = $mapping[\u0026#39;coroutine\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $router-\u0026gt;map($group, $command, [$class, $method], $route);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $names[] = $command;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $groupExam = \u0026#39;\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $groupDesc = $mapping[\u0026#39;desc\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (!empty($refInfo[\u0026#39;comments\u0026#39;])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $tagInfo   = DocBlock::getTags($refInfo[\u0026#39;comments\u0026#39;], $docOpts, $defInfo);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $groupDesc = $groupDesc ?: Str::firstLine($tagInfo[\u0026#39;description\u0026#39;]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $groupExam = $tagInfo[\u0026#39;example\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $groups[$group] = [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;names\u0026#39;   =\u0026gt; $names,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;desc\u0026#39;    =\u0026gt; ucfirst($groupDesc),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;class\u0026#39;   =\u0026gt; $class,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;alias\u0026#39;   =\u0026gt; $mapping[\u0026#39;alias\u0026#39;],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;aliases\u0026#39; =\u0026gt; $mapping[\u0026#39;aliases\u0026#39;],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;example\u0026#39; =\u0026gt; $groupExam,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $router-\u0026gt;setGroups($groups);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // +1 because router-\u0026gt;delimiter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $router-\u0026gt;setKeyWidth($maxLen + 1);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // clear data\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::$commands = [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里遍历了类属性\u003ccode\u003e$commands\u003c/code\u003e注册路由。\u003c/p\u003e\n\u003cp\u003e那么\u003ccode\u003e$commands\u003c/code\u003e这个属性是哪里来的呢？\u003c/p\u003e\n\u003cp\u003e既然开头我们说的是http服务是怎么启动的，这里我们就以\u003ccode\u003ehttp-server\u003c/code\u003e来举例，找到\u003ccode\u003eswoft-component-2.0.5\\src\\http-server\\src\\Command\\HttpServerCommand.php\u003c/code\u003e文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp declare(strict_types\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\Http\\Server\\Command;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse ReflectionException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Bean\\Exception\\ContainerException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Console\\Annotation\\Mapping\\Command;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Console\\Annotation\\Mapping\\CommandMapping;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Console\\Annotation\\Mapping\\CommandOption;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Console\\Helper\\Show;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\HttpServer;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Server\\Command\\BaseServerCommand;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Server\\Exception\\ServerException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function bean;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function input;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function output;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Provide some commands to manage the swoft HTTP server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eCommand(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;http\u0026#34;\u003c/span\u003e, alias\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;httpsrv\u0026#34;\u003c/span\u003e, coroutine\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003efalse)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eexample\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e  {fullCmd}:start     Start the http server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e  {fullCmd}:stop      Stop the http server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e HttpServerCommand \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e BaseServerCommand\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Start the http server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eCommandMapping(usage\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{fullCommand} [-d|--daemon]\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eCommandOption(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;daemon\u0026#34;\u003c/span\u003e, short\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;d\u0026#34;\u003c/span\u003e, desc\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Run server on the background\u0026#34;\u003c/span\u003e, type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bool\u0026#34;\u003c/span\u003e, default\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ServerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eexample\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e   {fullCommand}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e   {fullCommand} \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function start(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ecreateServer();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Check \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e it has started\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eisRunning()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emasterPid \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPid();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            output()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ewriteln(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;error\u0026gt;The HTTP server have been running!(PID: {$masterPid})\u0026lt;/error\u0026gt;\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Startup settings\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003econfigStartOption(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esettings \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetSetting();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Setting\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eworkerNum \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esettings[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;worker_num\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Server startup parameters\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emainHost \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetHost();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emainPort \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPort();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emodeName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetModeName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etypeName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetTypeName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Http\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epanel \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;HTTP\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;listen\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emainHost \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;:\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emainPort,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;type\u0026#39;\u003c/span\u003e   \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etypeName,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;mode\u0026#39;\u003c/span\u003e   \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emodeName,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;worker\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eworkerNum,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Port Listeners\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epanel \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eappendPortsToPanel(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epanel);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Show::panel(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epanel);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        output()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ewriteln(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;success\u0026gt;HTTP server start success !\u0026lt;/success\u0026gt;\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Start the server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003estart();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Reload worker processes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eCommandMapping(usage\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{fullCommand} [-t]\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eCommandOption(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;t\u0026#34;\u003c/span\u003e, desc\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Only to reload task processes, default to reload worker and task\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function reload(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ecreateServer();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escript \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e input()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetScript();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Check \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e it has started\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eisRunning()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            output()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ewriteln(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;error\u0026gt;The HTTP server is not running! cannot reload\u0026lt;/error\u0026gt;\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        output()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ewritef(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;info\u0026gt;Server \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e is reloading\u0026lt;/info\u0026gt;\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escript);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereloadTask \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e input()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ehasOpt(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;t\u0026#39;\u003c/span\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Show::notice(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Will only reload task worker\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ereload(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereloadTask)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Show::error(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;The swoole server worker process reload fail!\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        output()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ewritef(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;success\u0026gt;HTTP server \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e reload success\u0026lt;/success\u0026gt;\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escript);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Stop the currently running server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eCommandMapping()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function stop(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ecreateServer();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Check \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e it has started\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eisRunning()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            output()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ewriteln(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;error\u0026gt;The HTTP server is not running! cannot stop.\u0026lt;/error\u0026gt;\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Do stopping\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003estop();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Restart the http server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eCommandMapping(usage\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{fullCommand} [-d|--daemon]\u0026#34;\u003c/span\u003e,)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eCommandOption(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;daemon\u0026#34;\u003c/span\u003e, short\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;d\u0026#34;\u003c/span\u003e, desc\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Run server on the background\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eexample\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e  {fullCommand}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e  {fullCommand} \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function restart(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ecreateServer();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Check \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e it has started\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eisRunning()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esuccess \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003estop();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003esuccess) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                output()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eerror(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Stop the old server failed!\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        output()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ewritef(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026lt;success\u0026gt;Server HTTP restart success !\u0026lt;/success\u0026gt;\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003estartWithDaemonize();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e HttpServer\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private function createServer(): HttpServer\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escript  \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e input()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetScript();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecommand \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetFullCommand();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e HttpServer \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e bean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;httpServer\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetScriptFile(Swoft::app()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPath(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escript));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetFullCommand(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecommand);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过\u003ca href=\"https://www.swoft.org/docs/2.x/zh-CN/annotation/usage.html\"\u003eSwoft文档\u003c/a\u003e，我们可以看到这里分别使用了类注解和方法注解。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@Command(\u0026#34;http\u0026#34;, alias=\u0026#34;httpsrv\u0026#34;, coroutine=false)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@CommandMapping(usage=\u0026#34;{fullCommand} [-d|--daemon]\u0026#34;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@CommandOption(\u0026#34;daemon\u0026#34;, short=\u0026#34;d\u0026#34;, desc=\u0026#34;Run server on the background\u0026#34;, type=\u0026#34;bool\u0026#34;, default=\u0026#34;false\u0026#34;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过第二篇文章分析，我们知道这里会自动实例化对应的注解类。\u003c/p\u003e\n\u003cp\u003e这里以\u003ccode\u003eSwoft\\Console\\Annotation\\Mapping\\CommandMapping\u003c/code\u003e这个注解为例，对应的注解解析类为\u003ccode\u003eSwoft\\Console\\Annotation\\Parser\\CommandMappingParser\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp declare(strict_types\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\Console\\Annotation\\Parser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\Annotation\\Mapping\\AnnotationParser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\Annotation\\Parser\\Parser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\Exception\\AnnotationException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Console\\Annotation\\Mapping\\CommandMapping;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Console\\CommandRegister;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class CommandMappingParser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAnnotationParser(CommandMapping::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e CommandMappingParser \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e Parser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Parse object\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype Class \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e Method \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e Property\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam CommandMapping \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation Annotation object\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Return empty array is nothing to \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e When \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e type \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escope, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealias, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esize] is to inject bean\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e When property type \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epropertyValue, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eisRef] is to reference value\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function parse(\u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype \u003cspan style=\"color:#f92672\"\u003e!==\u003c/span\u003e self::TYPE_METHOD) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            throw new AnnotationException(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;`@CommandMapping` must be defined on class method!\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emethod \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003emethodName;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e add route info \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e controller action\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        CommandRegister::addRoute(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emethod, [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;command\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetName() \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emethod,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;method\u0026#39;\u003c/span\u003e  \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emethod,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;alias\u0026#39;\u003c/span\u003e   \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetAlias(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;aliases\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetAliases(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;desc\u0026#39;\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDesc(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;usage\u0026#39;\u003c/span\u003e   \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetUsage(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;example\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetExample(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e看到这里，你应该可以猜到\u003ccode\u003eCommandRegister\u003c/code\u003e类的\u003ccode\u003e$commands\u003c/code\u003e是怎么来的了吧。\u003c/p\u003e\n\u003cp\u003e我们看下\u003ccode\u003eCommandRegister\u003c/code\u003e类的\u003ccode\u003eaddRoute\u003c/code\u003e方法，验证下想法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $class\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $method\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array  $route\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function addRoute(string $class, string $method, array $route): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::checkClass($class);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // init some keys\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $route[\u0026#39;options\u0026#39;]   = [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $route[\u0026#39;arguments\u0026#39;] = [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // save\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::$commands[$class][\u0026#39;commands\u0026#39;][$method] = $route;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ebingo，跟我们猜想的一模一样，这下我们也知道\u003ccode\u003eCommandMapping\u003c/code\u003e这个注解是用来注册终端的路由信息。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003eConsoleProcessor\u003c/code\u003e类，接着看代码。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCLog::info(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;Console command route registered (group %d, command %d)\u0026#39;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $router-\u0026gt;groupCount(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $router-\u0026gt;count()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e打印日志。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Run console application\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebean(\u0026#39;cliApp\u0026#39;)-\u0026gt;run();\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e感觉到了重头戏。\u003c/p\u003e\n\u003cp\u003e根据前面的代码，我们知道\u003ccode\u003ecliApp\u003c/code\u003e这个\u003ccode\u003eBean\u003c/code\u003e实例对应的类是\u003ccode\u003eSwoft\\Console\\Application\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function run(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    try {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Swoft::trigger(ConsoleEvent::RUN_BEFORE, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Prepare\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprepare();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Get input command\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einputCommand \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003einput\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetCommand();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003einputCommand) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003efilterSpecialOption();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edoRun(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einputCommand);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Swoft::trigger(ConsoleEvent::RUN_AFTER, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einputCommand);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } catch (Throwable \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e ConsoleErrorDispatcher \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eerrDispatcher \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eerrDispatcher \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e BeanFactory::getSingleton(ConsoleErrorDispatcher::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Handle request error\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eerrDispatcher\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003erun(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ee);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过\u003ccode\u003eSwoft::trigger\u003c/code\u003e，注册了\u003ccode\u003eConsoleEvent::RUN_BEFORE\u003c/code\u003e和\u003ccode\u003eConsoleEvent::RUN_AFTER\u003c/code\u003e两个事件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotected function prepare(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003einput  \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \\input();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eoutput \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \\output();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e load builtin comments vars\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetCommentsVars(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ecommentsVars());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003eprepare\u003c/code\u003e比较简单，这里声明了输入和输出两个类。注意哈，这个后面会用到。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$inputCommand = $this-\u0026gt;input-\u0026gt;getCommand();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eif (!$inputCommand) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;filterSpecialOption();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e} else {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;doRun($inputCommand);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e获取终端命令行下的输入，如果有输入执行\u003ccode\u003edoRun\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einputCmd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows Throwable\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotected function doRun(string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einputCmd): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eoutput \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eoutput;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e Router \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Swoft::getBean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cliRouter\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresult \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ematch(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einputCmd);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Command \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e found\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresult[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e===\u003c/span\u003e Router::NOT_FOUND) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003enames \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetAllNames();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eoutput\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eliteError(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;The entered command \u0026#39;{$inputCmd}\u0026#39; is not exists!\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e find similar command names by similar_text()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esimilar \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Arr::findSimilar(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einputCmd, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003enames)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eoutput\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ewritef(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eMaybe what you mean is:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    \u0026lt;info\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026lt;/info\u0026gt;\u0026#34;\u003c/span\u003e, implode(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;, \u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esimilar));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eshowApplicationHelp(false);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresult[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Only input a group name, display help \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e the group\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresult[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e===\u003c/span\u003e Router::ONLY_GROUP) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eshowGroupHelp(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;group\u0026#39;\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Display help \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e a command\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003einput\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetSameOpt([\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;h\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;help\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eshowCommandHelp(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Parse default options \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e arguments\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebindCommandFlags(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003einput\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetCommandId(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cmdId\u0026#39;\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::triggerByArray(ConsoleEvent::DISPATCH_BEFORE, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Call command handler\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e ConsoleDispatcher \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edispatcher \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edispatcher \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Swoft::getSingleton(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cliDispatcher\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edispatcher\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edispatch(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::triggerByArray(ConsoleEvent::DISPATCH_AFTER, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$router = Swoft::getBean(\u0026#39;cliRouter\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$result = $router-\u0026gt;match($inputCmd);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e获取\u003ccode\u003ecliRouter\u003c/code\u003e实例，根据输入匹配路由操作类。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Match route by input command\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $params [$route]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *  status, info(array)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function match(...$params): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $delimiter = $this-\u0026gt;delimiter;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $inputCmd  = trim($params[0], \u0026#34;$delimiter \u0026#34;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $noSepChar = strpos($inputCmd, $delimiter) === false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // If use command ID alias\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if ($noSepChar \u0026amp;\u0026amp; isset($this-\u0026gt;idAliases[$inputCmd])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $inputCmd = $this-\u0026gt;idAliases[$inputCmd];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        // Must re-check\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $noSepChar = strpos($inputCmd, $delimiter) === false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if ($noSepChar \u0026amp;\u0026amp; in_array($inputCmd, $this-\u0026gt;defaultCommands, true)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $group   = $this-\u0026gt;defaultGroup;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $command = $this-\u0026gt;resolveCommandAlias($inputCmd);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        // Only a group name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } elseif ($noSepChar) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $group = $this-\u0026gt;resolveGroupAlias($inputCmd);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (isset($this-\u0026gt;groups[$group])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            return [self::ONLY_GROUP, [\u0026#39;group\u0026#39; =\u0026gt; $group]];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return [self::NOT_FOUND];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } else {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $nameList = explode($delimiter, $inputCmd, 2);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (count($nameList) === 2) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            [$group, $command] = $nameList;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            // resolve command alias\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $command = $this-\u0026gt;resolveCommandAlias($command);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } else {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $command = \u0026#39;\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            // $command = $this-\u0026gt;defaultCommand;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $group = $nameList[0];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $group = $this-\u0026gt;resolveGroupAlias($group);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // build command ID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $commandID = $this-\u0026gt;buildCommandID($group, $command);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (isset($this-\u0026gt;routes[$commandID])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $info = $this-\u0026gt;routes[$commandID];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        // append some info\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $info[\u0026#39;cmdId\u0026#39;] = $commandID;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return [self::FOUND, $info];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if ($group \u0026amp;\u0026amp; isset($this-\u0026gt;groups[$group])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return [self::ONLY_GROUP, [\u0026#39;group\u0026#39; =\u0026gt; $group]];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return [self::NOT_FOUND];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里会返回匹配后的路由信息。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003edoRun\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Command not found\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eif ($result[0] === Router::NOT_FOUND) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $names = $router-\u0026gt;getAllNames();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $output-\u0026gt;liteError(\u0026#34;The entered command \u0026#39;{$inputCmd}\u0026#39; is not exists!\u0026#34;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // find similar command names by similar_text()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if ($similar = Arr::findSimilar($inputCmd, $names)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $output-\u0026gt;writef(\u0026#34;\\nMaybe what you mean is:\\n    \u0026lt;info\u0026gt;%s\u0026lt;/info\u0026gt;\u0026#34;, implode(\u0026#39;, \u0026#39;, $similar));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } else {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;showApplicationHelp(false);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$info = $result[1];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Only input a group name, display help for the group\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eif ($result[0] === Router::ONLY_GROUP) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;showGroupHelp($info[\u0026#39;group\u0026#39;]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Display help for a command\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eif ($this-\u0026gt;input-\u0026gt;getSameOpt([\u0026#39;h\u0026#39;, \u0026#39;help\u0026#39;])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;showCommandHelp($info);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e根据返回的路由信息进行不同的处理。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Parse default options and arguments\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$this-\u0026gt;bindCommandFlags($info);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$this-\u0026gt;input-\u0026gt;setCommandId($info[\u0026#39;cmdId\u0026#39;]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSwoft::triggerByArray(ConsoleEvent::DISPATCH_BEFORE, $this, $info);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e绑定默认参数，注册\u003ccode\u003eConsoleEvent::DISPATCH_BEFORE\u003c/code\u003e事件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Call command handler\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e ConsoleDispatcher \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edispatcher \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edispatcher \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Swoft::getSingleton(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cliDispatcher\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edispatcher\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edispatch(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003einfo);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e获取\u003ccode\u003ecliDispatcher\u003c/code\u003e的\u003ccode\u003eBean\u003c/code\u003e实例，对应\u003ccode\u003eSwoft\\Console\\ConsoleDispatcher\u003c/code\u003e类，调用\u003ccode\u003edispatch\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $params\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws Throwable\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function dispatch(...$params): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $route = $params[0];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Handler info\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    [$className, $method] = $route[\u0026#39;handler\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Bind method params\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $params = $this-\u0026gt;getBindParams($className, $method);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $object = Swoft::getSingleton($className);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Blocking running\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (!$route[\u0026#39;coroutine\u0026#39;]) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;before(get_parent_class($object), $method);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        PhpHelper::call([$object, $method], ...$params);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;after($method);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Hook php io function\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Runtime::enableCoroutine();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // If in unit test env, has been in coroutine.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (\\defined(\u0026#39;PHPUNIT_COMPOSER_INSTALL\u0026#39;)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;executeByCo($object, $method, $params);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Coroutine running\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    srun(function () use ($object, $method, $params) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;executeByCo($object, $method, $params);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    });\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e获取路由对应的类和方法，通过\u003ccode\u003eSwoft::getSingleton($className);\u003c/code\u003e实例化对象。\u003c/p\u003e\n\u003cp\u003e如果未开启协程，则用\u003ccode\u003ePhpHelper::call([$object, $method], ...$params);\u003c/code\u003e调用对应的方法。\u003c/p\u003e\n\u003cp\u003e开启协程的话，使用\u003ccode\u003e$this-\u0026gt;executeByCo($object, $method, $params);\u003c/code\u003e调用对应的方法。\u003c/p\u003e\n\u003cp\u003e我们前面启动命令是\u003ccode\u003ephp bin/swoft http:start\u003c/code\u003e，这里对应的类就是\u003ccode\u003eSwoft\\Http\\Server\\Command\\HttpServerCommand\u003c/code\u003e，方法就是\u003ccode\u003estart\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Start the http server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @CommandMapping(usage=\u0026#34;{fullCommand} [-d|--daemon]\u0026#34;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @CommandOption(\u0026#34;daemon\u0026#34;, short=\u0026#34;d\u0026#34;, desc=\u0026#34;Run server on the background\u0026#34;, type=\u0026#34;bool\u0026#34;, default=\u0026#34;false\u0026#34;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ServerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @example\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *   {fullCommand}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *   {fullCommand} -d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function start(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $server = $this-\u0026gt;createServer();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Check if it has started\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if ($server-\u0026gt;isRunning()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $masterPid = $server-\u0026gt;getPid();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        output()-\u0026gt;writeln(\u0026#34;\u0026lt;error\u0026gt;The HTTP server have been running!(PID: {$masterPid})\u0026lt;/error\u0026gt;\u0026#34;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Startup settings\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;configStartOption($server);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $settings = $server-\u0026gt;getSetting();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Setting\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $workerNum = $settings[\u0026#39;worker_num\u0026#39;];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Server startup parameters\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $mainHost = $server-\u0026gt;getHost();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $mainPort = $server-\u0026gt;getPort();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $modeName = $server-\u0026gt;getModeName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $typeName = $server-\u0026gt;getTypeName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Http\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $panel = [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;HTTP\u0026#39; =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;listen\u0026#39; =\u0026gt; $mainHost . \u0026#39;:\u0026#39; . $mainPort,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;type\u0026#39;   =\u0026gt; $typeName,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;mode\u0026#39;   =\u0026gt; $modeName,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u0026#39;worker\u0026#39; =\u0026gt; $workerNum,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Port Listeners\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $panel = $this-\u0026gt;appendPortsToPanel($server, $panel);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Show::panel($panel);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    output()-\u0026gt;writeln(\u0026#39;\u0026lt;success\u0026gt;HTTP server start success !\u0026lt;/success\u0026gt;\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Start the server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $server-\u0026gt;start();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里先调用了\u003ccode\u003ecreateServer\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e HttpServer\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function createServer(): HttpServer\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escript  \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e input()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetScript();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecommand \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetFullCommand();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e HttpServer \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e bean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;httpServer\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetScriptFile(Swoft::app()\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPath(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escript));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetFullCommand(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecommand);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eserver;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e获取\u003ccode\u003ehttpServer\u003c/code\u003e的\u003ccode\u003eBean\u003c/code\u003e实例。\u003c/p\u003e\n\u003cp\u003e框架定义在\u003ccode\u003eswoft-component-2.0.5\\src\\http-server\\src\\AutoLoader.php\u003c/code\u003e，这里声明了\u003ccode\u003eonRequest\u003c/code\u003e回调事件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026#39;httpServer\u0026#39;      =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;on\u0026#39; =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        SwooleEvent::REQUEST =\u0026gt; bean(RequestListener::class)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e业务定义在\u003ccode\u003eswoft-2.0.5\\app\\bean.php\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026#39;httpServer\u0026#39;        =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;class\u0026#39;    =\u0026gt; HttpServer::class,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;port\u0026#39;     =\u0026gt; 18306,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;listener\u0026#39; =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;rpc\u0026#39; =\u0026gt; bean(\u0026#39;rpcServer\u0026#39;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;process\u0026#39;  =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e//            \u0026#39;monitor\u0026#39; =\u0026gt; bean(MonitorProcess::class)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e//            \u0026#39;crontab\u0026#39; =\u0026gt; bean(CrontabProcess::class)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;on\u0026#39;       =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e//            SwooleEvent::TASK   =\u0026gt; bean(SyncTaskListener::class),  // Enable sync task\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        SwooleEvent::TASK   =\u0026gt; bean(TaskListener::class),  // Enable task must task and finish event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        SwooleEvent::FINISH =\u0026gt; bean(FinishListener::class)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /* @see HttpServer::$setting */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;setting\u0026#39;  =\u0026gt; [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;task_worker_num\u0026#39;       =\u0026gt; 12,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u0026#39;task_enable_coroutine\u0026#39; =\u0026gt; true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ecreateServer\u003c/code\u003e返回的是一个\u003ccode\u003eSwoft\\Http\\Server\\HttpServer\u003c/code\u003e实例。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003eHttpServerCommand\u003c/code\u003e类的\u003ccode\u003estart\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Start the server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$server-\u0026gt;start();\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e调用\u003ccode\u003eSwoft\\Http\\Server\\HttpServer\u003c/code\u003e类的\u003ccode\u003estart\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Start server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ServerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function start(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;swooleServer = new \\Swoole\\Http\\Server($this-\u0026gt;host, $this-\u0026gt;port, $this-\u0026gt;mode, $this-\u0026gt;type);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;startSwoole();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e声明\u003ccode\u003eSwoole\\Http\\Server\u003c/code\u003e对象，调用\u003ccode\u003estartSwoole\u003c/code\u003e方法。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eSwoft\\Http\\Server\\HttpServer\u003c/code\u003e类继承自\u003ccode\u003eSwoft\\Server\\Server\u003c/code\u003e类，\u003ccode\u003estartSwoole\u003c/code\u003e方法定义在这个类。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Bind swoole event and start swoole server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ServerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws Swoft\\Bean\\Exception\\ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotected function startSwoole(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (!$this-\u0026gt;swooleServer) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new ServerException(\u0026#39;You must to new server before start swoole!\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Always enable coroutine hook on server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u0026#39;Swoole\\Runtime::enableCoroutine\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Runtime::enableCoroutine();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(ServerEvent::BEFORE_SETTING, $this);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Set settings\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;swooleServer-\u0026gt;set($this-\u0026gt;setting);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Update setting property\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // $this-\u0026gt;setSetting($this-\u0026gt;swooleServer-\u0026gt;setting);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Before Add event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(ServerEvent::BEFORE_ADDED_EVENT, $this);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Register events\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $defaultEvents = $this-\u0026gt;defaultEvents();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $swooleEvents  = array_merge($defaultEvents, $this-\u0026gt;on);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Add events\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;addEvent($this-\u0026gt;swooleServer, $swooleEvents, $defaultEvents);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    //After add event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(ServerEvent::AFTER_ADDED_EVENT, $this);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Before listener\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(ServerEvent::BEFORE_ADDED_LISTENER, $this);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Add port listener\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;addListener();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Before bind process\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(ServerEvent::BEFORE_ADDED_PROCESS, $this);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Add Process\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(ServerEvent::ADDED_PROCESS, $this);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // After bind process\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(ServerEvent::AFTER_ADDED_PROCESS, $this);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Trigger event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(ServerEvent::BEFORE_START, $this, array_keys($swooleEvents));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Storage server instance\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::$server = $this;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Start swoole server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;swooleServer-\u0026gt;start();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$this-\u0026gt;swooleServer-\u0026gt;set($this-\u0026gt;setting);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e设置\u003ccode\u003eSwoole\u003c/code\u003e运行配置。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Register events\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$defaultEvents = $this-\u0026gt;defaultEvents();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$swooleEvents  = array_merge($defaultEvents, $this-\u0026gt;on);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Add events\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$this-\u0026gt;addEvent($this-\u0026gt;swooleServer, $swooleEvents, $defaultEvents);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e添加\u003ccode\u003eSwoole\u003c/code\u003e回调事件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Add port listener\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$this-\u0026gt;addListener();\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e监听端口。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Start swoole server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$this-\u0026gt;swooleServer-\u0026gt;start();\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e启动\u003ccode\u003eSwoole\\Http\\Server\u003c/code\u003e服务。\u003c/p\u003e\n\u003cp\u003e现在服务已经启动了，那\u003ccode\u003ehttp请求\u003c/code\u003e是怎么被处理的呢？\u003c/p\u003e\n\u003cp\u003e这个我们下一篇再继续讲。\u003c/p\u003e\n","date_published":"2019-09-26T13:14:23+08:00","tags":["Swoft"]},{"title":"Swoft 框架运行分析（四） —— EventProcessor模块分析","id":"https://liudon.com/posts/swoft-event-processor-analysis/","url":"https://liudon.com/posts/swoft-event-processor-analysis/","summary":"\u003cp\u003e今天我们来看一下\u003ccode\u003eEventProcessor\u003c/code\u003e的实现。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Handle event register\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function handle(): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeEvent()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        CLog::warning(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Stop event processor by beforeEvent return false\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e EventManager \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eeventManager \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eeventManager \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e bean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;eventManager\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecount1, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecount2] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e ListenerRegister::register(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eeventManager);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Event manager initialized(\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e listener, \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e subscriber)\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecount1, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecount2);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Trigger a app init event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(SwoftEvent::APP_INIT_COMPLETE);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eafterEvent();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e获取\u003ccode\u003eeventManager\u003c/code\u003e的\u003ccode\u003eBean\u003c/code\u003e实例，对应为\u003ccode\u003eSwoft\\Event\\Manager\\EventManager\u003c/code\u003e类。\u003c/p\u003e","content_html":"\u003cp\u003e今天我们来看一下\u003ccode\u003eEventProcessor\u003c/code\u003e的实现。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Handle event register\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function handle(): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeEvent()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        CLog::warning(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Stop event processor by beforeEvent return false\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e EventManager \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eeventManager \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eeventManager \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e bean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;eventManager\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecount1, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecount2] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e ListenerRegister::register(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eeventManager);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Event manager initialized(\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e listener, \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e subscriber)\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecount1, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ecount2);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Trigger a app init event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Swoft::trigger(SwoftEvent::APP_INIT_COMPLETE);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eafterEvent();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e获取\u003ccode\u003eeventManager\u003c/code\u003e的\u003ccode\u003eBean\u003c/code\u003e实例，对应为\u003ccode\u003eSwoft\\Event\\Manager\\EventManager\u003c/code\u003e类。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[$count1, $count2] = ListenerRegister::register($eventManager);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e调用\u003ccode\u003eListenerRegister\u003c/code\u003e类的\u003ccode\u003eregister\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param EventManager $em\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function register(EventManager $em): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (self::$listeners as $className =\u0026gt; $eventInfo) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $listener = Swoft::getSingleton($className);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (!$listener instanceof EventHandlerInterface) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            throw new RuntimeException(\u0026#34;The event listener class \u0026#39;{$className}\u0026#39; must be instanceof EventHandlerInterface\u0026#34;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $em-\u0026gt;addListener($listener, $eventInfo);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (self::$subscribers as $className) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $subscriber = Swoft::getSingleton($className);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (!$subscriber instanceof EventSubscriberInterface) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            throw new RuntimeException(\u0026#34;The event subscriber class \u0026#39;{$className}\u0026#39; must be instanceof EventSubscriberInterface\u0026#34;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $em-\u0026gt;addSubscriber($subscriber);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $count1 = count(self::$listeners);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $count2 = count(self::$subscribers);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Clear data\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::$listeners = self::$subscribers = [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return [$count1, $count2];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e遍历\u003ccode\u003eListenerRegister\u003c/code\u003e类下的\u003ccode\u003e$listeners\u003c/code\u003e和\u003ccode\u003e$subscribers\u003c/code\u003e属性，绑定事件到\u003ccode\u003eeventManager\u003c/code\u003e的\u003ccode\u003eBean\u003c/code\u003e实例上。\u003c/p\u003e\n\u003cp\u003e这里的\u003ccode\u003e$listeners\u003c/code\u003e和\u003ccode\u003e$subscribers\u003c/code\u003e是从哪里来的呢？\u003c/p\u003e\n\u003cp\u003e这里以\u003ccode\u003ehttp-server\u003c/code\u003e为例。\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003eswoft-component-2.0.5\\src\\http-server\\src\\Listener\u003c/code\u003e目录下，存在下面三个文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfterRequestListener.php\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAppInitCompleteListener.php\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBeforeRequestListener.php\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里我们以\u003ccode\u003eAppInitCompleteListener.php\u003c/code\u003e为例。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\Http\\Server\\Listener;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function bean;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse ReflectionException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Bean\\Exception\\ContainerException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Event\\Annotation\\Mapping\\Listener;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Event\\EventHandlerInterface;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Event\\EventInterface;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Exception\\HttpServerException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Middleware\\MiddlewareRegister;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Router\\Router;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Router\\RouteRegister;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\SwoftEvent;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class AppInitCompleteListener\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eListener(SwoftEvent::APP_INIT_COMPLETE)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e AppInitCompleteListener implements EventHandlerInterface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam EventInterface \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows HttpServerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function handle(EventInterface \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e Router \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter Register HTTP routes \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e bean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;httpRouter\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        RouteRegister::registerRoutes(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Register middleware\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        MiddlewareRegister::register();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可以看到这里通过\u003ccode\u003e@Listener(SwoftEvent::APP_INIT_COMPLETE)\u003c/code\u003e，使用了\u003ccode\u003eSwoft\\Event\\Annotation\\Mapping\\Listener\u003c/code\u003e类注解，对应的注解解析类为\u003ccode\u003eSwoft\\Event\\Annotation\\Parser\\ListenerParser\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp declare(strict_types\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\Event\\Annotation\\Parser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Doctrine\\Common\\Annotations\\AnnotationException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\Annotation\\Mapping\\AnnotationParser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\Annotation\\Parser\\Parser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Bean\\Annotation\\Mapping\\Bean;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Event\\Annotation\\Mapping\\Listener;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Event\\ListenerRegister;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class ListenerParser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAnnotationParser(Listener::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e ListenerParser \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e Parser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e      \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam Listener \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function parse(\u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype \u003cspan style=\"color:#f92672\"\u003e!==\u003c/span\u003e self::TYPE_CLASS) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            throw new AnnotationException(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;`@Listener` must be defined on class!\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e collect listeners\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ListenerRegister::addListener(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassName, [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e event name \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e listener priority\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetEvent() \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotation\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPriority()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassName, Bean::SINGLETON, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-zed\" data-lang=\"zed\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param string $className\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param array  $definition [event name =\u0026gt; listener priority]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function addListener(string \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName, array \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [])\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Collect listeners\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    self\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003elisteners[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可以看到这里通过\u003ccode\u003eListenerRegister::addListener\u003c/code\u003e方法，往\u003ccode\u003eListenerRegister\u003c/code\u003e上注册了\u003ccode\u003e$listeners\u003c/code\u003e属性。\u003c/p\u003e\n\u003cp\u003e属性\u003ccode\u003e$listeners\u003c/code\u003e和\u003ccode\u003e$subscribers\u003c/code\u003e的值，都是通过注解解析得来。\u003c/p\u003e\n\u003cp\u003e这里我们回到\u003ccode\u003eEventProcessor\u003c/code\u003e类的\u003ccode\u003ehandle\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Trigger a app init event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSwoft::trigger(SwoftEvent::APP_INIT_COMPLETE);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003etrigger的方法定义如下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Trigger an swoft application event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string|EventInterface $event eg: \u0026#39;app.start\u0026#39; \u0026#39;app.stop\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param null|mixed            $target\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array                 $params\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return EventInterface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function trigger($event, $target = null, ...$params): EventInterface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /** @see EventManager::trigger() */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return BeanFactory::getSingleton(\u0026#39;eventManager\u0026#39;)-\u0026gt;trigger($event, $target, $params);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里调用了\u003ccode\u003eeventManager\u003c/code\u003e这个\u003ccode\u003eBean\u003c/code\u003e实例的\u003ccode\u003etrigger\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Trigger an event\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e Can accept an EventInterface \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e will create one \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e passed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003eEventInterface \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;app.start\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;app.stop\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam mixed\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003estring          \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget It is object \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e string\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam array\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003emixed           \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eargs\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e EventInterface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows InvalidArgumentException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function trigger(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e null, array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eargs \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []): EventInterface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eisString \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e is_string(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e trim(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } elseif (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent instanceof EventInterface) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e trim(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetName());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new InvalidArgumentException(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Invalid event params for trigger event handler\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eshouldCall \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Have matched listener\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003elistenedEvents[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eshouldCall[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Like \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;app.db.query\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e prefix: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;app.db\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epos \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e strrpos(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;.\u0026#39;\u003c/span\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprefix \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e substr(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epos);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Have a wildcards listener\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e eg \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;app.db.*\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ewildcardEvent \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprefix \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;.*\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003elistenedEvents[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ewildcardEvent])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eshouldCall[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ewildcardEvent] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e substr(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epos \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Not found listeners\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003eshouldCall) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eisString \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebasicEvent : \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e EventInterface \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eisString) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eevents[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename] \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e??\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebasicEvent;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Initial value\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetName(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetParams(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eargs);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetTarget(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003estopPropagation(false);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Notify event listeners\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eshouldCall as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emethod) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003etriggerListeners(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003elisteners[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename], \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emethod);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eisPropagationStopped()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Have global wildcards \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*\u0026#39;\u003c/span\u003e listener\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003elistenedEvents[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003etriggerListeners(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003elisteners[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*\u0026#39;\u003c/span\u003e], \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果存在对应的事件，调用\u003ccode\u003etriggerListeners\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array|ListenerQueue $listeners\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param EventInterface      $event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string              $method\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotected function triggerListeners($listeners, EventInterface $event, string $method = \u0026#39;\u0026#39;): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // $handled = false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $name     = $event-\u0026gt;getName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $callable = false === strpos($name, \u0026#39;.\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // 循环调用监听器，处理事件\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach ($listeners as $listener) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if ($event-\u0026gt;isPropagationStopped()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            break;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (is_object($listener)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            if ($listener instanceof EventHandlerInterface) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                $listener-\u0026gt;handle($event);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            } elseif ($method \u0026amp;\u0026amp; method_exists($listener, $method)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                $listener-\u0026gt;$method($event);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            } elseif ($callable \u0026amp;\u0026amp; method_exists($listener, $name)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                $listener-\u0026gt;$name($event);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            } elseif (method_exists($listener, \u0026#39;__invoke\u0026#39;)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                $listener($event);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } elseif (is_callable($listener)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $listener($event);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e遍历事件回调，执行对应方法。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003eEventProcessor\u003c/code\u003e类的\u003ccode\u003ehandle\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Trigger a app init event\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSwoft::trigger(SwoftEvent::APP_INIT_COMPLETE);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里的事件为\u003ccode\u003eSwoftEvent::APP_INIT_COMPLETE\u003c/code\u003e，所以这里会执行这个事件下的所有回调。\u003c/p\u003e\n\u003cp\u003e这里以\u003ccode\u003eSwoft\\Http\\Server\\Listener\\AppInitCompleteListener\u003c/code\u003e为例。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\Http\\Server\\Listener;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function bean;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse ReflectionException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Bean\\Exception\\ContainerException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Event\\Annotation\\Mapping\\Listener;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Event\\EventHandlerInterface;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Event\\EventInterface;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Exception\\HttpServerException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Middleware\\MiddlewareRegister;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Router\\Router;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Router\\RouteRegister;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\SwoftEvent;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class AppInitCompleteListener\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eListener(SwoftEvent::APP_INIT_COMPLETE)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e AppInitCompleteListener implements EventHandlerInterface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam EventInterface \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows HttpServerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function handle(EventInterface \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eevent): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e Router \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter Register HTTP routes \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e bean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;httpRouter\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        RouteRegister::registerRoutes(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003erouter);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Register middleware\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        MiddlewareRegister::register();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里使用了\u003ccode\u003eSwoft\\Event\\Annotation\\Mapping\\Listener\u003c/code\u003e注解，对应的事件为\u003ccode\u003eSwoftEvent::APP_INIT_COMPLETE\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e按照上面的分析，这里会调用到\u003ccode\u003eAppInitCompleteListener\u003c/code\u003e的\u003ccode\u003ehandle\u003c/code\u003e方法，获取\u003ccode\u003ehttpRouter\u003c/code\u003e的\u003ccode\u003eBean\u003c/code\u003e实例，注册\u003ccode\u003ehttp服务\u003c/code\u003e的路由信息和中间件。\u003c/p\u003e\n\u003cp\u003e到这里，我们大概清楚了\u003ccode\u003eEventProcessor\u003c/code\u003e这个模块的作用，注册了所有事件的回调。\u003c/p\u003e\n","date_published":"2019-09-26T13:02:18+08:00","tags":["Swoft"]},{"title":"一个git submodule update引发的问题","id":"https://liudon.com/posts/a-issues-of-git-submodule-update/","url":"https://liudon.com/posts/a-issues-of-git-submodule-update/","summary":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e1月份的时候，用\u003ccode\u003ehugo\u003c/code\u003e搭了这套博客系统。\u003c/p\u003e\n\u003cp\u003e本机写md文件，更新到\u003ccode\u003egithub\u003c/code\u003e，然后通过\u003ccode\u003etravis-ci\u003c/code\u003e自动发布。\u003c/p\u003e\n\u003cp\u003ejane主题是通过\u003ccode\u003egit submodule\u003c/code\u003e引入的，\u003ccode\u003e.gitmodules\u003c/code\u003e文件内容。\u003c/p\u003e","content_html":"\u003ch4 id=\"背景\"\u003e背景\u003c/h4\u003e\n\u003cp\u003e1月份的时候，用\u003ccode\u003ehugo\u003c/code\u003e搭了这套博客系统。\u003c/p\u003e\n\u003cp\u003e本机写md文件，更新到\u003ccode\u003egithub\u003c/code\u003e，然后通过\u003ccode\u003etravis-ci\u003c/code\u003e自动发布。\u003c/p\u003e\n\u003cp\u003ejane主题是通过\u003ccode\u003egit submodule\u003c/code\u003e引入的，\u003ccode\u003e.gitmodules\u003c/code\u003e文件内容。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[submodule \u0026#34;themes/jane\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tpath = themes/jane\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\turl = https://github.com/xianmin/hugo-theme-jane.git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"问题\"\u003e问题\u003c/h4\u003e\n\u003cp\u003e最近几天更新完文章后，发现首页显示出了问题。\u003c/p\u003e\n\u003cp\u003e一开始以为是主题有问题，具体描述见\u003ca href=\"https://github.com/xianmin/hugo-theme-jane/issues/244\"\u003e首页文章不显示了\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003eissue\u003c/code\u003e里：\n\u003ccode\u003eshaform\u003c/code\u003e提到使用的并不是最新的版本。\n\u003ccode\u003eRocFang\u003c/code\u003e提到是\u003ccode\u003egit submodule\u003c/code\u003e使用的问题。\u003c/p\u003e\n\u003cp\u003e但是\u003ccode\u003etravis-ci\u003c/code\u003e每次都是通过\u003ccode\u003egit submodule update --init --recursive\u003c/code\u003e更新子仓库代码的，为什么会不是最新的代码呢。\u003c/p\u003e\n\u003ch4 id=\"问题重现\"\u003e问题重现\u003c/h4\u003e\n\u003cp\u003e接下来，我们用一个新的仓库，来模拟重现一下。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e克隆仓库。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos xx]# git clone git@github.com:Liudon/test.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCloning into \u0026#39;test\u0026#39;...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e添加文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e [root@VM_81_18_centos xx]# cd test/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e [root@VM_81_18_centos test]# echo \u0026#34;# test\u0026#34; \u0026gt;\u0026gt; README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e [root@VM_81_18_centos test]# git add README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e [root@VM_81_18_centos test]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e引用子仓库。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e [root@VM_81_18_centos test]# git submodule add git@github.com:xianmin/hugo-theme-jane.git theme/jane\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e Cloning into \u0026#39;theme/jane\u0026#39;...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e remote: Enumerating objects: 216, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e remote: Counting objects: 100% (216/216), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e remote: Compressing objects: 100% (128/128), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e remote: Total 6165 (delta 102), reused 159 (delta 65), pack-reused 5949\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e Receiving objects: 100% (6165/6165), 3.05 MiB | 1.70 MiB/s, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e Resolving deltas: 100% (3443/3443), done.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看文件列表。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e [root@VM_81_18_centos test]# ll\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e total 8\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e -rw-r--r-- 1 root root    5 Sep  6 16:05 README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e drwxr-xr-x 7 root root 4096 Sep  6 16:08 typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e [root@VM_81_18_centos test]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看状态。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# git status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# On branch master\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# Initial commit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e# Changes to be committed:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#   (use \u0026#34;git rm --cached \u0026lt;file\u0026gt;...\u0026#34; to unstage)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#\tnew file:   .gitmodules\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#\tnew file:   README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#\tnew file:   typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看修改。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# git diff --cached\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ediff --git a/.gitmodules b/.gitmodules\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enew file mode 100644\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eindex 0000000..b1ddf70\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e--- /dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+++ b/.gitmodules\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@@ -0,0 +1,3 @@\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+[submodule \u0026#34;typecho\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+       path = typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+       url = https://github.com/Liudon/typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ediff --git a/README.md b/README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enew file mode 100644\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eindex 0000000..9daeafb\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e--- /dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+++ b/README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@@ -0,0 +1 @@\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+test\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ediff --git a/typecho b/typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enew file mode 160000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eindex 0000000..b0c4cc7\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e--- /dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+++ b/typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@@ -0,0 +1 @@\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e+Subproject commit b0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e注意最后一行\u003ccode\u003eSubproject commit b0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e这个\u003ccode\u003ecommitId\u003c/code\u003e是子仓库最新提交的记录id，对应的\u003ca href=\"https://github.com/Liudon/typecho/commit/b0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\"\u003e修改记录\u003c/a\u003e。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e提交修改。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# git push -u origin master\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCounting objects: 4, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCompressing objects: 100% (3/3), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWriting objects: 100% (4/4), 362 bytes | 0 bytes/s, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal 4 (delta 0), reused 0 (delta 0)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTo git@github.com:Liudon/test.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e* [new branch]      master -\u0026gt; master\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBranch master set up to track remote branch master from origin.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\n\n\n\u003c/p\u003e\n\u003cp\u003e提交后，在github上子仓库后面会多显示一个\u003ccode\u003e@xxxxx\u003c/code\u003e，这里就是引用的\u003ccode\u003ecommitId\u003c/code\u003e，对应到前面\u003ccode\u003egit diff\u003c/code\u003e最后一行。\u003c/p\u003e\n\u003cp\u003e点击查看\u003ca href=\"https://github.com/Liudon/test/commit/5b11d515db8ad8d299ef1691f115590e0015c3b7\"\u003e提交记录\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\n\n\n\u003c/p\u003e\n\u003cp\u003e本次提交的\u003ccode\u003ecommitId\u003c/code\u003e为\u003ccode\u003e5b11d515db8ad8d299ef1691f115590e0015c3b7\u003c/code\u003e，子仓库typecho单独记录了引入时的\u003ccode\u003ecommitId\u003c/code\u003e，为\u003ccode\u003eb0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\u003c/code\u003e，对应的\u003ca href=\"https://github.com/Liudon/typecho/tree/b0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\"\u003e提交记录\u003c/a\u003e。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e接下来克隆子仓库，进行更新提交。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos xx]# git clone git@github.com:Liudon/typecho.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCloning into \u0026#39;typecho\u0026#39;...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Enumerating objects: 1, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Counting objects: 100% (1/1), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Total 7179 (delta 0), reused 0 (delta 0), pack-reused 7178\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eReceiving objects: 100% (7179/7179), 7.26 MiB | 2.02 MiB/s, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eResolving deltas: 100% (4844/4844), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos xx]# \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos xx]# cd typecho/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]# git log -n 1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommit b0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMerge: c904005 8fd7492\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAuthor: 祁宁 \u0026lt;magike.net@gmail.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDate:   Tue Nov 18 13:59:52 2014 +0800\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Merge branch \u0026#39;master\u0026#39; of https://github.com/typecho/typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]#\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过\u003ccode\u003egit log\u003c/code\u003e，确认最新的提交commitId为\u003ccode\u003eb0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\u003c/code\u003e，与前面的引入的一致。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]# echo \u0026#34;xxx\u0026#34; \u0026gt; test\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]# \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]# git add test\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]# git commit -m \u0026#39;test\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[master 5dcc8f4] test\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e1 file changed, 1 insertion(+)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecreate mode 100644 test\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]# git push\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCounting objects: 4, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCompressing objects: 100% (2/2), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWriting objects: 100% (3/3), 252 bytes | 0 bytes/s, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTotal 3 (delta 1), reused 0 (delta 0)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Resolving deltas: 100% (1/1), completed with 1 local object.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTo git@github.com:Liudon/typecho.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eb0c4cc7..5dcc8f4  master -\u0026gt; master\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e修改文件提交。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]# git log -n 1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommit 5dcc8f4e91cc724ba82aba5b9e7955727b58c5c2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAuthor: liudon \u0026lt;i.mu@qq.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDate:   Fri Sep 6 16:26:47 2019 +0800\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    test\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos typecho]#\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e最新提交的\u003ccode\u003ecommitId\u003c/code\u003e为\u003ccode\u003e5dcc8f4e91cc724ba82aba5b9e7955727b58c5c2\u003c/code\u003e。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e重新克隆\u003ccode\u003etest\u003c/code\u003e库。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos yy]# git clone git@github.com:Liudon/test.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCloning into \u0026#39;test\u0026#39;...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Enumerating objects: 4, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Counting objects: 100% (4/4), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Compressing objects: 100% (3/3), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Total 4 (delta 0), reused 4 (delta 0), pack-reused 0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eReceiving objects: 100% (4/4), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos yy]# cd test/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# ll\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etotal 8\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- 1 root root    5 Sep  6 16:31 README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edrwxr-xr-x 2 root root 4096 Sep  6 16:31 typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# ll typecho/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etotal 0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里可以看到\u003ccode\u003etypecho\u003c/code\u003e目录下是没有文件的。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# git submodule update --init --recursive\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSubmodule \u0026#39;typecho\u0026#39; (https://github.com/Liudon/typecho) registered for path \u0026#39;typecho\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCloning into \u0026#39;typecho\u0026#39;...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Enumerating objects: 4, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Counting objects: 100% (4/4), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Compressing objects: 100% (3/3), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Total 7182 (delta 0), reused 2 (delta 0), pack-reused 7178\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eReceiving objects: 100% (7182/7182), 7.26 MiB | 1.26 MiB/s, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eResolving deltas: 100% (4844/4844), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSubmodule path \u0026#39;typecho\u0026#39;: checked out \u0026#39;b0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]#\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e更新子仓库代码，这里可以看到最终\u003ccode\u003echeckout\u003c/code\u003e的版本为\u003ccode\u003eb0c4cc77a7f8f04661fb9f75d4ba6d4d7915b0f1\u003c/code\u003e，与前面提交时的版本一致。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"问题分析\"\u003e问题分析\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003egit submodule add\u003c/code\u003e的时候，会记录当时引入时子仓库的版本id。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003egit submodule update --init --recursive\u003c/code\u003e，会检出引入时的仓库版本，这就是为啥代码没有更新了。\u003c/p\u003e\n\u003ch4 id=\"问题解决\"\u003e问题解决\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos yy]# git clone git@github.com:Liudon/test.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCloning into \u0026#39;test\u0026#39;...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Enumerating objects: 4, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Counting objects: 100% (4/4), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Compressing objects: 100% (3/3), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Total 4 (delta 0), reused 4 (delta 0), pack-reused 0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eReceiving objects: 100% (4/4), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos yy]# \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos yy]# \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos yy]# cd test/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# ll\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etotal 8\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- 1 root root    5 Sep  6 16:37 README.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edrwxr-xr-x 2 root root 4096 Sep  6 16:37 typecho\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# ll typecho/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etotal 0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]# git submodule update --init --remote --recursive\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSubmodule \u0026#39;typecho\u0026#39; (https://github.com/Liudon/typecho) registered for path \u0026#39;typecho\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCloning into \u0026#39;typecho\u0026#39;...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Enumerating objects: 4, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Counting objects: 100% (4/4), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Compressing objects: 100% (3/3), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote: Total 7182 (delta 0), reused 2 (delta 0), pack-reused 7178\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eReceiving objects: 100% (7182/7182), 7.26 MiB | 1.24 MiB/s, done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eResolving deltas: 100% (4844/4844), done.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSubmodule path \u0026#39;typecho\u0026#39;: checked out \u0026#39;5dcc8f4e91cc724ba82aba5b9e7955727b58c5c2\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_81_18_centos test]#\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e使用\u003ccode\u003egit submodule update --init --remote --recursive\u003c/code\u003e命令。\u003c/p\u003e\n","date_published":"2019-09-06T15:13:51+08:00","tags":["git"]},{"title":"一个Curl的耗时长的问题","id":"https://liudon.com/posts/curl-cost-time-long/","url":"https://liudon.com/posts/curl-cost-time-long/","summary":"\u003cp\u003e发现某个接口请求很慢，但是后端确认接口是很快的。\u003c/p\u003e\n\u003cp\u003e在机器上通过shell执行curl命令，确实很快，但是PHP代码里请求又确实很慢。\u003c/p\u003e\n\u003cp\u003e业务里用到了\u003ccode\u003eRequests\u003c/code\u003e这个库，一开始以为是这个库导致的问题。\u003c/p\u003e","content_html":"\u003cp\u003e发现某个接口请求很慢，但是后端确认接口是很快的。\u003c/p\u003e\n\u003cp\u003e在机器上通过shell执行curl命令，确实很快，但是PHP代码里请求又确实很慢。\u003c/p\u003e\n\u003cp\u003e业务里用到了\u003ccode\u003eRequests\u003c/code\u003e这个库，一开始以为是这个库导致的问题。\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003eRequests_Transport_cURL\u003c/code\u003e类里断点定位了下，确实很慢，\u003ccode\u003ecurl_getinfo\u003c/code\u003e返回的信息如下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003earray (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;url\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;http://xxxxx\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;content_type\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;text/html\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;http_code\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;header_size\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;request_size\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e305\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;filetime\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ssl_verify_result\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;redirect_count\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;total_time\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2.074094\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;namelookup_time\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2.5E-5\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;connect_time\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.032107\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;pretransfer_time\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.032109\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;size_upload\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e186\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;size_download\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e99\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;speed_download\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e47\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;speed_upload\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e89\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;download_content_length\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e99\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;upload_content_length\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e186\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;starttransfer_time\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2.032866\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;redirect_time\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;certinfo\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  array (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里可以看到\u003ccode\u003estarttransfer_time\u003c/code\u003e时间很长。\u003c/p\u003e\n\u003cp\u003e搜索了一番，发现网上一个case，\u003ca href=\"https://stackoverflow.com/questions/20428632/curl-slow-starttransfer-time\"\u003ecURL slow starttransfer_time\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e里面提供了\u003ccode\u003eExpect: 100-continue\u003c/code\u003e这个header，又搜索了一番这个header资料。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ecurl\u003c/code\u003e在发\u003ccode\u003ePOST\u003c/code\u003e请求的时候，如果body大于1k：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e先追加一个\u003ccode\u003eExpect: 100-continue\u003c/code\u003e请求头信息，发送这个不包含 \u003ccode\u003ePOST\u003c/code\u003e 数据的请求；\u003c/li\u003e\n\u003cli\u003e如果服务器返回的响应头信息中包含Expect: 100-continue，则表示 Server 愿意接受数据，这时才 POST 真正数据给 Server；\n如果等待1s，没有收到服务器肯定或否定的应答，那么继续发起POST请求，这种会导致请求耗时变长。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e在机器上抓了个包，执行下面命令。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e注意，下面port后面的80改成实际的端口\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etcpdump -A -s 0 \u0026#39;tcp port 80 and (((ip[2:2] - ((ip[0]\u0026amp;0xf)\u0026lt;\u0026lt;2)) - ((tcp[12]\u0026amp;0xf0)\u0026gt;\u0026gt;2)) != 0)\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e拿到的包信息。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e09:17:19.421587 IP xxx.54360 \u0026gt; xxxxx:12345: Flags [P.], seq 767181008:767181314, ack 353986709, win 115, options [nop,nop,TS val 2628114858 ecr 1424896084], length 306\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eE..f.m@.@...d}@.        A...XF.-.@...h....s.......\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e....T.0TPOST /cgi HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser-Agent: php-requests/1.6\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccept: */*\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccept-Encoding: deflate, gzip\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eReferer: http://xxxxx:12345/cgi\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Length: 188\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExpect: 100-continue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Type: multipart/form-data; boundary=----------------------------ee2f4d848646\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e09:17:21.421786 IP xxx.54360 \u0026gt; xxxxx:12345: Flags [P.], seq 306:494, ack 1, win 115, options [nop,nop,TS val 2628115359 ecr 1424896091], length 188\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eE....n@.@..Md}@.        A...XF.-.B...h....s./.....\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e....T.0[------------------------------ee2f4d848646\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Disposition: form-data; name=\u0026#34;req\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\u0026#34;command\u0026#34;:\u0026#34;zzz\u0026#34;,\u0026#34;appId\u0026#34;:\u0026#34;yyyy\u0026#34;}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e------------------------------ee2f4d848646--\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e09:17:21.458628 IP xxxxx:12345 \u0026gt; xxx.54360: Flags [P.], seq 1:118, ack 494, win 130, options [nop,nop,TS val 1424896593 ecr 2628115359], length 117\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eE...X.@.5.Q2    A..d}@.F..X..h.-.B......3.....\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eT.2Q....HTTP/1.1 200 OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Type: text/html\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eContent-Length: 53\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;data\u0026#34;: [],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;errno\u0026#34;: 0,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#34;error\u0026#34;: \u0026#34;ok\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可以看到确实是先发了一个\u003ccode\u003e100-continue\u003c/code\u003e的请求，然后再发的实际\u003ccode\u003ePOST\u003c/code\u003e请求。\u003c/p\u003e\n\u003cp\u003e在机器上执行下面的shell命令。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u0026#39;http://xxxxx:12345/cgi\u0026#39; -H\u0026#34;Expect: 100-continue\u0026#34; -v\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e返回如下，可以看到返回的header头里确实没有\u003ccode\u003eExpect\u003c/code\u003e这项。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e* About to connect() to xxxxx port 12345 (#0)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e*   Trying xxxxx...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e* Connected to xxxxx (xxxxx) port 12345 (#0)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; GET /cloud_cgi HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; User-Agent: curl/7.29.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; Host: xxxxx:12345\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; Accept: */*\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; Expect: 100-continue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt; HTTP/1.1 200 OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt; Content-Type: text/html\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt; Content-Length: 42\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt; \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e* Connection #0 to host xxxxx left intact\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\u0026#34;errno\u0026#34;:100,\u0026#34;error\u0026#34;:\u0026#34;参数格式错误\u0026#34;}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e解决方法：\u003c/p\u003e\n\u003cp\u003e请求的时候，header里新增一项。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExpect:\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date_published":"2019-09-04T11:07:46+08:00","tags":["php","curl"]},{"title":"Swoft 框架运行分析（三） —— BeanProcessor模块分析","id":"https://liudon.com/posts/swoft-bean-processor-analysis/","url":"https://liudon.com/posts/swoft-bean-processor-analysis/","summary":"\u003cp\u003e今天讲一下\u003ccode\u003eBeanProcessor\u003c/code\u003e模块，先看一下\u003ccode\u003ehandle\u003c/code\u003e方法实现。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Handle bean\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function handle(): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeBean()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehandler     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new BeanHandler();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDefinitions();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eparsers     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e AnnotationRegister::getParsers();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e AnnotationRegister::getAnnotations();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::addDefinitions(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::addAnnotations(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotations);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::addParsers(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eparsers);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::setHandler(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehandler);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::init();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e Config \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e BeanFactory::getBean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;config\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;config path=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPath());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;config env=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetEnv());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003estats \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e BeanFactory::getStats();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Bean is initialized(\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e)\u0026#39;\u003c/span\u003e, SwoftHelper::formatStats(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003estats));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eafterBean();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e先通过\u003ccode\u003egetDefinitions\u003c/code\u003e方法获取所有的Bean定义。\u003c/p\u003e","content_html":"\u003cp\u003e今天讲一下\u003ccode\u003eBeanProcessor\u003c/code\u003e模块，先看一下\u003ccode\u003ehandle\u003c/code\u003e方法实现。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Handle bean\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function handle(): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeBean()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehandler     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new BeanHandler();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDefinitions();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eparsers     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e AnnotationRegister::getParsers();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e AnnotationRegister::getAnnotations();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::addDefinitions(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::addAnnotations(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotations);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::addParsers(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eparsers);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::setHandler(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ehandler);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BeanFactory::init();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e Config \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e BeanFactory::getBean(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;config\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;config path=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPath());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;config env=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetEnv());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003estats \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e BeanFactory::getStats();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Bean is initialized(\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e)\u0026#39;\u003c/span\u003e, SwoftHelper::formatStats(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003estats));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eafterBean();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e先通过\u003ccode\u003egetDefinitions\u003c/code\u003e方法获取所有的Bean定义。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Get bean definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function getDefinitions(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Core beans\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eautoLoaders \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e AnnotationRegister::getAutoLoaders();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e get disabled loaders by application\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edisabledLoaders \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDisabledAutoLoaders();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eautoLoaders as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eautoLoader) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003eautoLoader instanceof DefinitionInterface) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e get_class(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eautoLoader);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e If the component is disabled by user\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edisabledLoaders[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Auto loader(\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e) is \u0026lt;cyan\u0026gt;disabled\u0026lt;/cyan\u0026gt;, skip handle it\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e If the component is \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e enabled\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eautoLoader instanceof ComponentInterface \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003eautoLoader\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eisEnable()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e ArrayHelper::merge(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eautoLoader\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeans());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Bean definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanFile \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetBeanFile();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanFile \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e alias(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanFile);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003efile_exists(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanFile)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new InvalidArgumentException(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            sprintf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;The bean config file of \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e is not exist!\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanFile)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        );\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanDefinitions \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e require \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanFile;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e ArrayHelper::merge(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanDefinitions);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefinitions;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过\u003ccode\u003eAnnotationRegister::getAutoLoaders()\u003c/code\u003e拿到所有的autoloader对象，排除掉非\u003ccode\u003eDefinitionInterface\u003c/code\u003e对象，通过\u003ccode\u003ebean()\u003c/code\u003e方法获取定义的Bean信息。\u003c/p\u003e\n\u003cp\u003e这里以\u003ccode\u003ehttp-server\\src\\AutoLoader.php\u003c/code\u003e为例。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp declare(strict_types\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\Http\\Server;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function bean;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function dirname;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse ReflectionException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Bean\\Exception\\ContainerException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Helper\\ComposerJSON;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Message\\ContentType;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Message\\Response;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Formatter\\HtmlResponseFormatter;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Formatter\\JsonResponseFormatter;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Formatter\\XmlResponseFormatter;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Parser\\JsonRequestParser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Parser\\XmlRequestParser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Http\\Server\\Swoole\\RequestListener;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Server\\SwooleEvent;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\SwoftComponent;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class AutoLoader\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e AutoLoader \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e SwoftComponent\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Metadata information \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e the component\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esee ComponentInterface::getMetadata()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function metadata(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ejsonFile \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e dirname(__DIR__) \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/composer.json\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e ComposerJSON::open(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ejsonFile)\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetMetadata();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Get namespace \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e dirs\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function getPrefixDirs(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            __NAMESPACE__ \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e __DIR__,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ContainerException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function beans(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;httpRequest\u0026#39;\u003c/span\u003e     \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;parsers\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    ContentType::XML  \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e bean(XmlRequestParser::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    ContentType::JSON \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e bean(JsonRequestParser::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;httpResponse\u0026#39;\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;format\u0026#39;\u003c/span\u003e     \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e Response::FORMAT_JSON,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;formatters\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    Response::FORMAT_HTML \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e bean(HtmlResponseFormatter::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    Response::FORMAT_JSON \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e bean(JsonResponseFormatter::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    Response::FORMAT_XML  \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e bean(XmlResponseFormatter::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;acceptFormatter\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;formats\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    ContentType::JSON \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e Response::FORMAT_JSON,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    ContentType::HTML \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e Response::FORMAT_HTML,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    ContentType::XML  \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e Response::FORMAT_XML,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;httpServer\u0026#39;\u003c/span\u003e      \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;on\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    SwooleEvent::REQUEST \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e bean(RequestListener::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;httpRouter\u0026#39;\u003c/span\u003e      \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e            \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;swoft-http-router\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e config\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ignoreLastSlash\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e true,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;tmpCacheNumber\u0026#39;\u003c/span\u003e  \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可以看到，这里通过\u003ccode\u003ebeans()\u003c/code\u003e定义了\u003ccode\u003ehttpRequest\u003c/code\u003e、\u003ccode\u003ehttpResponse\u003c/code\u003e、\u003ccode\u003eacceptFormatter\u003c/code\u003e、\u003ccode\u003ehttpServer\u003c/code\u003e和\u003ccode\u003ehttpRouter\u003c/code\u003e四个Bean对象。\u003c/p\u003e\n\u003cp\u003e回到上面\u003ccode\u003egetDefinitions\u003c/code\u003e方法。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$definitions = ArrayHelper::merge($definitions, $autoLoader-\u0026gt;beans());\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e然后将Bean信息添加到\u003ccode\u003edefinitions\u003c/code\u003e对象上。\u003c/p\u003e\n\u003cp\u003e之后通过\u003ccode\u003e$beanFile = $this-\u0026gt;application-\u0026gt;getBeanFile();\u003c/code\u003e获取bean配置文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$beanDefinitions = require $beanFile;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$definitions     = ArrayHelper::merge($definitions, $beanDefinitions);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e加载配置文件，然后将Bean信息添加到\u003ccode\u003edefinitions\u003c/code\u003e对象上。\u003c/p\u003e\n\u003cp\u003e可以看到Bean有两种定义方式：通过AutoLoader和配置文件，与\u003ca href=\"https://en.swoft.org/docs/2.x/zh-CN/bean/bean.html\"\u003eswoft官方文档\u003c/a\u003e里的说明一致。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003ehandle\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$parsers     = AnnotationRegister::getParsers();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$annotations = AnnotationRegister::getAnnotations();\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e还记得上一篇文章最后提到的\u003ccode\u003eAnnotationRegister\u003c/code\u003e类的\u003ccode\u003eannotations\u003c/code\u003e和\u003ccode\u003eparsers\u003c/code\u003e两个属性吗？这里通过\u003ccode\u003egetParsers\u003c/code\u003e和\u003ccode\u003egetAnnotations\u003c/code\u003e获取这两个属性。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBeanFactory::addDefinitions($definitions);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBeanFactory::addAnnotations($annotations);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBeanFactory::addParsers($parsers);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBeanFactory::setHandler($handler);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBeanFactory::init();\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e向BeanFatory注册信息。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Init\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function init(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Container::getInstance()-\u0026gt;init();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Add definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function addDefinitions(array $definitions): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Container::getInstance()-\u0026gt;addDefinitions($definitions);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Add annotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $annotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function addAnnotations(array $annotations): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Container::getInstance()-\u0026gt;addAnnotations($annotations);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Add annotation parsers\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $annotationParsers\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function addParsers(array $annotationParsers): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Container::getInstance()-\u0026gt;addParsers($annotationParsers);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Set bean handler\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param HandlerInterface $handler\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function setHandler(HandlerInterface $handler): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Container::getInstance()-\u0026gt;setHandler($handler);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里可以看到所有的方法，最终都调用的是\u003ccode\u003eSwoft\\Bean\\Container\u003c/code\u003e类。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Add definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function addDefinitions(array $definitions): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;definitions = ArrayHelper::merge($this-\u0026gt;definitions, $definitions);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Add annotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $annotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function addAnnotations(array $annotations): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;annotations = ArrayHelper::merge($this-\u0026gt;annotations, $annotations);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Add annotation parsers\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $annotationParsers\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function addParsers(array $annotationParsers): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;parsers = ArrayHelper::merge($this-\u0026gt;parsers, $annotationParsers);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param HandlerInterface $handler\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function setHandler(HandlerInterface $handler): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;handler = $handler;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这四个方法就是注册属性，接下来是重头戏\u003ccode\u003einit\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Init\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function init(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Parse annotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;parseAnnotations();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Parse definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;parseDefinitions();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Init beans\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $this-\u0026gt;initializeBeans();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e先看\u003ccode\u003eparseAnnotations\u003c/code\u003e方法，从代码注释上也可以看出大概，解析注解，接下来我们看下具体是如何实现的。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Parse annotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function parseAnnotations(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $annotationParser = new AnnotationObjParser(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;definitions, $this-\u0026gt;objectDefinitions, $this-\u0026gt;classNames, $this-\u0026gt;aliases\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    );\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $annotationData   = $annotationParser-\u0026gt;parseAnnotations($this-\u0026gt;annotations, $this-\u0026gt;parsers);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    [$this-\u0026gt;definitions, $this-\u0026gt;objectDefinitions, $this-\u0026gt;classNames, $this-\u0026gt;aliases] = $annotationData;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e声明了一个\u003ccode\u003eAnnotationObjParser\u003c/code\u003e对象，调用了\u003ccode\u003eparseAnnotations\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Parse annotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eparsers\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function parseAnnotations(array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotations, array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eparsers): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparsers     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eparsers;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eannotations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotations;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eannotations as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloadNameSpace \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclasses) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclasses as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassOneAnnotations) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparseOneClassAnnotations(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassOneAnnotations);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edefinitions, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eobjectDefinitions, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassNames, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ealiases];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里遍历所有的\u003ccode\u003eannotation\u003c/code\u003e类，循环调用\u003ccode\u003eparseOneClassAnnotations\u003c/code\u003e进行解析。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-zed\" data-lang=\"zed\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * Parse class all annotations\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param string $className\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param array  $classOneAnnotations\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @throws AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function parseOneClassAnnotations(string \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName, array \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassOneAnnotations)\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Check class annotation tag\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eisset(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassOneAnnotations[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003eannotation\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new AnnotationException(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            sprintf(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003eProperty or method(\u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003es) with \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`@\u003c/span\u003exxx\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e`\u003c/span\u003e must be define class annotation\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        );\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Parse class annotations\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassAnnotations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassOneAnnotations[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003eannotation\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ereflectionClass  \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassOneAnnotations[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003ereflection\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassAry \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ereflectionClass,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassAnnotations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjectDefinition \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparseClassAnnotations(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassAry);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Parse property annotations\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects        \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyAllAnnotations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassOneAnnotations[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003eproperties\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyAllAnnotations as \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyOneAnnotations) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproAnnotations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyOneAnnotations[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003eannotation\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInject \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparsePropertyAnnotations(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassAry, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproAnnotations);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInject) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInject;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Parse method annotations\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodInjects        \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodAllAnnotations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassOneAnnotations[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003emethods\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodAllAnnotations as \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodName \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodOneAnnotations) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodAnnotations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodOneAnnotations[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003eannotation\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodInject \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparseMethodAnnotations(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassAry, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodName, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodAnnotations);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodInject) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodInjects[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodName] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodInject;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjectDefinition) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eempty(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetPropertyInjections(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eempty(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodInjects)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetMethodInjections(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003emethodInjects);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Object definition and class name\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ename         \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ealiase       \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetAlias();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassNames   \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassNames[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassNames[] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ename;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassNames[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName]   \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e array_unique(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassNames);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eobjectDefinitions[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ename] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjectDefinition;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eempty(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ealiase)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ealiases[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ealiase] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ename;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里可以看到分别有类注解、属性注解和方法注解三类。\u003c/p\u003e\n\u003cp\u003e对应官方文档的\u003ca href=\"https://en.swoft.org/docs/2.x/zh-CN/annotation/index.html#%E8%A7%84%E8%8C%83\"\u003e注解说明\u003c/a\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param array $classAry\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return ObjectDefinition|null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function parseClassAnnotations(array $classAry): ?ObjectDefinition\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    [, , $classAnnotations] = $classAry;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $objectDefinition = null;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach ($classAnnotations as $annotation) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $annotationClass = get_class($annotation);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (!isset($this-\u0026gt;parsers[$annotationClass])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            continue;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $parserClassName  = $this-\u0026gt;parsers[$annotationClass];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $annotationParser = $this-\u0026gt;getAnnotationParser($classAry, $parserClassName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $data = $annotationParser-\u0026gt;parse(Parser::TYPE_CLASS, $annotation);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (empty($data)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            continue;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (count($data) !== 4) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            throw new InvalidArgumentException(sprintf(\u0026#39;%s annotation parse must be 4 size\u0026#39;, $annotationClass));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        [$name, $className, $scope, $alias] = $data;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $name = empty($name) ? $className : $name;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (empty($className)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            throw new InvalidArgumentException(sprintf(\u0026#39;%s with class name can not be empty\u0026#39;, $annotationClass));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        // Multiple coverage\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $objectDefinition = new ObjectDefinition($name, $className, $scope, $alias);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return $objectDefinition;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e类注解，这里会调用对应解析类的\u003ccode\u003eparse\u003c/code\u003e方法。\u003c/p\u003e\n\u003cp\u003e这里以\u003ccode\u003ewebsocket-server\\src\\Annotation\\Mapping\\WsModule.php\u003c/code\u003e和\u003ccode\u003ewebsocket-server\\src\\Annotation\\Parser\\WsModuleParser.php\u003c/code\u003e为例。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp declare(strict_types\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\WebSocket\\Server\\Annotation\\Mapping;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Doctrine\\Common\\Annotations\\Annotation\\Attribute;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Doctrine\\Common\\Annotations\\Annotation\\Attributes;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Doctrine\\Common\\Annotations\\Annotation\\Required;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Doctrine\\Common\\Annotations\\Annotation\\Target;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\WebSocket\\Server\\MessageParser\\RawTextParser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class WebSocket \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e mark an websocket module handler \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAnnotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eTarget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CLASS\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAttributes(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e     \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAttribute(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e, type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;string\u0026#34;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e     \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAttribute(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;path\u0026#34;\u003c/span\u003e, type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;string\u0026#34;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e     \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAttribute(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;controllers\u0026#34;\u003c/span\u003e, type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;array\u0026#34;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e     \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAttribute(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;messageParser\u0026#34;\u003c/span\u003e, type\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;string\u0026#34;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e )\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efinal \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e WsModule\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Websocket route path\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e(it must unique \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e a application)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eRequired()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epath \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Module name\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Routing path params binding\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e eg\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e {\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\d+\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eparams \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Message controllers of the module\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e string[]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econtrollers \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Message parser \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e the module\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emessageParser \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e RawTextParser::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Default message command\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e Format \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;controller.action\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefaultCommand \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;home.index\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Default message opcode \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e please see WEBSOCKET_OPCODE_\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edefaultOpcode \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class constructor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function __construct(array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;value\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003epath \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (string)\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;value\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } elseif (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;path\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003epath \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (string)\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;path\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (string)\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;params\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparams \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (array)\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;params\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;controllers\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003econtrollers \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (array)\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;controllers\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;messageParser\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003emessageParser \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;messageParser\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;defaultOpcode\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edefaultOpcode \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;defaultOpcode\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;defaultCommand\u0026#39;\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edefaultCommand \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003evalues[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;defaultCommand\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function getPath(): string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003epath;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function getMessageParser(): string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003emessageParser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function getDefaultCommand(): string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edefaultCommand;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function getName(): string\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ename;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e string[]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function getControllers(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003econtrollers;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function getParams(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparams;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function getDefaultOpcode(): \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edefaultOpcode;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003eWsModule\u003c/code\u003e声明了一个类注解。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp declare(strict_types\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\WebSocket\\Server\\Annotation\\Parser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\Annotation\\Mapping\\AnnotationParser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\Annotation\\Parser\\Parser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\Exception\\AnnotationException;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Bean\\Annotation\\Mapping\\Bean;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Stdlib\\Helper\\Str;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\WebSocket\\Server\\Annotation\\Mapping\\WsModule;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\WebSocket\\Server\\MessageParser\\RawTextParser;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\WebSocket\\Server\\Router\\RouteRegister;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class WebSocketParser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eAnnotationParser(WsModule::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e WsModuleParser \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e Parser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Parse object\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e      \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype Class \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e Method \u003cspan style=\"color:#f92672\"\u003eor\u003c/span\u003e Property\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam WsModule \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann  Annotation object\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Return empty array is nothing to \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e When \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e type \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escope, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealias, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esize] is to inject bean\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e When property type \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epropertyValue, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eisRef] is to reference value\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function parse(\u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype \u003cspan style=\"color:#f92672\"\u003e!==\u003c/span\u003e self::TYPE_CLASS) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            throw new AnnotationException(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;`@WsModule` must be defined on class!\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassName;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        RouteRegister::bindModule(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e, [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;path\u0026#39;\u003c/span\u003e           \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPath() \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e: Str::getClassName(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Module\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e           \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetName(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;params\u0026#39;\u003c/span\u003e         \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetParams(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;class\u0026#39;\u003c/span\u003e          \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;eventMethods\u0026#39;\u003c/span\u003e   \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;controllers\u0026#39;\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetControllers(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;messageParser\u0026#39;\u003c/span\u003e  \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetMessageParser() \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003e: RawTextParser::\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;defaultOpcode\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDefaultOpcode(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;defaultCommand\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eann\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDefaultCommand(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e, Bean::SINGLETON, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e按上一篇文章说明，这里\u003ccode\u003eWsModuleParser\u003c/code\u003e会被标记为注解类\u003ccode\u003eWsModule\u003c/code\u003e的注解解析类。\u003c/p\u003e\n\u003cp\u003e解析注解的时候，会调用\u003ccode\u003eWsModuleParser\u003c/code\u003e的\u003ccode\u003eparse\u003c/code\u003e方法，这里通过\u003ccode\u003eRouteRegister::bindModule\u003c/code\u003e做了一些路由操作，这里后续再讲，这里不做深入介绍。\u003c/p\u003e\n\u003cp\u003e属性和方法注解，也是类似的，\u003ccode\u003eparseAnnotations\u003c/code\u003e方法就讲完了。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003eContainer\u003c/code\u003e类的\u003ccode\u003einit\u003c/code\u003e方法，接下来调用了\u003ccode\u003eparseDefinitions\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Parse definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function parseDefinitions(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $annotationParser = new DefinitionObjParser(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;definitions, $this-\u0026gt;objectDefinitions, $this-\u0026gt;classNames, $this-\u0026gt;aliases\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    );\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Collect info\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $definitionData = $annotationParser-\u0026gt;parseDefinitions();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    [$this-\u0026gt;definitions, $this-\u0026gt;objectDefinitions, $this-\u0026gt;classNames, $this-\u0026gt;aliases] = $definitionData;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e声明了一个\u003ccode\u003eDefinitionObjParser\u003c/code\u003e对象，调用了\u003ccode\u003eparseDefinitions\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Parse definitions\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function parseDefinitions(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach ($this-\u0026gt;definitions as $beanName =\u0026gt; $definition) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (isset($this-\u0026gt;objectDefinitions[$beanName])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $objectDefinition = $this-\u0026gt;objectDefinitions[$beanName];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $this-\u0026gt;resetObjectDefinition($beanName, $objectDefinition, $definition);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            continue;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;createObjectDefinition($beanName, $definition);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return [$this-\u0026gt;definitions, $this-\u0026gt;objectDefinitions, $this-\u0026gt;classNames, $this-\u0026gt;aliases];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e遍历所有的\u003ccode\u003eBean\u003c/code\u003e对象，调用\u003ccode\u003ecreateObjectDefinition\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-zed\" data-lang=\"zed\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * Create object definition for definition\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param string $beanName\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param array  $definition\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function createObjectDefinition(string \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ebeanName, array \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003eclass\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (empty(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new InvalidArgumentException(sprintf(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003es key for \u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e must be defined class\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ebeanName));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDefinition \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new ObjectDefinition(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ebeanName, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDefinition \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eupdateObjectDefinitionByDefinition(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDefinition, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassNames   \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassNames[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassNames[] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ebeanName;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassNames[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassName]       \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e array_unique(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eclassNames);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eobjectDefinitions[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ebeanName] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDefinition;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e声明了\u003ccode\u003eObjectDefinition\u003c/code\u003e对象，调用了\u003ccode\u003eupdateObjectDefinitionByDefinition\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-zed\" data-lang=\"zed\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * Update definition\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param ObjectDefinition $objDfn\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param array            $definition\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @return ObjectDefinition\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function updateObjectDefinitionByDefinition(ObjectDefinition \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDfn, array \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e ObjectDefinition\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    [\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructInject, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eoption] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparseDefinition(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Set construct inject\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eempty(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructInject)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDfn\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetConstructorInjection(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructInject);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Set property inject\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    foreach (\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects as \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInject) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDfn\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetPropertyInjection(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInject);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003escopes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Bean\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003eSINGLETON,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Bean\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003ePROTOTYPE,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Bean\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003eREQUEST,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003escope \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eoption[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003escope\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ealias \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eoption[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003ealias\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eempty(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003escope) \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003ein_array(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003escope, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003escopes, true)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new InvalidArgumentException(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003eScope for \u003cspan style=\"color:#66d9ef\"\u003edefinition\u003c/span\u003e is not undefined\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Update scope\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eempty(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003escope)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDfn\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetScope(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003escope);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// Update alias\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    if (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eempty(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ealias)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDfn\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetAlias(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ealias);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjAlias \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDfn\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetAlias();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        unset(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ealiases[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjAlias]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ealiases[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ealias] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDfn\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eobjDfn;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里调用了\u003ccode\u003eparseDefinition\u003c/code\u003e方法进行解析。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-mysql\" data-lang=\"mysql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * Parse definition\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @param array $definition\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    * @return array\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function \u003cspan style=\"color:#a6e22e\"\u003eparseDefinition\u003c/span\u003e(array \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003edefinition): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Remove class \u003cspan style=\"color:#66d9ef\"\u003ekey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eunset\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003edefinition[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;class\u0026#39;\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Parse construct\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructArgs \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003edefinition[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eis_array\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructArgs)) \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new \u003cspan style=\"color:#a6e22e\"\u003eInvalidArgumentException\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Construct args for definition must be array\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Parse construct args\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eargInjects \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eforeach\u003c/span\u003e (\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructArgs \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003earg) \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        [\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eargValue, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eargIsRef] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egetValueByRef\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003earg);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eargInjects[] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new \u003cspan style=\"color:#a6e22e\"\u003eArgsInjection\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eargValue, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eargIsRef);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eSet\u003c/span\u003e construct inject\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructInject \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enull\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eempty\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eargInjects)) \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructInject \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new \u003cspan style=\"color:#a6e22e\"\u003eMethodInjection\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;__construct\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eargInjects);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Remove construct definition\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eunset\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003edefinition[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Parse definition \u003cspan style=\"color:#66d9ef\"\u003eoption\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eoption\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003edefinition[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;__option\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e??\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eis_array\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eoption\u003c/span\u003e)) \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        throw new \u003cspan style=\"color:#a6e22e\"\u003eInvalidArgumentException\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;__option for definition must be array\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Remove \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e__option\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eunset\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003edefinition[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;__option\u0026#39;\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Parse definition properties\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eforeach\u003c/span\u003e (\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003edefinition \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyValue) \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eis_string\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName)) \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            throw new \u003cspan style=\"color:#a6e22e\"\u003eInvalidArgumentException\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Property key from definition must be string\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        [\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproValue, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproIsRef] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egetValueByRef\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyValue);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Parse property \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003eis_array\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproValue)) \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproValue \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eparseArrayProperty\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproValue);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInject \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new \u003cspan style=\"color:#a6e22e\"\u003ePropertyInjection\u003c/span\u003e(\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproValue, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eproIsRef);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects[\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyName] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInject;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003econstructInject, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003epropertyInjects, \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eoption\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e解析\u003ccode\u003e__construct\u003c/code\u003e方法和传参，解析属性信息。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003eupdateObjectDefinitionByDefinition\u003c/code\u003e方法，将\u003ccode\u003e__construct\u003c/code\u003e和类属性信息注册到\u003ccode\u003eObjectDefinition\u003c/code\u003e对象上，到这里\u003ccode\u003eparseDefinitions\u003c/code\u003e方法执行完毕。\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003eContainer\u003c/code\u003e类的\u003ccode\u003einit\u003c/code\u003e方法，接下来调用了\u003ccode\u003einitializeBeans\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Initialize beans\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows InvalidArgumentException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function initializeBeans(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e ObjectDefinition \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eobjectDefinitions as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escope \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetScope();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Exclude request\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escope \u003cspan style=\"color:#f92672\"\u003e===\u003c/span\u003e Bean::REQUEST) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003erequestDefinitions[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            unset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eobjectDefinitions[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Exclude session\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escope \u003cspan style=\"color:#f92672\"\u003e===\u003c/span\u003e Bean::SESSION) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esessionDefinitions[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            unset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eobjectDefinitions[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e New bean\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enewBean(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e对于\u003ccode\u003escope\u003c/code\u003e不为\u003ccode\u003eBean::REQUEST\u003c/code\u003e和\u003ccode\u003eBean::SESSION\u003c/code\u003e的，调用\u003ccode\u003enewBean\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Initialize beans\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e object\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function newBean(string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName, string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e First, check bean whether has been create\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esingletonPool[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName]) \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprototypePool[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eget(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Get object definition\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetNewObjectDefinition(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escope     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetScope();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealias     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetAlias();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetClassName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Cache reflection \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e info\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Reflections::cache(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Before initialize bean\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeInit(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econstructArgs   \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econstructInject \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetConstructorInjection();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econstructInject \u003cspan style=\"color:#f92672\"\u003e!==\u003c/span\u003e null) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econstructArgs \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetConstructParams(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econstructInject, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epropertyInjects \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eobjectDefinition\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPropertyInjections();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Proxy \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ehandler) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ehandler\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassProxy(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereflectionClass \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new ReflectionClass(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereflectObject   \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enewInstance(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereflectionClass, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econstructArgs);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Inject properties values\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enewProperty(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereflectObject, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereflectionClass, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epropertyInjects, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Alias\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eempty(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealias)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ealiases[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ealias] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Call init method \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e exist\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereflectionClass\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ehasMethod(self::INIT_METHOD)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereflectObject\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e{self::INIT_METHOD}();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetNewBean(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ebeanName, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003escope, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ereflectObject, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eid);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过反射实例化\u003ccode\u003eBean\u003c/code\u003e对应的类，注册对应的属性。\u003c/p\u003e\n\u003cp\u003e如果类存在\u003ccode\u003eself::INIT_METHOD\u003c/code\u003e方法，执行此方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $beanName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $scope\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param object $object\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return object\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function setNewBean(string $beanName, string $scope, $object, string $id = \u0026#39;\u0026#39;)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    switch ($scope) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        case Bean::SINGLETON: // Singleton\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $this-\u0026gt;singletonPool[$beanName] = $object;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            break;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        case Bean::PROTOTYPE:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $this-\u0026gt;prototypePool[$beanName] = $object;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            // Clone it\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $object = clone $object;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            break;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        case Bean::REQUEST:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $this-\u0026gt;requestPool[$id][$beanName] = $object;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            break;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        case Bean::SESSION:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $this-\u0026gt;sessionPool[$id][$beanName] = $object;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            break;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return $object;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003esetNewBean\u003c/code\u003e方法，根据对应的scope信息，将实例化后的反射类注册到对应的类属性上。\u003c/p\u003e\n\u003cp\u003e到这里\u003ccode\u003eBeanProcessor\u003c/code\u003e类就执行完了。\u003c/p\u003e\n","date_published":"2019-09-02T18:29:06+08:00","tags":["Swoft"]},{"title":"Swoft 框架运行分析（二） —— AnnotationProcessor模块分析","id":"https://liudon.com/posts/swoft-anaotion-processor-analysis/","url":"https://liudon.com/posts/swoft-anaotion-processor-analysis/","summary":"\u003cp\u003e上一篇介绍了，\u003ccode\u003eSwoftApplication\u003c/code\u003e里定义了6个Processor对象。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotected function processors(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new EnvProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new ConfigProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new AnnotationProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new BeanProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new EventProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new ConsoleProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e所有的Processor实现都在\u003ccode\u003eframework\\src\\Processor\u003c/code\u003e目录下。\u003c/p\u003e","content_html":"\u003cp\u003e上一篇介绍了，\u003ccode\u003eSwoftApplication\u003c/code\u003e里定义了6个Processor对象。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotected function processors(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new EnvProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new ConfigProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new AnnotationProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new BeanProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new EventProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new ConsoleProcessor($this),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e所有的Processor实现都在\u003ccode\u003eframework\\src\\Processor\u003c/code\u003e目录下。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eEnvProcessor，运行环境检查。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eConfigProcessor，配置相关。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAnnotationProcessor，注解相关。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBeanProcessor，Bean相关。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eEventProcessor，事件相关。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eConsoleProcessor，命令行输入相关。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e今天先讲一下\u003ccode\u003eAnnotationProcessor\u003c/code\u003e这个模块的实现。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp declare(strict_types\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\Processor;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Exception;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Annotation\\AnnotationRegister;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Log\\Helper\\CLog;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Annotation processor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e AnnotationProcessor \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e Processor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Handle annotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows Exception\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function handle(): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeAnnotation()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            CLog::warning(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Stop annotation processor by beforeAnnotation return false\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e false;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eapp \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Find AutoLoader classes\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e Parse \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e collect annotations\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        AnnotationRegister::load([\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;inPhar\u0026#39;\u003c/span\u003e               \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \\IN_PHAR,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;basePath\u0026#39;\u003c/span\u003e             \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eapp\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetBasePath(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;notifyHandler\u0026#39;\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e [\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;notifyHandler\u0026#39;\u003c/span\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;disabledAutoLoaders\u0026#39;\u003c/span\u003e  \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eapp\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDisabledAutoLoaders(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;disabledPsr4Prefixes\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eapp\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDisabledPsr4Prefixes(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003estats \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e AnnotationRegister::getClassStats();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        CLog::info(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Annotations is scanned(autoloader \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e, annotation \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e, parser \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e)\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003estats[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;autoloader\u0026#39;\u003c/span\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003estats[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;annotation\u0026#39;\u003c/span\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003estats[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;parser\u0026#39;\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        );\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eafterAnnotation();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esee \\Swoft\\Annotation\\\u003cspan style=\"color:#a6e22e\"\u003eResource\u003c/span\u003e\\AnnotationResource::load()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function notifyHandler(string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eswitch\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etype) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;excludeNs\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                CLog::debug(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Exclude namespace \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;noLoaderFile\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                CLog::debug(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;No autoloader on \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;noLoaderClass\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                CLog::debug(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Autoloader class not exist \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;findLoaderClass\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                CLog::debug(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Find autoloader \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;addLoaderClass\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                CLog::debug(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Parse autoloader \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;noExistClass\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                CLog::debug(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Skip interface or trait \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003etarget);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e核心逻辑调用\u003ccode\u003eAnnotationRegister\u003c/code\u003e类的\u003ccode\u003eload\u003c/code\u003e方法，定义如下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Load annotation \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic \u003cspan style=\"color:#66d9ef\"\u003estatic\u003c/span\u003e function load(array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresource \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new AnnotationResource(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eresource\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eload();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里又调用了\u003ccode\u003eAnnotationResource\u003c/code\u003e类的\u003ccode\u003eload\u003c/code\u003e方法，定义如下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Load annotation resource by find ClassLoader\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic function load(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprefixDirsPsr4 \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclassLoader\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPrefixesPsr4();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprefixDirsPsr4 as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epaths) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Only scan namespaces\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eonlyNamespaces \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003ein_array(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eonlyNamespaces, true)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enotify(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;excludeNs\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e It is excluded psr4 prefix\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eisExcludedPsr4Prefix(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            AnnotationRegister::registerExcludeNs(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enotify(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;excludeNs\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Find package\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003ecomponent loader \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epaths as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epath) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderFile \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetAnnotationClassLoaderFile(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epath);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003efile_exists(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderFile)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enotify(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;noLoaderFile\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclearBasePath(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epath), \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderFile);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetAnnotationLoaderClassName(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eclass_exists(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enotify(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;noLoaderClass\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderObject \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003eloaderObject instanceof LoaderInterface) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enotify(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;invalidLoader\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderFile);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enotify(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;findLoaderClass\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eclearBasePath(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderFile));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e If is disable, will skip scan annotation classes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eisset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003edisabledAutoLoaders[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                AnnotationRegister::registerAutoLoaderFile(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderFile);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enotify(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;addLoaderClass\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderClass);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eloadAnnotation(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderObject);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Storage auto loader to register\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            AnnotationRegister::addAutoLoader(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloaderObject);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过\u003ccode\u003egetPrefixesPsr4\u003c/code\u003e方法获取所有自动加载的命名空间和目录，遍历目录下的\u003ccode\u003eAutoLoader.php\u003c/code\u003e文件。\u003c/p\u003e\n\u003cp\u003e通过\u003ccode\u003eregisterAutoLoaderFile\u003c/code\u003e注册自动加载文件到\u003ccode\u003eAnnotationRegister\u003c/code\u003e对象上。\u003c/p\u003e\n\u003cp\u003e然后调用了\u003ccode\u003eloadAnnotation\u003c/code\u003e方法，传入的是一个\u003ccode\u003eautoload\u003c/code\u003e对象。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Load annotations from an component loader config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam LoaderInterface \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloader\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003ethrows ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function loadAnnotation(LoaderInterface \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloader): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ensPaths \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloader\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPrefixDirs();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ensPaths as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epath) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eiterator \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e DirectoryHelper::recursiveIterator(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epath);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e/*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e SplFileInfo \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esplFileInfo \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eiterator as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esplFileInfo) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilePath \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esplFileInfo\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetPathname();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esplFileInfo\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eisDir();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (is_dir(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilePath)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efileName  \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esplFileInfo\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetFilename();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eextension \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esplFileInfo\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetExtension();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eloaderClassSuffix \u003cspan style=\"color:#f92672\"\u003e!==\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eextension \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e strpos(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efileName, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;.\u0026#39;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e===\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e It is exclude filename\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eexcludedFilenames[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efileName])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                AnnotationRegister::registerExcludeFilename(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efileName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esuffix    \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e sprintf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;.\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eloaderClassSuffix);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epathName  \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e str_replace([\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epath, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003esuffix], [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\\\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e], \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilePath);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e sprintf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003epathName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Fix repeat included file bug\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eautoload \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e in_array(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003efilePath, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eincludedFiles, true);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Will filtering: interfaces \u003cspan style=\"color:#f92672\"\u003eand\u003c/span\u003e traits\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eclass_exists(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName, \u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003eautoload)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003enotify(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;noExistClass\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Parse annotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eparseAnnotation(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ens, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过getPrefixDirs获取当前命名空间的目录，然后通过\u003ccode\u003erecursiveIterator\u003c/code\u003e遍历目录下的文件。\u003c/p\u003e\n\u003cp\u003e排除目录和非\u003ccode\u003e.php\u003c/code\u003e结尾的文件，最后会调用\u003ccode\u003eparseAnnotation\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Parser annotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $namespace\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $className\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function parseAnnotation(string $namespace, string $className): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Annotation reader\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $reflectionClass = new ReflectionClass($className);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Fix ignore abstract\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if ($reflectionClass-\u0026gt;isAbstract()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $oneClassAnnotation = $this-\u0026gt;parseOneClassAnnotation($reflectionClass);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (!empty($oneClassAnnotation)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        AnnotationRegister::registerAnnotation($namespace, $className, $oneClassAnnotation);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里调用了\u003ccode\u003eparseOneClassAnnotation\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * Parse an class annotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param ReflectionClass $reflectionClass\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    *\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @return array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws AnnotationException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @throws ReflectionException\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprivate function parseOneClassAnnotation(ReflectionClass $reflectionClass): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Annotation reader\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $reader    = new AnnotationReader();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $className = $reflectionClass-\u0026gt;getName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $oneClassAnnotation = [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $classAnnotations   = $reader-\u0026gt;getClassAnnotations($reflectionClass);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Register annotation parser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach ($classAnnotations as $classAnnotation) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if ($classAnnotation instanceof AnnotationParser) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $this-\u0026gt;registerParser($className, $classAnnotation);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            return [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Class annotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if (!empty($classAnnotations)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $oneClassAnnotation[\u0026#39;annotation\u0026#39;] = $classAnnotations;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $oneClassAnnotation[\u0026#39;reflection\u0026#39;] = $reflectionClass;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Property annotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $reflectionProperties = $reflectionClass-\u0026gt;getProperties();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach ($reflectionProperties as $reflectionProperty) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $propertyName        = $reflectionProperty-\u0026gt;getName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $propertyAnnotations = $reader-\u0026gt;getPropertyAnnotations($reflectionProperty);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (!empty($propertyAnnotations)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $oneClassAnnotation[\u0026#39;properties\u0026#39;][$propertyName][\u0026#39;annotation\u0026#39;] = $propertyAnnotations;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $oneClassAnnotation[\u0026#39;properties\u0026#39;][$propertyName][\u0026#39;reflection\u0026#39;] = $reflectionProperty;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    // Method annotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $reflectionMethods = $reflectionClass-\u0026gt;getMethods();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    foreach ($reflectionMethods as $reflectionMethod) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $methodName        = $reflectionMethod-\u0026gt;getName();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $methodAnnotations = $reader-\u0026gt;getMethodAnnotations($reflectionMethod);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (!empty($methodAnnotations)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $oneClassAnnotation[\u0026#39;methods\u0026#39;][$methodName][\u0026#39;annotation\u0026#39;] = $methodAnnotations;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $oneClassAnnotation[\u0026#39;methods\u0026#39;][$methodName][\u0026#39;reflection\u0026#39;] = $reflectionMethod;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $parentReflectionClass = $reflectionClass-\u0026gt;getParentClass();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if ($parentReflectionClass !== false) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $parentClassAnnotation = $this-\u0026gt;parseOneClassAnnotation($parentReflectionClass);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        if (!empty($parentClassAnnotation)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            $oneClassAnnotation[\u0026#39;parent\u0026#39;] = $parentClassAnnotation;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    return $oneClassAnnotation;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里就是解析注解了，可以看到分别有类注解、属性注解和方法注解三类。\u003c/p\u003e\n\u003cp\u003e这里注意这一段代码。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Register annotation parser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eforeach ($classAnnotations as $classAnnotation) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    if ($classAnnotation instanceof AnnotationParser) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $this-\u0026gt;registerParser($className, $classAnnotation);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        return [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e遍历注解类，如果注解属于\u003ccode\u003eAnnotationParser\u003c/code\u003e实例，这里调用\u003ccode\u003eregisterParser\u003c/code\u003e进行注册。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $annotationClass\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    * @param string $parserClassName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    */\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic static function registerParser(string $annotationClass, string $parserClassName): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::$classStats[\u0026#39;parser\u0026#39;]++;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::$parsers[$annotationClass] = $parserClassName;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e回到上一个方法，解析完后，又调用了\u003ccode\u003eAnnotationRegister\u003c/code\u003e类的\u003ccode\u003eregisterAnnotation\u003c/code\u003e方法进行注册。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloadNamespace\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam array  \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassAnnotation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epublic \u003cspan style=\"color:#66d9ef\"\u003estatic\u003c/span\u003e function registerAnnotation(string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloadNamespace, string \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName, array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassAnnotation): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassStats[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;annotation\u0026#39;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self::\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eannotations[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eloadNamespace][\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassName] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eclassAnnotation;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e至此，整个\u003ccode\u003eAnnotationProcessor\u003c/code\u003e加载完毕，这里\u003ccode\u003eAnnotationRegister\u003c/code\u003e类里会有\u003ccode\u003eannotations\u003c/code\u003e和\u003ccode\u003eparsers\u003c/code\u003e两个属性，这个信息在后面的\u003ccode\u003eBeanProcessor\u003c/code\u003e里还会用到。\u003c/p\u003e\n","date_published":"2019-08-29T19:11:04+08:00","tags":["Swoft"]},{"title":"Swoft 框架运行分析（一）","id":"https://liudon.com/posts/swoft-execution-analysis/","url":"https://liudon.com/posts/swoft-execution-analysis/","summary":"\u003cblockquote\u003e\n\u003cp\u003eSwoft 是一款基于 Swoole 扩展实现的 PHP 微服务协程框架。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e以前一直都是用的原生swoole框架，最近有时间研究了下衍生的Swoft框架。\u003c/p\u003e\n\u003cp\u003e刚开始看的时候，感觉自己像个原始人，完全看不懂。\u003c/p\u003e","content_html":"\u003cblockquote\u003e\n\u003cp\u003eSwoft 是一款基于 Swoole 扩展实现的 PHP 微服务协程框架。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e以前一直都是用的原生swoole框架，最近有时间研究了下衍生的Swoft框架。\u003c/p\u003e\n\u003cp\u003e刚开始看的时候，感觉自己像个原始人，完全看不懂。\u003c/p\u003e\n\u003cp\u003e官方文档没有介绍Swoft的实现，网上的一些文章跟当前版本代码已经不一致了。\u003c/p\u003e\n\u003cp\u003e自己花了一周时间，终于梳理清楚了，看完更觉得自己是个原始人了。\u003c/p\u003e\n\u003cp\u003e使用的框架组件版本为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eswoft-2.0.5\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eswoft-component-2.0.5\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里以Swoft启动http server为例。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ephp bin/swoft http:start\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行上述命令，启动http server。\u003c/p\u003e\n\u003cp\u003e这里执行的是bin/swoft文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e#!/usr/bin/env php\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;?php declare(strict_types=1);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Bootstrap\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erequire_once __DIR__ . \u0026#39;/bootstrap.php\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSwoole\\Coroutine::set([\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026#39;max_coroutine\u0026#39; =\u0026gt; 300000,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e// Run application\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e(new \\App\\Application())-\u0026gt;run();\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里引入\u003ccode\u003ebootstrap.php\u003c/code\u003e文件，引入composer自动加载文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Composer autoload\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erequire_once dirname(__DIR__) \u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/vendor/autoload.php\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e然后执行\u003ccode\u003eSwoft\\App\\Application\u003c/code\u003e类下的\u003ccode\u003erun\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp declare(strict_types\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace App;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\SwoftApplication;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function date_default_timezone_set;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class Application\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e Application \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e SwoftApplication\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    protected function beforeInit(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        parent::beforeInit();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        date_default_timezone_set(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Asia/Shanghai\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里继承了\u003ccode\u003eSwoft\\SwoftApplication\u003c/code\u003e类，这里只粘贴了部分代码。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Swoft application\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e SwoftApplication implements SwoftInterface, ApplicationInterface\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Class constructor\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function __construct(array \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Check runtime env\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        SwoftHelper::checkRuntime();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Storage as global \u003cspan style=\"color:#66d9ef\"\u003estatic\u003c/span\u003e property\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Swoft::\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eapp \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Before init\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeInit();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Init console logger\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003einitCLogger();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Can setting properties by array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ObjectHelper::init(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003econfig);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Init application\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003einit();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        CLog::info(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Project path is \u0026lt;info\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%s\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026lt;/info\u0026gt;\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebasePath);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e After init\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eafterInit();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    protected function init(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e Init system path aliases\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003efindBasePath();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003esetSystemAlias();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessors \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprocessors();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprocessor \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e new ApplicationProcessor(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprocessor\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eaddFirstProcessor(\u003cspan style=\"color:#f92672\"\u003e...$\u003c/span\u003eprocessors);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Run application\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function run(): void\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e!$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ebeforeRun()) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprocessor\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ehandle();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e ProcessorInterface[]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    protected function processors(): array\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new EnvProcessor(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new ConfigProcessor(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new AnnotationProcessor(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new BeanProcessor(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new EventProcessor(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            new ConsoleProcessor(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003e__construct\u003c/code\u003e方法里检查运行环境，初始化日志组件，然后调用了\u003ccode\u003einit\u003c/code\u003e方法。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003einit\u003c/code\u003e方法里声明了\u003ccode\u003eprocessor\u003c/code\u003e对象。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eprocessors\u003c/code\u003e方法定义了Swoft框架的6个Processor对象。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003erun\u003c/code\u003e方法里直接调用\u003ccode\u003eprocessor\u003c/code\u003e对象的\u003ccode\u003ehandler\u003c/code\u003e方法。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e?\u003c/span\u003ephp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enamespace Swoft\\Processor;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse Swoft\\Stdlib\\Helper\\ArrayHelper;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse function get_class;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Application processor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003esince \u003cspan style=\"color:#ae81ff\"\u003e2.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e ApplicationProcessor \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e Processor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e ProcessorInterface[]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    private \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessors \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Handle application processors\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function handle(): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edisabled \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eapplication\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003egetDisabledProcessors();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        foreach (\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprocessors as \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessor) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e get_class(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessor);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e If is disabled, skip handle\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (isset(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003edisabled[\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e])) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessor\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003ehandle();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e true;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Add first processor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam Processor[] \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function addFirstProcessor(Processor \u003cspan style=\"color:#f92672\"\u003e...$\u003c/span\u003eprocessor): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        array_unshift(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprocessors, \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessor);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e true;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Add last processor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam Processor[] \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function addLastProcessor(Processor \u003cspan style=\"color:#f92672\"\u003e...$\u003c/span\u003eprocessor): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        array_push(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprocessors, \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessor);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e true;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e/**\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Add processors\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam \u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e         \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eindex\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003eparam Processor[] \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eprocessors\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    public function addProcessor(\u003cspan style=\"color:#a6e22e\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eindex, Processor  \u003cspan style=\"color:#f92672\"\u003e...$\u003c/span\u003eprocessors): \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ArrayHelper::insert(\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003ethis\u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003eprocessors, \u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003eindex, \u003cspan style=\"color:#f92672\"\u003e...$\u003c/span\u003eprocessors);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e true;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003eaddFirstProcessor\u003c/code\u003e方法把process对象赋值给\u003ccode\u003e$this-\u0026gt;processors\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehandle\u003c/code\u003e方法遍历\u003ccode\u003eprocessors\u003c/code\u003e对象，循环执行\u003ccode\u003ehandle\u003c/code\u003e方法。\u003c/p\u003e\n\u003cp\u003eSwoft的核心逻辑都是靠上面定义的6个Processor模块实现的，接下来一个一个分析。\u003c/p\u003e\n","date_published":"2019-08-29T17:22:28+08:00","tags":["Swoft"]},{"title":"BCMath 与 科学计数","id":"https://liudon.com/posts/bcmath-and-exponential-notation/","url":"https://liudon.com/posts/bcmath-and-exponential-notation/","summary":"\u003cp\u003e代码如下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;?php\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho 9.99997600 + 2.4E-5;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u0026#34;\\n===\\n\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho bcadd(9.99997600, 2.4E-5, 8);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e结果为\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e===\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e9.99997600\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e问了朋友，查了各种资料，终于在PHP手册里发现了这段话。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCaution\nPassing values of type float to a BCMath function which expects a string as operand may not have the desired effect due to the way PHP converts float values to string, namely that the string may be in exponential notation (which is not supported by BCMath), and that the decimal separator is locale dependent (while BCMath always expects a decimal point).\u003c/p\u003e","content_html":"\u003cp\u003e代码如下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;?php\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho 9.99997600 + 2.4E-5;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u0026#34;\\n===\\n\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho bcadd(9.99997600, 2.4E-5, 8);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e结果为\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e===\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e9.99997600\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e问了朋友，查了各种资料，终于在PHP手册里发现了这段话。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCaution\nPassing values of type float to a BCMath function which expects a string as operand may not have the desired effect due to the way PHP converts float values to string, namely that the string may be in exponential notation (which is not supported by BCMath), and that the decimal separator is locale dependent (while BCMath always expects a decimal point).\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003ePHP的BCMath方法不支持科学计数\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e解决方法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho bcadd(9.99997600, number_format(2.4E-5, 8, \u0026#39;.\u0026#39;, \u0026#39;\u0026#39;), 8);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003ePHP里浮点数相关的运算一定要使用BCMath函数！\u003c/strong\u003e\u003c/p\u003e\n","date_published":"2019-08-16T19:34:34+08:00","tags":[]},{"title":"Flink Could Not Resolve Resourcemanager Address","id":"https://liudon.com/posts/flink-could-not-resolve-resourcemanager-address/","url":"https://liudon.com/posts/flink-could-not-resolve-resourcemanager-address/","summary":"\u003cp\u003e什么是Flink。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eApache Flink® - Stateful Computations over Data Streams\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eFlink安装参考(官方文档)[https://ci.apache.org/projects/flink/flink-docs-release-1.7/tutorials/local_setup.html]。\u003c/p\u003e","content_html":"\u003cp\u003e什么是Flink。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eApache Flink® - Stateful Computations over Data Streams\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eFlink安装参考(官方文档)[https://ci.apache.org/projects/flink/flink-docs-release-1.7/tutorials/local_setup.html]。\u003c/p\u003e\n\u003cp\u003e这里使用\u003ccode\u003e单机模式\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"问题表现\"\u003e问题表现\u003c/h4\u003e\n\u003cp\u003e启动Flink\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_80_180_centos /usr/local/flink-1.7.2]# ./bin/start-cluster.sh \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStarting cluster.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStarting standalonesession daemon on host VM_80_180_centos.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStarting taskexecutor daemon on host VM_80_180_centos.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查看进程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_80_180_centos /usr/local/flink-1.7.2]# jps\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e10442 StandaloneSessionClusterEntrypoint\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e11067 Jps\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e10909 TaskManagerRunner\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_80_180_centos /usr/local/flink-1.7.2]# \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查看日志，发现\u0026quot;Could not resolve ResourceManager address\u0026quot;的错误。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_80_180_centos /usr/local/flink-1.7.2]# tail -f log/flink-root-taskexecutor-*.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2019-03-27 19:43:23,804 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor            - Could not resolve ResourceManager address akka.tcp://flink@localhost:6123/user/resourcemanager, retrying in 10000 ms: Ask timed out on [ActorSelection[Anchor(akka.tcp://flink@localhost:6123/), Path(/user/resourcemanager)]] after [10000 ms]. Sender[null] sent message of type \u0026#34;akka.actor.Identify\u0026#34;..\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2019-03-27 19:43:43,843 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor            - Could not resolve ResourceManager address akka.tcp://flink@localhost:6123/user/resourcemanager, retrying in 10000 ms: Ask timed out on [ActorSelection[Anchor(akka.tcp://flink@localhost:6123/), Path(/user/resourcemanager)]] after [10000 ms]. Sender[null] sent message of type \u0026#34;akka.actor.Identify\u0026#34;..\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e访问Flink的web页面，发现task数全为0.\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/flink-could-not-resolve-resourcemanager-address/63c9befaly1g1igknr8lyj21ae09874j.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/flink-could-not-resolve-resourcemanager-address/63c9befaly1g1igknr8lyj21ae09874j.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"63c9befaly1g1igknr8lyj21ae09874j.jpg\" width=\"1080\" height=\"215\" alt=\"flink no task\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003ch4 id=\"问题原因\"\u003e问题原因：\u003c/h4\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/flink-could-not-resolve-resourcemanager-address/63c9befaly1g1igoreyi9j20oz04mdg7.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/flink-could-not-resolve-resourcemanager-address/63c9befaly1g1igoreyi9j20oz04mdg7.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"63c9befaly1g1igoreyi9j20oz04mdg7.jpg\" width=\"899\" height=\"166\" alt=\"taskmanager.host\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003eFlink的taskmanager.host默认为空，会使用hostname。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[root@VM_80_180_centos /usr/local/flink-1.7.2]# ping VM_80_180_centos\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePING VM_80_180_centos (100.125.80.180) 56(84) bytes of data.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e64 bytes from VM_80_180_centos (100.125.80.180): icmp_seq=1 ttl=64 time=0.022 ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e64 bytes from VM_80_180_centos (100.125.80.180): icmp_seq=2 ttl=64 time=0.038 ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e64 bytes from VM_80_180_centos (100.125.80.180): icmp_seq=3 ttl=64 time=0.038 ms\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFlink的jobmanager.host默认为localhost。\u003c/p\u003e\n\u003cp\u003e这里jobmanager和taskmanager绑定的ip不一样，导致出错。\u003c/p\u003e\n\u003ch4 id=\"解决办法\"\u003e解决办法：\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim conf/flink-conf.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e添加下面这行配置\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etaskmanager.host: localhost\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e保存退出，然后重新启动Flink，这个时候在web端就可以看到有可用task了。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/flink-could-not-resolve-resourcemanager-address/63c9befaly1g1ih665ffjj21a709374r.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/flink-could-not-resolve-resourcemanager-address/63c9befaly1g1ih665ffjj21a709374r.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"63c9befaly1g1ih665ffjj21a709374r.jpg\" width=\"1080\" height=\"212\" alt=\"flink web\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n","date_published":"2019-03-28T13:00:50+08:00","tags":["Flink"]},{"title":"解决Sublime Text安装包时\"There Are No Packages Available for Installation\"的报错","id":"https://liudon.com/posts/there-are-no-packages-available-for-installation/","url":"https://liudon.com/posts/there-are-no-packages-available-for-installation/","summary":"\u003cp\u003e今天安装hugofy的包时，一直遇到\u0026quot;There Are No Packages Available for Installation\u0026quot;的错误。\n按网上的教程，配置host，配置代理都不起作用。\u003c/p\u003e","content_html":"\u003cp\u003e今天安装hugofy的包时，一直遇到\u0026quot;There Are No Packages Available for Installation\u0026quot;的错误。\n按网上的教程，配置host，配置代理都不起作用。\u003c/p\u003e\n\u003cp\u003e本机确定是可以访问\u003ca href=\"https://packagecontrol.io/channel_v3.json\"\u003ehttps://packagecontrol.io/channel_v3.json\u003c/a\u003e这个地址的。\u003c/p\u003e\n\u003cp\u003e然后按教程把这文件放到本地，配置channel指向本地这个文件，然后提示json解析失败。\n然后检查这个文件，发现文件好像不全。然后换到其他机器curl这个地址，发现下载下来的文件确实不全，不是合法的json内容。\u003c/p\u003e\n\u003cp\u003e\n\n\u003cpicture\u003e\u003csource type=\"image/avif\" srcset=\"https://liudon.com/posts/there-are-no-packages-available-for-installation/63c9befaly1fz7anr0smxj20fg0famzv.jpg_1080x.avif 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003csource type=\"image/webp\" srcset=\"https://liudon.com/posts/there-are-no-packages-available-for-installation/63c9befaly1fz7anr0smxj20fg0famzv.jpg_1080x.webp 1080w\" sizes=\"(min-width: 768px) 1080px, 100vw\" /\u003e\u003cimg src=\"63c9befaly1fz7anr0smxj20fg0famzv.jpg\" width=\"556\" height=\"550\" alt=\"下载文件内容截图\" title=\"\" loading=\"lazy\" /\u003e\n\t\t\u003c/picture\u003e\n\n\u003c/p\u003e\n\u003cp\u003e又搜索一番后，找到一个case。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/wbond/package_control/issues/1397\"\u003ePackage Control: There are no packages available for installation/Server Error\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e原来是官方的文件下载出问题了，可以先按上面链接里的方法修改，验证可行。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMeanwhile, you can add\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026#34;channels\u0026#34;: [ \u0026#34;https://erhan.in/channel_v3.json\u0026#34; ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eto Preferences \u0026gt; Package Settings \u0026gt; Package Control \u0026gt; Settings - User file.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThis is the latest snapshot of the original JSON file from web.archive.org.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date_published":"2019-01-11T17:13:14+08:00","tags":[]},{"title":"关于本站","id":"https://liudon.com/about/","url":"https://liudon.com/about/","summary":"\u003cp\u003e大家好，欢迎来到我的博客。\u003c/p\u003e\n\u003ch2 id=\"建站缘由\"\u003e建站缘由\u003c/h2\u003e\n\u003cp\u003e大学期间，被人忽悠报了一个计算机培训班，误打误撞的进入了互联网行业。\u003c/p\u003e\n\u003cp\u003e11年在网友的帮助下，用wordPress搭建了\u003ca href=\"https://www.liudon.org/1.html\"\u003e博客\u003c/a\u003e，随即开始了我的博主生涯。\u003c/p\u003e","content_html":"\u003cp\u003e大家好，欢迎来到我的博客。\u003c/p\u003e\n\u003ch2 id=\"建站缘由\"\u003e建站缘由\u003c/h2\u003e\n\u003cp\u003e大学期间，被人忽悠报了一个计算机培训班，误打误撞的进入了互联网行业。\u003c/p\u003e\n\u003cp\u003e11年在网友的帮助下，用wordPress搭建了\u003ca href=\"https://www.liudon.org/1.html\"\u003e博客\u003c/a\u003e，随即开始了我的博主生涯。\u003c/p\u003e\n\u003cp\u003e最开始的域名是\u003ccode\u003eliudon.org\u003c/code\u003e，取自本人名字的拼音，14年的时候经历了一次\u003ca href=\"https://www.liudon.org/1255.html\"\u003e域名被盗\u003c/a\u003e，好在最后找回了。\u003c/p\u003e\n\u003cp\u003e中间又申请了\u003ccode\u003eliudon.xyz\u003c/code\u003e域名，一直垂涎于\u003ccode\u003eliudon.com\u003c/code\u003e，终于在22年被我拿到手了，\u003ca href=\"https://liudon.com/posts/%E5%8D%81%E4%B8%80%E5%B9%B4%E7%9A%84%E7%AD%89%E5%BE%85%E7%BB%88%E4%BA%8E%E6%8B%BF%E5%88%B0%E4%BA%86liudon.com%E5%9F%9F%E5%90%8D/\"\u003e十一年的等待\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e本站使用\u003ccode\u003eHugo\u003c/code\u003e生成，存储在\u003ccode\u003eGithub\u003c/code\u003e上，同时部署在\u003ccode\u003eCloudflare Pages\u003c/code\u003e和\u003ccode\u003eIPFS\u003c/code\u003e上。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/deploy-blog-to-cloudflare-pages/\"\u003e将博客部署到Cloudflare Pages\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.com/posts/deploy-blog-to-ipfs/\"\u003e将博客部署到星际文件系统(IPFS)\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"内容版权\"\u003e内容版权\u003c/h2\u003e\n\u003cp\u003e本博客（域名为liudon.com）的所有内容（包括但不限于文字、图片、音频、视频等），除特别注明外，均由Liudon创作或原创，版权归Liudon个人所有。\u003c/p\u003e\n\u003cp\u003e本博客采用 \u003ca href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\"\u003eCC BY-NC-SA 4.0协议\u003c/a\u003e 进行内容共享。\u003c/p\u003e\n\u003cp\u003e转载请注明作者及原文网址，商业转载请联系本人确认。\u003c/p\u003e\n\u003ch2 id=\"关于本人\"\u003e关于本人\u003c/h2\u003e\n\u003cp\u003e喜欢做梦、已婚的80后男生。\u003c/p\u003e\n\u003cp\u003e如果您有意见或建议，您可以通过\u003ccode\u003ei@liudon.org\u003c/code\u003e联系我。\u003c/p\u003e\n\u003ch2 id=\"朋友们\"\u003e朋友们\u003c/h2\u003e\n\u003ca target=\"_blank\" href=https://dvel.me title=Dvel’s\u0026#32;Blog class=\"friendurl\"\u003e\r\n  \u003cdiv class=\"frienddiv\"\u003e\r\n      \u003cdiv class=\"frienddivleft\"\u003e\r\n        \u003cimg class=\"myfriend\" src=https://dvel.me/avatar.png /\u003e\r\n      \u003c/div\u003e\r\n      \u003cdiv class=\"frienddivright\"\u003e\r\n        \u003cdiv class=\"friendname\"\u003eDvel’s Blog\u003c/div\u003e\r\n        \u003cdiv class=\"friendinfo\"\u003eLess is More.\u003c/div\u003e\r\n      \u003c/div\u003e\r\n  \u003c/div\u003e\r\n\u003c/a\u003e\n\u003ca target=\"_blank\" href=https://immmmm.com/ title=林木木木木木 class=\"friendurl\"\u003e\r\n  \u003cdiv class=\"frienddiv\"\u003e\r\n      \u003cdiv class=\"frienddivleft\"\u003e\r\n        \u003cimg class=\"myfriend\" src=https://cdn.sep.cc/avatar/ba83fa02fc4b2ba621514941307e21be?d\u0026#61;identicon /\u003e\r\n      \u003c/div\u003e\r\n      \u003cdiv class=\"frienddivright\"\u003e\r\n        \u003cdiv class=\"friendname\"\u003e林木木木木木\u003c/div\u003e\r\n        \u003cdiv class=\"friendinfo\"\u003e木木木木木\u003c/div\u003e\r\n      \u003c/div\u003e\r\n  \u003c/div\u003e\r\n\u003c/a\u003e\n\u003ca target=\"_blank\" href=https://taoshu.in/ title=涛叔 class=\"friendurl\"\u003e\r\n  \u003cdiv class=\"frienddiv\"\u003e\r\n      \u003cdiv class=\"frienddivleft\"\u003e\r\n        \u003cimg class=\"myfriend\" src=https://taoshu.in/avatar.jpg /\u003e\r\n      \u003c/div\u003e\r\n      \u003cdiv class=\"frienddivright\"\u003e\r\n        \u003cdiv class=\"friendname\"\u003e涛叔\u003c/div\u003e\r\n        \u003cdiv class=\"friendinfo\"\u003e涛叔\u003c/div\u003e\r\n      \u003c/div\u003e\r\n  \u003c/div\u003e\r\n\u003c/a\u003e\n\u003ca target=\"_blank\" href=https://laozhang.org/ title=老张博客 class=\"friendurl\"\u003e\r\n  \u003cdiv class=\"frienddiv\"\u003e\r\n      \u003cdiv class=\"frienddivleft\"\u003e\r\n        \u003cimg class=\"myfriend\" src=https://picx.s3.bitiful.net/2023/05/01/644f0e3acd666.png /\u003e\r\n      \u003c/div\u003e\r\n      \u003cdiv class=\"frienddivright\"\u003e\r\n        \u003cdiv class=\"friendname\"\u003e老张博客\u003c/div\u003e\r\n        \u003cdiv class=\"friendinfo\"\u003e老张博客\u003c/div\u003e\r\n      \u003c/div\u003e\r\n  \u003c/div\u003e\r\n\u003c/a\u003e\n","date_published":"2019-01-10T14:11:09+08:00","tags":[]},{"title":"2019，新开始","id":"https://liudon.com/posts/the-first-post/","url":"https://liudon.com/posts/the-first-post/","summary":"\u003cp\u003e从2011年开始写博客，博客程序从WordPress换成Typecho。\n早就有想法换成静态博客，一直没时间搞。\u003c/p\u003e\n\u003cp\u003e2019年了，新年新气象，用hugo + github pages搞了个新博客。\u003c/p\u003e","content_html":"\u003cp\u003e从2011年开始写博客，博客程序从WordPress换成Typecho。\n早就有想法换成静态博客，一直没时间搞。\u003c/p\u003e\n\u003cp\u003e2019年了，新年新气象，用hugo + github pages搞了个新博客。\u003c/p\u003e\n\u003cp\u003e具体部署过程参考文章：\n\u003ca href=\"https://axdlog.com/zh/2018/using-hugo-and-travis-ci-to-deploy-blog-to-github-pages-automatically/\"\u003e利用Travis CI和Hugo將Blog自動部署到Github Pages\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e这篇文章就是通过这种方式来更新的，感觉很是神奇。\n再也不用关注服务器性能这些东西了，只需要专心写字就好了。\u003c/p\u003e\n\u003cp\u003e\u003cdel\u003e接下来只需要搞定自定义域名了，域名还在认证中，无法做解析。\u003c/del\u003e\u003c/p\u003e\n\u003cp\u003e自定义域名也搞定了，以后就可以正式切到新博客了。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://liudon.org\"\u003e老博客\u003c/a\u003e只做备份了，不再更新了。\u003c/p\u003e\n","date_published":"2019-01-09T15:17:04+08:00","tags":[]},{"title":"Search","id":"https://liudon.com/search/","url":"https://liudon.com/search/","summary":"","content_html":"","date_published":"0001-01-01T00:00:00Z","tags":[]}]}